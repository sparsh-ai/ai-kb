<!doctype html>
<html class="docs-version-current" lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.17">
<link rel="alternate" type="application/rss+xml" href="/ai-kb/blog/rss.xml" title="AIKB RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/ai-kb/blog/atom.xml" title="AIKB Atom Feed">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.13.24/dist/katex.min.css" integrity="sha384-odtC+0UGzzFL/6PNoE8rX/SPcQDXBJ+uRepguP4QkPCm2LBxH3FA3y+fKSiJ+AmM" crossorigin="anonymous"><title data-rh="true">Resale Price Prediction | AIKB</title><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://kb.recohut.com/ai-kb/docs/tutorials/resale-price-prediction"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Resale Price Prediction | AIKB"><meta data-rh="true" name="description" content="|   | BRAND | PARTNO           | QUANTITY | UNITRESALE | UNITCOST |"><meta data-rh="true" property="og:description" content="|   | BRAND | PARTNO           | QUANTITY | UNITRESALE | UNITCOST |"><link data-rh="true" rel="icon" href="/ai-kb/img/logo.svg"><link data-rh="true" rel="canonical" href="https://kb.recohut.com/ai-kb/docs/tutorials/resale-price-prediction"><link data-rh="true" rel="alternate" href="https://kb.recohut.com/ai-kb/docs/tutorials/resale-price-prediction" hreflang="en"><link data-rh="true" rel="alternate" href="https://kb.recohut.com/ai-kb/docs/tutorials/resale-price-prediction" hreflang="x-default"><link rel="stylesheet" href="/ai-kb/assets/css/styles.af9e0313.css">
<link rel="preload" href="/ai-kb/assets/js/runtime~main.65743e6b.js" as="script">
<link rel="preload" href="/ai-kb/assets/js/main.ed9e086a.js" as="script">
</head>
<body class="navigation-with-keyboard" data-theme="light">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div role="region"><a href="#" class="skipToContent_ZgBM">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/ai-kb/"><div class="navbar__logo"><img src="/ai-kb/img/logo.svg" alt="aikb Logo" class="themedImage_W2Cr themedImage--light_TfLj"><img src="/ai-kb/img/logo.svg" alt="aikb Logo" class="themedImage_W2Cr themedImage--dark_oUvU"></div><b class="navbar__title">AIKB</b></a><a class="navbar__item navbar__link navbar__link--active" href="/ai-kb/docs/intro">Docs</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/sparsh-ai/ai-kb" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link"><span>GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_I5OW"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a><div class="toggle_S7eR toggle_TdHA toggleDisabled_f9M3"><div class="toggleButton_rCf9" role="button" tabindex="-1"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_v35p"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_nQuB"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></div><input type="checkbox" class="toggleScreenReader_g2nN" aria-label="Switch between dark and light mode (currently light mode)"></div><div class="dsla-search-wrapper"><div class="dsla-search-field" data-tags="default,docs-default-current"></div></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper docs-wrapper docs-doc-page"><div class="docPage_P2Lg"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_RiI4" type="button"></button><aside class="theme-doc-sidebar-container docSidebarContainer_rKC_"><div class="sidebar_CW9Y"><nav class="menu thin-scrollbar menu_SkdO"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/ai-kb/docs/intro">Introduction</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/ai-kb/docs/projects/">Projects</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link" href="/ai-kb/docs/concepts/">Concepts</a><button aria-label="Toggle the collapsible sidebar category &#x27;Concepts&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--active" href="/ai-kb/docs/tutorials/">Tutorials</a><button aria-label="Toggle the collapsible sidebar category &#x27;Tutorials&#x27;" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/ai-kb/docs/tutorials/amazon-personalize">Amazon Personalize</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/ai-kb/docs/tutorials/data-loading">Data Loading</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/ai-kb/docs/tutorials/database-conn">Database Connections</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/ai-kb/docs/tutorials/email-classification">Email Classification</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/ai-kb/docs/tutorials/google-cloud">Google Cloud Big Data and Machine Learning Fundamentals</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/ai-kb/docs/tutorials/graph">Graph-based Modeling</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/ai-kb/docs/tutorials/kubernetes">Kubernetes</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/ai-kb/docs/tutorials/mathematics">Mathematics</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/ai-kb/docs/tutorials/matrix-factorizations">Matrix Factorizations</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/ai-kb/docs/tutorials/mlops">MLOps</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/ai-kb/docs/tutorials/model-optimization">Model Optimization</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/ai-kb/docs/tutorials/multi-touch-attribution">Multi-Touch Attribution</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/ai-kb/docs/tutorials/name-address-parsing">Name and Address Parsing</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/ai-kb/docs/tutorials/negative-implicit-feedback-rec">Negative Implicit Feedback in Recommendations</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/ai-kb/docs/tutorials/outliers-handling">Outliers Handling</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/ai-kb/docs/tutorials/pdf-to-wordcloud-mail">PDF to WordCloud via Email</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/ai-kb/docs/tutorials/python-snippets">Python code</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/ai-kb/docs/tutorials/recsys-evaluation">Recommender System Evaluation</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/ai-kb/docs/tutorials/regression">Regression</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/ai-kb/docs/tutorials/resale-price-prediction">Resale Price Prediction</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/ai-kb/docs/tutorials/text-cleaning">Text Cleaning</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/ai-kb/docs/tutorials/text-embeddings">Text Embeddings</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/ai-kb/docs/tutorials/text-processing">Text Processing</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/ai-kb/docs/tutorials/unix-shell-snippets">Unix shell</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/ai-kb/docs/tutorials/vector-search">Vector Search</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/ai-kb/docs/tutorials/word2vec">Word2vec</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link" href="/ai-kb/docs/tools/">Tools</a><button aria-label="Toggle the collapsible sidebar category &#x27;Tools&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/ai-kb/docs/notebooks/">Notebooks</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link" href="/ai-kb/docs/best-practices/">Best Practices</a><button aria-label="Toggle the collapsible sidebar category &#x27;Best Practices&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link" href="/ai-kb/docs/training-courses/">Training Courses</a><button aria-label="Toggle the collapsible sidebar category &#x27;Training Courses&#x27;" type="button" class="clean-btn menu__caret"></button></div></li></ul></nav></div></aside><main class="docMainContainer_TCnq"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_DM6M"><div class="docItemContainer_vinB"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Xlws" aria-label="breadcrumbs"><ul class="breadcrumbs"><li class="breadcrumbs__item"><a class="breadcrumbs__link breadcrumbsItemLink_e5ie" href="/ai-kb/">🏠</a></li><li class="breadcrumbs__item"><a class="breadcrumbs__link breadcrumbsItemLink_e5ie" href="/ai-kb/docs/tutorials/">Tutorials</a></li><li class="breadcrumbs__item breadcrumbs__item--active"><a class="breadcrumbs__link breadcrumbsItemLink_e5ie" href="/ai-kb/docs/tutorials/resale-price-prediction">Resale Price Prediction</a></li></ul></nav><div class="theme-doc-markdown markdown"><h1>Resale Price Prediction</h1><a href="https://nbviewer.org/github/recohut/notebook/blob/master/_notebooks/2022-01-06-resale-prediction.ipynb" target="_blank" rel="noopener noreferrer" alt=""> <img src="https://colab.research.google.com/assets/colab-badge.svg"></a><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain"># import the libraries</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import re</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import scipy</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import numpy as np</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import pandas as pd</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import matplotlib.pyplot as plt</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import seaborn as sns</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">from sklearn.pipeline import make_pipeline</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">from sklearn.decomposition import TruncatedSVD</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">from sklearn.model_selection import train_test_split</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">from scipy.sparse import coo_matrix, hstack</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">from sklearn.preprocessing import StandardScaler, MinMaxScaler</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">from sklearn.preprocessing import OneHotEncoder</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">from sklearn.feature_extraction.text import TfidfVectorizer</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">from sklearn.feature_extraction.text import CountVectorizer</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">from keras import backend as K</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import tensorflow as tf</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">from tensorflow import keras</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">from keras.layers import Dense, Input, Dropout</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">from keras.models import Model</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">from utils import *</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import warnings</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">warnings.filterwarnings(&quot;ignore&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">plt.style.use(&#x27;fivethirtyeight&#x27;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">plt.style.use(&#x27;seaborn-notebook&#x27;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">%config InlineBackend.figure_format = &#x27;retina&#x27;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">%reload_ext autoreload</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">%autoreload 2</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">df = pd.read_pickle(&#x27;./data/df_cleaned.p&#x27;)</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">colname_map = {&#x27;PRC&#x27;:&#x27;BRAND&#x27;, &#x27;PARTNO&#x27;:&#x27;PARTNO&#x27;,&#x27;UNIT RESALE&#x27;:&#x27;UNITRESALE&#x27;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">               &#x27;ORIG ORDER QTY&#x27;:&#x27;ORDERQTY&#x27;, &#x27;NEW UNIT COST&#x27;:&#x27;UNITCOST&#x27;}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">df = prepare_data(df, colname_map)</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">df.head()</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><table><thead><tr><th></th><th>BRAND</th><th>PARTNO</th><th>QUANTITY</th><th>UNITRESALE</th><th>UNITCOST</th></tr></thead><tbody><tr><td>0</td><td>2</td><td>53001176-1 REV A</td><td>25-49</td><td>209.66</td><td>107.65</td></tr><tr><td>1</td><td>2</td><td>53001176-1 REV A</td><td>25-49</td><td>209.66</td><td>99.51</td></tr><tr><td>2</td><td>2</td><td>61-82477-8</td><td>25-49</td><td>76.75</td><td>60</td></tr><tr><td>3</td><td>2</td><td>AA1208K08</td><td>25-49</td><td>66.12</td><td>50.8</td></tr><tr><td>4</td><td>2</td><td>AA1208K08X</td><td>50-99</td><td>66.21</td><td>52</td></tr></tbody></table><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">df, fitted_lambda = scale_price(df)</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">df.head()</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><table><thead><tr><th></th><th>BRAND</th><th>PARTNO</th><th>QUANTITY</th><th>UNITCOST</th><th>RESALE</th></tr></thead><tbody><tr><td>0</td><td>2</td><td>61-82477-8</td><td>25-49</td><td>60</td><td>3.850272</td></tr><tr><td>1</td><td>2</td><td>AA1208K08</td><td>25-49</td><td>50.8</td><td>3.733058</td></tr><tr><td>2</td><td>2</td><td>AA1208K08X</td><td>50-99</td><td>52</td><td>3.734132</td></tr><tr><td>3</td><td>2</td><td>AA67006-4KA</td><td>50-99</td><td>13.9</td><td>2.559783</td></tr><tr><td>4</td><td>2</td><td>AA67006-4KA</td><td>25-49</td><td>13.5</td><td>2.686291</td></tr></tbody></table><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">CV1 = CountVectorizer(stop_words=None, </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                      max_df=1.0, </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                      min_df=100, </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                      ngram_range=(1,1),</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                      binary=True, </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                      analyzer=&#x27;char&#x27;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">CV1.fit(list(set(df[&#x27;PARTNO&#x27;].tolist())))</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">X1 = CV1.transform(df[&#x27;PARTNO&#x27;].tolist())</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">X1</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">&lt;432960x45 sparse matrix of type &#x27;&lt;class &#x27;numpy.int64&#x27;&gt;&#x27;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    with 3493797 stored elements in Compressed Sparse Row format&gt;</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain"># CV1.vocabulary_</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">CV2 = CountVectorizer(stop_words=None, </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                      max_df=0.8, </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                      min_df=100, </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                      ngram_range=(2,6), </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                      binary=True,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                      analyzer=&#x27;char&#x27;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">CV2.fit(list(set(df[&#x27;PARTNO&#x27;].tolist())))</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">X2 = CV2.transform(df[&#x27;PARTNO&#x27;].tolist())</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">X2</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">&lt;432960x5430 sparse matrix of type &#x27;&lt;class &#x27;numpy.int64&#x27;&gt;&#x27;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    with 9427277 stored elements in Compressed Sparse Row format&gt;</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">def tokenizer(text):</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  text = text.lower()</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  rx1 = r&quot;(?i)(?:(?&lt;=\d)(?=[a-z])|(?&lt;=[a-z])(?=\d))&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  text = re.sub(rx1,&#x27; &#x27;, text)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  text = re.sub(r&#x27;[^a-z0-9]&#x27;,&#x27; &#x27;, text)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  text = &#x27; &#x27;.join(text.split())</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  text = text.split()</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  return text</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">CV3 = TfidfVectorizer(stop_words=None, </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                      max_df=0.5, </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                      min_df=100, </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                      ngram_range=(1,5), </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                      binary=False,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                      analyzer=&#x27;word&#x27;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                      tokenizer=tokenizer)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">CV3.fit(list(set(df[&#x27;PARTNO&#x27;].tolist())))</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">X3 = CV3.transform(df[&#x27;PARTNO&#x27;].tolist())</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">X3</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">&lt;432960x1007 sparse matrix of type &#x27;&lt;class &#x27;numpy.float64&#x27;&gt;&#x27;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    with 1715717 stored elements in Compressed Sparse Row format&gt;</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">enc = OneHotEncoder()</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ohecols = [&#x27;BRAND&#x27;,&#x27;QUANTITY&#x27;]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">enc.fit(df[ohecols])</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">X4 = enc.transform(df[ohecols])</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">X4</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">&lt;432960x577 sparse matrix of type &#x27;&lt;class &#x27;numpy.float64&#x27;&gt;&#x27;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    with 865920 stored elements in Compressed Sparse Row format&gt;</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">X = hstack([X1, X2, X3, X4])</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">X</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">&lt;432960x7059 sparse matrix of type &#x27;&lt;class &#x27;numpy.float64&#x27;&gt;&#x27;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    with 15502711 stored elements in COOrdinate format&gt;</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">Y = df[&#x27;RESALE&#x27;].values</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Y = Y.reshape(-1,1)</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">X_train, X_test, y_train, y_test = train_test_split(X, Y, test_size=0.1, random_state=40)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">print(&quot;Training Records {}, Testing Records: {}&quot;.format(X_train.shape[0],</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                                                        X_test.shape[0]))</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">Training Records 389664, Testing Records: 43296</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">batch_size = 2048</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">epochs = 75</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">inputs = Input(shape=(X_train.shape[1],), sparse=True)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">L = Dense(512, activation=&#x27;relu&#x27;)(inputs)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">L = Dropout(0.5)(L)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">L = Dense(10, activation=&#x27;relu&#x27;)(L)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">outputs = Dense(y_train.shape[1])(L)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">model = Model(inputs=inputs, outputs=outputs)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">model.compile(loss=&#x27;mse&#x27;, optimizer=&#x27;adam&#x27;, metrics=[&#x27;mae&#x27;])</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">model.summary()</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">Model: &quot;functional_3&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">_________________________________________________________________</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Layer (type)                 Output Shape              Param #   </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">=================================================================</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">input_2 (InputLayer)         [(None, 7059)]            0         </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">_________________________________________________________________</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">dense_3 (Dense)              (None, 512)               3614720   </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">_________________________________________________________________</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">dropout_1 (Dropout)          (None, 512)               0         </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">_________________________________________________________________</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">dense_4 (Dense)              (None, 10)                5130      </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">_________________________________________________________________</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">dense_5 (Dense)              (None, 1)                 11        </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">=================================================================</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Total params: 3,619,861</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Trainable params: 3,619,861</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Non-trainable params: 0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">_________________________________________________________________</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">history = model.fit(nn_batch_generator(X_train, y_train, batch_size),</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          steps_per_epoch=len(y_train)//batch_size, </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          validation_data=nn_batch_generator(X_test, y_test, batch_size),</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          validation_steps=len(y_test)//batch_size, </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          epochs=100,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          workers=-1, </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          use_multiprocessing=True)</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">Epoch 1/100</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">190/190 [==============================] - 22s 114ms/step - loss: 0.8163 - mae: 0.6779 - val_loss: 0.4789 - val_mae: 0.5142</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Epoch 2/100</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">190/190 [==============================] - 21s 111ms/step - loss: 0.4670 - mae: 0.5137 - val_loss: 0.4088 - val_mae: 0.4675</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Epoch 3/100</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">190/190 [==============================] - 21s 111ms/step - loss: 0.3991 - mae: 0.4744 - val_loss: 0.3682 - val_mae: 0.4406</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Epoch 4/100</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">190/190 [==============================] - 21s 112ms/step - loss: 0.3548 - mae: 0.4472 - val_loss: 0.3426 - val_mae: 0.4222</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Epoch 5/100</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">190/190 [==============================] - 21s 111ms/step - loss: 0.3244 - mae: 0.4278 - val_loss: 0.3288 - val_mae: 0.4123</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Epoch 6/100</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">190/190 [==============================] - 21s 112ms/step - loss: 0.3011 - mae: 0.4124 - val_loss: 0.3146 - val_mae: 0.4022</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Epoch 7/100</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">190/190 [==============================] - 22s 115ms/step - loss: 0.2838 - mae: 0.4004 - val_loss: 0.3066 - val_mae: 0.3963</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Epoch 8/100</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">190/190 [==============================] - 21s 112ms/step - loss: 0.2701 - mae: 0.3905 - val_loss: 0.3014 - val_mae: 0.3924</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Epoch 9/100</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">190/190 [==============================] - 21s 111ms/step - loss: 0.2593 - mae: 0.3820 - val_loss: 0.2951 - val_mae: 0.3861</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Epoch 10/100</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">190/190 [==============================] - 22s 115ms/step - loss: 0.2493 - mae: 0.3746 - val_loss: 0.2937 - val_mae: 0.3852</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Epoch 11/100</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">190/190 [==============================] - 21s 112ms/step - loss: 0.2419 - mae: 0.3688 - val_loss: 0.2899 - val_mae: 0.3798</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Epoch 12/100</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">190/190 [==============================] - 21s 113ms/step - loss: 0.2353 - mae: 0.3633 - val_loss: 0.2867 - val_mae: 0.3771</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Epoch 13/100</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">190/190 [==============================] - 22s 116ms/step - loss: 0.2279 - mae: 0.3574 - val_loss: 0.2877 - val_mae: 0.3767</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Epoch 14/100</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">190/190 [==============================] - 21s 112ms/step - loss: 0.2238 - mae: 0.3538 - val_loss: 0.2823 - val_mae: 0.3730</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Epoch 15/100</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">190/190 [==============================] - 21s 112ms/step - loss: 0.2196 - mae: 0.3498 - val_loss: 0.2821 - val_mae: 0.3720</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Epoch 16/100</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">190/190 [==============================] - 22s 114ms/step - loss: 0.2142 - mae: 0.3460 - val_loss: 0.2788 - val_mae: 0.3696</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Epoch 17/100</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">190/190 [==============================] - 21s 111ms/step - loss: 0.2105 - mae: 0.3426 - val_loss: 0.2801 - val_mae: 0.3698</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Epoch 18/100</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">190/190 [==============================] - 21s 112ms/step - loss: 0.2072 - mae: 0.3397 - val_loss: 0.2770 - val_mae: 0.3669</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Epoch 19/100</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">190/190 [==============================] - 22s 115ms/step - loss: 0.2039 - mae: 0.3369 - val_loss: 0.2790 - val_mae: 0.3690</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Epoch 20/100</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">190/190 [==============================] - 21s 112ms/step - loss: 0.2014 - mae: 0.3345 - val_loss: 0.2755 - val_mae: 0.3657</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Epoch 21/100</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">190/190 [==============================] - 20s 107ms/step - loss: 0.1980 - mae: 0.3314 - val_loss: 0.2754 - val_mae: 0.3660</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Epoch 22/100</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">190/190 [==============================] - 21s 108ms/step - loss: 0.1952 - mae: 0.3290 - val_loss: 0.2757 - val_mae: 0.3649</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Epoch 23/100</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">190/190 [==============================] - 22s 114ms/step - loss: 0.1933 - mae: 0.3275 - val_loss: 0.2731 - val_mae: 0.3633</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Epoch 24/100</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">190/190 [==============================] - 21s 111ms/step - loss: 0.1913 - mae: 0.3254 - val_loss: 0.2734 - val_mae: 0.3632</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Epoch 25/100</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">190/190 [==============================] - 20s 104ms/step - loss: 0.1880 - mae: 0.3225 - val_loss: 0.2721 - val_mae: 0.3617</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Epoch 26/100</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">190/190 [==============================] - 21s 111ms/step - loss: 0.1870 - mae: 0.3213 - val_loss: 0.2732 - val_mae: 0.3626</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Epoch 27/100</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">190/190 [==============================] - 22s 114ms/step - loss: 0.1838 - mae: 0.3186 - val_loss: 0.2698 - val_mae: 0.3588</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Epoch 28/100</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">190/190 [==============================] - 21s 113ms/step - loss: 0.1823 - mae: 0.3173 - val_loss: 0.2708 - val_mae: 0.3589</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Epoch 29/100</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">190/190 [==============================] - 20s 107ms/step - loss: 0.1808 - mae: 0.3155 - val_loss: 0.2712 - val_mae: 0.3599</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Epoch 30/100</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">190/190 [==============================] - 19s 102ms/step - loss: 0.1790 - mae: 0.3140 - val_loss: 0.2727 - val_mae: 0.3607</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Epoch 31/100</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">190/190 [==============================] - 21s 111ms/step - loss: 0.1772 - mae: 0.3126 - val_loss: 0.2698 - val_mae: 0.3588</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Epoch 32/100</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">190/190 [==============================] - 20s 108ms/step - loss: 0.1756 - mae: 0.3108 - val_loss: 0.2703 - val_mae: 0.3584</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Epoch 33/100</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">190/190 [==============================] - 19s 99ms/step - loss: 0.1747 - mae: 0.3099 - val_loss: 0.2693 - val_mae: 0.3575</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Epoch 34/100</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">190/190 [==============================] - 21s 111ms/step - loss: 0.1733 - mae: 0.3085 - val_loss: 0.2703 - val_mae: 0.3578</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Epoch 35/100</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">190/190 [==============================] - 21s 108ms/step - loss: 0.1724 - mae: 0.3077 - val_loss: 0.2704 - val_mae: 0.3583</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Epoch 36/100</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">190/190 [==============================] - 19s 99ms/step - loss: 0.1706 - mae: 0.3063 - val_loss: 0.2694 - val_mae: 0.3580</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Epoch 37/100</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">190/190 [==============================] - 21s 111ms/step - loss: 0.1689 - mae: 0.3045 - val_loss: 0.2687 - val_mae: 0.3573</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Epoch 38/100</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">190/190 [==============================] - 20s 107ms/step - loss: 0.1678 - mae: 0.3033 - val_loss: 0.2690 - val_mae: 0.3572</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Epoch 39/100</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">190/190 [==============================] - 19s 98ms/step - loss: 0.1668 - mae: 0.3023 - val_loss: 0.2698 - val_mae: 0.3578</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Epoch 40/100</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">190/190 [==============================] - 21s 110ms/step - loss: 0.1655 - mae: 0.3008 - val_loss: 0.2687 - val_mae: 0.3556</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Epoch 41/100</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">190/190 [==============================] - 20s 107ms/step - loss: 0.1643 - mae: 0.3001 - val_loss: 0.2702 - val_mae: 0.3569</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Epoch 42/100</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">190/190 [==============================] - 19s 98ms/step - loss: 0.1637 - mae: 0.2992 - val_loss: 0.2698 - val_mae: 0.3567</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Epoch 43/100</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">190/190 [==============================] - 21s 111ms/step - loss: 0.1626 - mae: 0.2980 - val_loss: 0.2703 - val_mae: 0.3570</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Epoch 44/100</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">190/190 [==============================] - 21s 113ms/step - loss: 0.1616 - mae: 0.2973 - val_loss: 0.2695 - val_mae: 0.3552</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Epoch 45/100</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">190/190 [==============================] - 20s 104ms/step - loss: 0.1610 - mae: 0.2965 - val_loss: 0.2666 - val_mae: 0.3532</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Epoch 46/100</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">190/190 [==============================] - 19s 101ms/step - loss: 0.1594 - mae: 0.2948 - val_loss: 0.2683 - val_mae: 0.3530</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Epoch 47/100</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">190/190 [==============================] - 19s 102ms/step - loss: 0.1587 - mae: 0.2939 - val_loss: 0.2688 - val_mae: 0.3532</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Epoch 48/100</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">190/190 [==============================] - 21s 110ms/step - loss: 0.1576 - mae: 0.2931 - val_loss: 0.2676 - val_mae: 0.3528</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Epoch 49/100</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">190/190 [==============================] - 21s 112ms/step - loss: 0.1565 - mae: 0.2918 - val_loss: 0.2679 - val_mae: 0.3528</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Epoch 50/100</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">190/190 [==============================] - 20s 107ms/step - loss: 0.1558 - mae: 0.2911 - val_loss: 0.2676 - val_mae: 0.3522</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Epoch 51/100</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">190/190 [==============================] - 20s 107ms/step - loss: 0.1549 - mae: 0.2900 - val_loss: 0.2684 - val_mae: 0.3535</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Epoch 52/100</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">190/190 [==============================] - 21s 108ms/step - loss: 0.1543 - mae: 0.2895 - val_loss: 0.2707 - val_mae: 0.3553</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Epoch 53/100</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">190/190 [==============================] - 21s 110ms/step - loss: 0.1535 - mae: 0.2886 - val_loss: 0.2673 - val_mae: 0.3528</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Epoch 54/100</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">190/190 [==============================] - 20s 106ms/step - loss: 0.1531 - mae: 0.2880 - val_loss: 0.2672 - val_mae: 0.3523</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Epoch 55/100</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">190/190 [==============================] - 20s 108ms/step - loss: 0.1519 - mae: 0.2870 - val_loss: 0.2673 - val_mae: 0.3528</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Epoch 56/100</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">190/190 [==============================] - 21s 109ms/step - loss: 0.1513 - mae: 0.2862 - val_loss: 0.2670 - val_mae: 0.3528</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Epoch 57/100</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">190/190 [==============================] - 20s 107ms/step - loss: 0.1503 - mae: 0.2852 - val_loss: 0.2684 - val_mae: 0.3535</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Epoch 58/100</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">190/190 [==============================] - 20s 108ms/step - loss: 0.1497 - mae: 0.2847 - val_loss: 0.2678 - val_mae: 0.3526</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Epoch 59/100</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">190/190 [==============================] - 21s 110ms/step - loss: 0.1489 - mae: 0.2837 - val_loss: 0.2668 - val_mae: 0.3514</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Epoch 60/100</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">190/190 [==============================] - 20s 106ms/step - loss: 0.1480 - mae: 0.2828 - val_loss: 0.2681 - val_mae: 0.3531</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Epoch 61/100</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">190/190 [==============================] - 21s 108ms/step - loss: 0.1476 - mae: 0.2822 - val_loss: 0.2675 - val_mae: 0.3520</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Epoch 62/100</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">190/190 [==============================] - 21s 110ms/step - loss: 0.1474 - mae: 0.2818 - val_loss: 0.2674 - val_mae: 0.3518</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Epoch 63/100</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">190/190 [==============================] - 20s 107ms/step - loss: 0.1465 - mae: 0.2809 - val_loss: 0.2670 - val_mae: 0.3508</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Epoch 64/100</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">190/190 [==============================] - 21s 108ms/step - loss: 0.1462 - mae: 0.2808 - val_loss: 0.2655 - val_mae: 0.3499</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Epoch 65/100</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">190/190 [==============================] - 21s 110ms/step - loss: 0.1455 - mae: 0.2800 - val_loss: 0.2678 - val_mae: 0.3510</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Epoch 66/100</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">190/190 [==============================] - 20s 107ms/step - loss: 0.1445 - mae: 0.2789 - val_loss: 0.2679 - val_mae: 0.3507</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Epoch 67/100</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">190/190 [==============================] - 20s 103ms/step - loss: 0.1438 - mae: 0.2780 - val_loss: 0.2680 - val_mae: 0.3507</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Epoch 68/100</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">190/190 [==============================] - 20s 106ms/step - loss: 0.1434 - mae: 0.2777 - val_loss: 0.2683 - val_mae: 0.3514</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Epoch 69/100</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">190/190 [==============================] - 22s 113ms/step - loss: 0.1424 - mae: 0.2769 - val_loss: 0.2693 - val_mae: 0.3516</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Epoch 70/100</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">190/190 [==============================] - 20s 108ms/step - loss: 0.1426 - mae: 0.2768 - val_loss: 0.2679 - val_mae: 0.3508</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Epoch 71/100</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">190/190 [==============================] - 20s 105ms/step - loss: 0.1410 - mae: 0.2752 - val_loss: 0.2672 - val_mae: 0.3505</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Epoch 72/100</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">190/190 [==============================] - 21s 113ms/step - loss: 0.1410 - mae: 0.2749 - val_loss: 0.2663 - val_mae: 0.3493</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Epoch 73/100</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">190/190 [==============================] - 20s 108ms/step - loss: 0.1404 - mae: 0.2742 - val_loss: 0.2681 - val_mae: 0.3512</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Epoch 74/100</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">190/190 [==============================] - 20s 105ms/step - loss: 0.1398 - mae: 0.2738 - val_loss: 0.2666 - val_mae: 0.3490</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Epoch 75/100</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">190/190 [==============================] - 22s 114ms/step - loss: 0.1400 - mae: 0.2736 - val_loss: 0.2663 - val_mae: 0.3497</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Epoch 76/100</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">190/190 [==============================] - 20s 108ms/step - loss: 0.1393 - mae: 0.2731 - val_loss: 0.2665 - val_mae: 0.3494</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Epoch 77/100</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">190/190 [==============================] - 20s 105ms/step - loss: 0.1388 - mae: 0.2724 - val_loss: 0.2672 - val_mae: 0.3505</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Epoch 78/100</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">190/190 [==============================] - 22s 114ms/step - loss: 0.1386 - mae: 0.2720 - val_loss: 0.2678 - val_mae: 0.3499</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Epoch 79/100</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">190/190 [==============================] - 20s 107ms/step - loss: 0.1382 - mae: 0.2717 - val_loss: 0.2678 - val_mae: 0.3497</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Epoch 80/100</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">190/190 [==============================] - 20s 104ms/step - loss: 0.1377 - mae: 0.2711 - val_loss: 0.2675 - val_mae: 0.3497</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Epoch 81/100</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">190/190 [==============================] - 22s 113ms/step - loss: 0.1374 - mae: 0.2709 - val_loss: 0.2669 - val_mae: 0.3495</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Epoch 82/100</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">190/190 [==============================] - 20s 107ms/step - loss: 0.1370 - mae: 0.2702 - val_loss: 0.2674 - val_mae: 0.3496</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Epoch 83/100</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">190/190 [==============================] - 20s 104ms/step - loss: 0.1362 - mae: 0.2692 - val_loss: 0.2675 - val_mae: 0.3504</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Epoch 84/100</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">190/190 [==============================] - 21s 113ms/step - loss: 0.1358 - mae: 0.2690 - val_loss: 0.2664 - val_mae: 0.3496</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Epoch 85/100</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">190/190 [==============================] - 20s 107ms/step - loss: 0.1351 - mae: 0.2681 - val_loss: 0.2692 - val_mae: 0.3511</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Epoch 86/100</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">190/190 [==============================] - 20s 104ms/step - loss: 0.1352 - mae: 0.2679 - val_loss: 0.2671 - val_mae: 0.3498</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Epoch 87/100</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">190/190 [==============================] - 21s 113ms/step - loss: 0.1346 - mae: 0.2675 - val_loss: 0.2687 - val_mae: 0.3503</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Epoch 88/100</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">190/190 [==============================] - 20s 108ms/step - loss: 0.1343 - mae: 0.2672 - val_loss: 0.2691 - val_mae: 0.3494</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Epoch 89/100</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">190/190 [==============================] - 20s 103ms/step - loss: 0.1337 - mae: 0.2667 - val_loss: 0.2687 - val_mae: 0.3503</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Epoch 90/100</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">190/190 [==============================] - 20s 104ms/step - loss: 0.1335 - mae: 0.2660 - val_loss: 0.2689 - val_mae: 0.3502</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Epoch 91/100</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">190/190 [==============================] - 20s 106ms/step - loss: 0.1334 - mae: 0.2659 - val_loss: 0.2686 - val_mae: 0.3494</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Epoch 92/100</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">190/190 [==============================] - 20s 108ms/step - loss: 0.1331 - mae: 0.2657 - val_loss: 0.2674 - val_mae: 0.3489</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Epoch 93/100</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">190/190 [==============================] - 20s 104ms/step - loss: 0.1326 - mae: 0.2649 - val_loss: 0.2664 - val_mae: 0.3486</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Epoch 94/100</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">190/190 [==============================] - 20s 105ms/step - loss: 0.1320 - mae: 0.2644 - val_loss: 0.2668 - val_mae: 0.3486</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Epoch 95/100</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">190/190 [==============================] - 20s 107ms/step - loss: 0.1322 - mae: 0.2645 - val_loss: 0.2683 - val_mae: 0.3494</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Epoch 96/100</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">190/190 [==============================] - 20s 104ms/step - loss: 0.1313 - mae: 0.2637 - val_loss: 0.2675 - val_mae: 0.3496</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Epoch 97/100</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">190/190 [==============================] - 20s 106ms/step - loss: 0.1313 - mae: 0.2636 - val_loss: 0.2666 - val_mae: 0.3485</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Epoch 98/100</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">190/190 [==============================] - 20s 108ms/step - loss: 0.1309 - mae: 0.2633 - val_loss: 0.2679 - val_mae: 0.3493</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Epoch 99/100</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">190/190 [==============================] - 20s 103ms/step - loss: 0.1309 - mae: 0.2629 - val_loss: 0.2670 - val_mae: 0.3487</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Epoch 100/100</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">190/190 [==============================] - 20s 106ms/step - loss: 0.1301 - mae: 0.2622 - val_loss: 0.2667 - val_mae: 0.3485</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">model.save(&#x27;./models/model_201203.h5&#x27;)</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">hist_df = pd.DataFrame(history.history) </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">hist_csv_file = &#x27;./outputs/history.csv&#x27;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">with open(hist_csv_file, mode=&#x27;w&#x27;) as f:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  hist_df.to_csv(f)</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">from scipy.special import inv_boxcox</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">from sklearn.metrics import r2_score, median_absolute_error, mean_absolute_error</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">y_pred = model.predict(X_test).flatten()</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">a = inv_boxcox(y_test.flatten(), fitted_lambda)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">b = inv_boxcox(y_pred.flatten(), fitted_lambda)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">print(&#x27;r2_score: &#x27;, r2_score(a, b))</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">print(&#x27;median_absolute_error: &#x27;, median_absolute_error(a, b))</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">print(&#x27;mean_absolute_error&#x27;, mean_absolute_error(a, b))</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">out2 = pd.DataFrame({&#x27;y_true&#x27;:inv_boxcox(y_test.flatten(), fitted_lambda), &#x27;y_pred&#x27;:inv_boxcox(y_pred.flatten(), fitted_lambda)})</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">r2_score:  0.7725025811056968</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">median_absolute_error:  0.49407594919204767</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">mean_absolute_error 3.357431710265042</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">out2.head()</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><table><thead><tr><th></th><th>y_true</th><th>y_pred</th></tr></thead><tbody><tr><td>0</td><td>4.65</td><td>10.811751</td></tr><tr><td>1</td><td>7.6</td><td>7.666917</td></tr><tr><td>2</td><td>1.1</td><td>0.746361</td></tr><tr><td>3</td><td>0.72</td><td>0.291657</td></tr><tr><td>4</td><td>41.4</td><td>31.236202</td></tr></tbody></table><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">_, out1 = train_test_split(df, test_size=0.1, random_state=40)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">out1[&#x27;RESALE&#x27;] = out2.y_true.values</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">out1[&#x27;PRED&#x27;] = out2.y_pred.values</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">out1.to_csv(&#x27;./outputs/result.csv&#x27;, index=False)</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">out1.sample(10)</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><table><thead><tr><th></th><th>BRAND</th><th>PARTNO</th><th>QUANTITY</th><th>UNITCOST</th><th>RESALE</th><th>PRED</th></tr></thead><tbody><tr><td>174877</td><td>155</td><td>TLM-6X1C-12</td><td>2500-4999</td><td>0.09</td><td>0.15</td><td>0.170021</td></tr><tr><td>39616</td><td>59</td><td>MS3498-9</td><td>500-999</td><td>1.12</td><td>1.5</td><td>1.150005</td></tr><tr><td>18036</td><td>30</td><td>8106-A-0440-17</td><td>500-999</td><td>0.17</td><td>0.4</td><td>0.61341</td></tr><tr><td>406828</td><td>662</td><td>250-0201-01</td><td>50-99</td><td>3.01</td><td>5</td><td>4.733656</td></tr><tr><td>78736</td><td>78</td><td>SC-16-SB</td><td>05-Sep</td><td>59.05</td><td>84.35</td><td>91.922928</td></tr><tr><td>116973</td><td>116</td><td>NAS6206-18</td><td>01-Apr</td><td>2.18</td><td>25</td><td>24.017282</td></tr><tr><td>59365</td><td>63</td><td>MS21087-4</td><td>25-49</td><td>3.5</td><td>5.22</td><td>7.015954</td></tr><tr><td>256983</td><td>350</td><td>0326010.HXP</td><td>Oct-24</td><td>0.4</td><td>4.5</td><td>4.300601</td></tr><tr><td>211941</td><td>212</td><td>MS91528-1F2B</td><td>25-49</td><td>2.55</td><td>4.4</td><td>4.558315</td></tr><tr><td>334493</td><td>525</td><td>M24243/1A404</td><td>5000-9999</td><td>0.12</td><td>0.26</td><td>0.203509</td></tr></tbody></table></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/sparsh-ai/ai-kb/docs/04-tutorials/resale-price-prediction.mdx" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_dcUD" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_foO9"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/ai-kb/docs/tutorials/regression"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Regression</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/ai-kb/docs/tutorials/text-cleaning"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Text Cleaning</div></a></div></nav></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2022 AIKB Docs, Inc. Built with Docusaurus.</div></div></div></footer></div>
<script src="/ai-kb/assets/js/runtime~main.65743e6b.js"></script>
<script src="/ai-kb/assets/js/main.ed9e086a.js"></script>
</body>
</html>