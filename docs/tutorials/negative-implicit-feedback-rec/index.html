<!doctype html>
<html class="docs-version-current" lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.17">
<link rel="alternate" type="application/rss+xml" href="/ai-kb/blog/rss.xml" title="AIKB RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/ai-kb/blog/atom.xml" title="AIKB Atom Feed">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.13.24/dist/katex.min.css" integrity="sha384-odtC+0UGzzFL/6PNoE8rX/SPcQDXBJ+uRepguP4QkPCm2LBxH3FA3y+fKSiJ+AmM" crossorigin="anonymous"><title data-rh="true">Negative Implicit Feedback in Recommendations | AIKB</title><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://kb.recohut.com/ai-kb/docs/tutorials/negative-implicit-feedback-rec"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Negative Implicit Feedback in Recommendations | AIKB"><meta data-rh="true" name="description" content="A tutorial to demonstrate the process of training and evaluating various recommender models on a online retail store data. Along with the positive feedbacks like view, add-to-cart, we also have a negative event &#x27;remove-from-cart&#x27;."><meta data-rh="true" property="og:description" content="A tutorial to demonstrate the process of training and evaluating various recommender models on a online retail store data. Along with the positive feedbacks like view, add-to-cart, we also have a negative event &#x27;remove-from-cart&#x27;."><link data-rh="true" rel="icon" href="/ai-kb/img/logo.svg"><link data-rh="true" rel="canonical" href="https://kb.recohut.com/ai-kb/docs/tutorials/negative-implicit-feedback-rec"><link data-rh="true" rel="alternate" href="https://kb.recohut.com/ai-kb/docs/tutorials/negative-implicit-feedback-rec" hreflang="en"><link data-rh="true" rel="alternate" href="https://kb.recohut.com/ai-kb/docs/tutorials/negative-implicit-feedback-rec" hreflang="x-default"><link rel="stylesheet" href="/ai-kb/assets/css/styles.af9e0313.css">
<link rel="preload" href="/ai-kb/assets/js/runtime~main.6de31ed9.js" as="script">
<link rel="preload" href="/ai-kb/assets/js/main.cf94d7b4.js" as="script">
</head>
<body class="navigation-with-keyboard" data-theme="light">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div role="region"><a href="#" class="skipToContent_ZgBM">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/ai-kb/"><div class="navbar__logo"><img src="/ai-kb/img/logo.svg" alt="aikb Logo" class="themedImage_W2Cr themedImage--light_TfLj"><img src="/ai-kb/img/logo.svg" alt="aikb Logo" class="themedImage_W2Cr themedImage--dark_oUvU"></div><b class="navbar__title">AIKB</b></a><a class="navbar__item navbar__link navbar__link--active" href="/ai-kb/docs/intro">Docs</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/sparsh-ai/ai-kb" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link"><span>GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_I5OW"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a><div class="toggle_S7eR toggle_TdHA toggleDisabled_f9M3"><div class="toggleButton_rCf9" role="button" tabindex="-1"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_v35p"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_nQuB"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></div><input type="checkbox" class="toggleScreenReader_g2nN" aria-label="Switch between dark and light mode (currently light mode)"></div><div class="dsla-search-wrapper"><div class="dsla-search-field" data-tags="default,docs-default-current"></div></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper docs-wrapper docs-doc-page"><div class="docPage_P2Lg"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_RiI4" type="button"></button><aside class="theme-doc-sidebar-container docSidebarContainer_rKC_"><div class="sidebar_CW9Y"><nav class="menu thin-scrollbar menu_SkdO"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/ai-kb/docs/intro">Introduction</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/ai-kb/docs/projects/">Projects</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link" href="/ai-kb/docs/concepts/">Concepts</a><button aria-label="Toggle the collapsible sidebar category &#x27;Concepts&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--active" href="/ai-kb/docs/tutorials/">Tutorials</a><button aria-label="Toggle the collapsible sidebar category &#x27;Tutorials&#x27;" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/ai-kb/docs/tutorials/amazon-personalize">Amazon Personalize</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/ai-kb/docs/tutorials/data-loading">Data Loading</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/ai-kb/docs/tutorials/database-conn">Database Connections</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/ai-kb/docs/tutorials/email-classification">Email Classification</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/ai-kb/docs/tutorials/graph">Graph-based Modeling</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/ai-kb/docs/tutorials/kubernetes">Kubernetes</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/ai-kb/docs/tutorials/mathematics">Mathematics</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/ai-kb/docs/tutorials/matrix-factorizations">Matrix Factorizations</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/ai-kb/docs/tutorials/mlops">MLOps</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/ai-kb/docs/tutorials/model-optimization">Model Optimization</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/ai-kb/docs/tutorials/multi-touch-attribution">Multi-Touch Attribution</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/ai-kb/docs/tutorials/name-address-parsing">Name and Address Parsing</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/ai-kb/docs/tutorials/negative-implicit-feedback-rec">Negative Implicit Feedback in Recommendations</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/ai-kb/docs/tutorials/outliers-handling">Outliers Handling</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/ai-kb/docs/tutorials/pdf-to-wordcloud-mail">PDF to WordCloud via Email</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/ai-kb/docs/tutorials/python-snippets">Python code</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/ai-kb/docs/tutorials/recsys-evaluation">Recommender System Evaluation</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/ai-kb/docs/tutorials/regression">Regression</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/ai-kb/docs/tutorials/resale-price-prediction">Resale Price Prediction</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/ai-kb/docs/tutorials/text-cleaning">Text Cleaning</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/ai-kb/docs/tutorials/text-embeddings">Text Embeddings</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/ai-kb/docs/tutorials/text-processing">Text Processing</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/ai-kb/docs/tutorials/unix-shell-snippets">Unix shell</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/ai-kb/docs/tutorials/vector-search">Vector Search</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/ai-kb/docs/tutorials/word2vec">Word2vec</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link" href="/ai-kb/docs/tools/">Tools</a><button aria-label="Toggle the collapsible sidebar category &#x27;Tools&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/ai-kb/docs/notebooks/">Notebooks</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link" href="/ai-kb/docs/best-practices/">Best Practices</a><button aria-label="Toggle the collapsible sidebar category &#x27;Best Practices&#x27;" type="button" class="clean-btn menu__caret"></button></div></li></ul></nav></div></aside><main class="docMainContainer_TCnq"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_DM6M"><div class="docItemContainer_vinB"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Xlws" aria-label="breadcrumbs"><ul class="breadcrumbs"><li class="breadcrumbs__item"><a class="breadcrumbs__link breadcrumbsItemLink_e5ie" href="/ai-kb/">🏠</a></li><li class="breadcrumbs__item"><a class="breadcrumbs__link breadcrumbsItemLink_e5ie" href="/ai-kb/docs/tutorials/">Tutorials</a></li><li class="breadcrumbs__item breadcrumbs__item--active"><a class="breadcrumbs__link breadcrumbsItemLink_e5ie" href="/ai-kb/docs/tutorials/negative-implicit-feedback-rec">Negative Implicit Feedback in Recommendations</a></li></ul></nav><div class="tocCollapsible_jdIR theme-doc-toc-mobile tocMobile_TmEX"><button type="button" class="clean-btn tocCollapsibleButton_Fzxq">On this page</button></div><div class="theme-doc-markdown markdown"><h1>Negative Implicit Feedback in Recommendations</h1><blockquote><p>A tutorial to demonstrate the process of training and evaluating various recommender models on a online retail store data. Along with the positive feedbacks like view, add-to-cart, we also have a negative event &#x27;remove-from-cart&#x27;.</p></blockquote><a href="https://nbviewer.org/github/recohut/nbs/blob/main/2021-04-25-Recommender-Implicit-Negative-Feedback.ipynb" target="_blank" rel="noopener noreferrer" alt=""> <img src="https://colab.research.google.com/assets/colab-badge.svg"></a><div class="codeBlockContainer_I0IT language-python theme-code-block"><div class="codeBlockContent_wNvx python"><pre tabindex="0" class="prism-code language-python codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">!pip install git</span><span class="token operator" style="color:#393A34">+</span><span class="token plain">https</span><span class="token punctuation" style="color:#393A34">:</span><span class="token operator" style="color:#393A34">//</span><span class="token plain">github</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">com</span><span class="token operator" style="color:#393A34">/</span><span class="token plain">maciejkula</span><span class="token operator" style="color:#393A34">/</span><span class="token plain">spotlight</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">git@master</span><span class="token comment" style="color:#999988;font-style:italic">#egg=spotlight</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">!git clone https</span><span class="token punctuation" style="color:#393A34">:</span><span class="token operator" style="color:#393A34">//</span><span class="token plain">github</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">com</span><span class="token operator" style="color:#393A34">/</span><span class="token plain">microsoft</span><span class="token operator" style="color:#393A34">/</span><span class="token plain">recommenders</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">git</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">!pip install cornac</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">!pip install pandas</span><span class="token operator" style="color:#393A34">==</span><span class="token number" style="color:#36acaa">0.25</span><span class="token number" style="color:#36acaa">.0</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><div class="codeBlockContainer_I0IT language-python theme-code-block"><div class="codeBlockContent_wNvx python"><pre tabindex="0" class="prism-code language-python codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> os</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> sys</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> math</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> random</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> datetime</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> itertools</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> numpy </span><span class="token keyword" style="color:#00009f">as</span><span class="token plain"> np</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> pandas </span><span class="token keyword" style="color:#00009f">as</span><span class="token plain"> pd</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> seaborn </span><span class="token keyword" style="color:#00009f">as</span><span class="token plain"> sns</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> matplotlib</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">pyplot </span><span class="token keyword" style="color:#00009f">as</span><span class="token plain"> plt</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> sklearn </span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> preprocessing</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> scipy</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">sparse </span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> csr_matrix</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> dok_matrix</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> sklearn</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">model_selection </span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> ParameterGrid</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> fastai</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">collab </span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">*</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> fastai</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">tabular </span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">*</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> fastai</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">text </span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">*</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> cornac</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> spotlight</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">interactions </span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> Interactions</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> spotlight</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">interactions </span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> SequenceInteractions</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> spotlight</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">cross_validation </span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> random_train_test_split</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> spotlight</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">cross_validation </span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> user_based_train_test_split</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> spotlight</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">factorization</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">implicit </span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> ImplicitFactorizationModel</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> spotlight</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">evaluation </span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> mrr_score</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> spotlight</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">evaluation </span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> precision_recall_score</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> spotlight</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">interactions </span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> Interactions</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> spotlight</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">cross_validation </span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> random_train_test_split</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> spotlight</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">cross_validation </span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> user_based_train_test_split</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> spotlight</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">factorization</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">implicit </span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> ImplicitFactorizationModel</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> spotlight</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">evaluation </span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> mrr_score</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> spotlight</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">evaluation </span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> precision_recall_score</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> spotlight</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">interactions </span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> SequenceInteractions</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> spotlight</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">sequence</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">implicit </span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> ImplicitSequenceModel</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> spotlight</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">evaluation </span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> sequence_mrr_score</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> spotlight</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">evaluation </span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> sequence_precision_recall_score</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> warnings</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">warnings</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">filterwarnings</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;ignore&quot;</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><div class="codeBlockContainer_I0IT language-python theme-code-block"><div class="codeBlockContent_wNvx python"><pre tabindex="0" class="prism-code language-python codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">sys</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">path</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">append</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;/content/recommenders/&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> reco_utils</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">dataset</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">python_splitters </span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> python_chrono_split</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> reco_utils</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">evaluation</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">python_evaluation </span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> map_at_k</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> reco_utils</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">evaluation</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">python_evaluation </span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> precision_at_k</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> reco_utils</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">evaluation</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">python_evaluation </span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> ndcg_at_k </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> reco_utils</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">evaluation</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">python_evaluation </span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> recall_at_k</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> reco_utils</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">evaluation</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">python_evaluation </span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> get_top_k_items</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> reco_utils</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">recommender</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">cornac</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">cornac_utils </span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> predict_ranking</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><h2 class="anchor anchorWithStickyNavbar_mojV" id="data-loading">Data Loading<a class="hash-link" href="#data-loading" title="Direct link to heading">​</a></h2><div class="codeBlockContainer_I0IT language-python theme-code-block"><div class="codeBlockContent_wNvx python"><pre tabindex="0" class="prism-code language-python codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># loading data</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">df </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> pd</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">read_csv</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;rawdata.csv&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> header </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                 names </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&#x27;event&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token string" style="color:#e3116c">&#x27;userid&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token string" style="color:#e3116c">&#x27;itemid&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token string" style="color:#e3116c">&#x27;timestamp&#x27;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                 dtype</span><span class="token operator" style="color:#393A34">=</span><span class="token punctuation" style="color:#393A34">{</span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">:</span><span class="token string" style="color:#e3116c">&#x27;category&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">:</span><span class="token string" style="color:#e3116c">&#x27;category&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">2</span><span class="token punctuation" style="color:#393A34">:</span><span class="token string" style="color:#e3116c">&#x27;category&#x27;</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                 parse_dates</span><span class="token operator" style="color:#393A34">=</span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&#x27;timestamp&#x27;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><div class="codeBlockContainer_I0IT language-python theme-code-block"><div class="codeBlockContent_wNvx python"><pre tabindex="0" class="prism-code language-python codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">df</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">head</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><div class="codeBlockContainer_I0IT language-python theme-code-block"><div class="codeBlockContent_wNvx python"><pre tabindex="0" class="prism-code language-python codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">df</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">info</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">&lt;class &#x27;pandas.core.frame.DataFrame&#x27;&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">RangeIndex: 99998 entries, 0 to 99997</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Data columns (total 4 columns):</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">event        99998 non-null category</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">userid       99998 non-null category</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">itemid       99998 non-null category</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">timestamp    99998 non-null datetime64[ns, UTC]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">dtypes: category(3), datetime64[ns, UTC](1)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">memory usage: 1.7 MB</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><h2 class="anchor anchorWithStickyNavbar_mojV" id="wrangling">Wrangling<a class="hash-link" href="#wrangling" title="Direct link to heading">​</a></h2><h3 class="anchor anchorWithStickyNavbar_mojV" id="removing-duplicates">Removing Duplicates<a class="hash-link" href="#removing-duplicates" title="Direct link to heading">​</a></h3><div class="codeBlockContainer_I0IT language-python theme-code-block"><div class="codeBlockContent_wNvx python"><pre tabindex="0" class="prism-code language-python codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># dropping exact duplicates</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">df </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> df</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">drop_duplicates</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><h3 class="anchor anchorWithStickyNavbar_mojV" id="label-encoding">Label Encoding<a class="hash-link" href="#label-encoding" title="Direct link to heading">​</a></h3><div class="codeBlockContainer_I0IT language-python theme-code-block"><div class="codeBlockContent_wNvx python"><pre tabindex="0" class="prism-code language-python codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># userid normalization</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">userid_encoder </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> preprocessing</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">LabelEncoder</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">df</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">userid </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> userid_encoder</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">fit_transform</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">df</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">userid</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># itemid normalization</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">itemid_encoder </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> preprocessing</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">LabelEncoder</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">df</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">itemid </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> itemid_encoder</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">fit_transform</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">df</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">itemid</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><h2 class="anchor anchorWithStickyNavbar_mojV" id="exploration">Exploration<a class="hash-link" href="#exploration" title="Direct link to heading">​</a></h2><div class="codeBlockContainer_I0IT language-python theme-code-block"><div class="codeBlockContent_wNvx python"><pre tabindex="0" class="prism-code language-python codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">df</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">describe</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">T</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><div class="codeBlockContainer_I0IT language-python theme-code-block"><div class="codeBlockContent_wNvx python"><pre tabindex="0" class="prism-code language-python codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">df</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">describe</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">exclude</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&#x27;int&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">T</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><div class="codeBlockContainer_I0IT language-python theme-code-block"><div class="codeBlockContent_wNvx python"><pre tabindex="0" class="prism-code language-python codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">df</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">timestamp</span><span class="token punctuation" style="color:#393A34">.</span><span class="token builtin">max</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">-</span><span class="token plain"> df</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">timestamp</span><span class="token punctuation" style="color:#393A34">.</span><span class="token builtin">min</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">Timedelta(&#x27;56 days 20:56:50.132000&#x27;)</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><div class="codeBlockContainer_I0IT language-python theme-code-block"><div class="codeBlockContent_wNvx python"><pre tabindex="0" class="prism-code language-python codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">df</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">event</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">value_counts</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">begin_checkout      41459</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">view_item           35397</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">purchase             9969</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">add_to_cart          7745</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">remove_from_cart     4862</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Name: event, dtype: int64</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><div class="codeBlockContainer_I0IT language-python theme-code-block"><div class="codeBlockContent_wNvx python"><pre tabindex="0" class="prism-code language-python codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">df</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">event</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">value_counts</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token operator" style="color:#393A34">/</span><span class="token plain">df</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">userid</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">nunique</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">begin_checkout      3.612355</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">view_item           3.084168</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">purchase            0.868607</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">add_to_cart         0.674828</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">remove_from_cart    0.423630</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Name: event, dtype: float64</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><h3 class="anchor anchorWithStickyNavbar_mojV" id="user-interactions">User Interactions<a class="hash-link" href="#user-interactions" title="Direct link to heading">​</a></h3><div class="codeBlockContainer_I0IT language-python theme-code-block"><div class="codeBlockContent_wNvx python"><pre tabindex="0" class="prism-code language-python codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># User events</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">user_activity_count </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token builtin">dict</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">for</span><span class="token plain"> row </span><span class="token keyword" style="color:#00009f">in</span><span class="token plain"> df</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">itertuples</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> row</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">userid </span><span class="token keyword" style="color:#00009f">not</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">in</span><span class="token plain"> user_activity_count</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        user_activity_count</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">row</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">userid</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token string" style="color:#e3116c">&#x27;view_item&#x27;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                                           </span><span class="token string" style="color:#e3116c">&#x27;add_to_cart&#x27;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                                           </span><span class="token string" style="color:#e3116c">&#x27;begin_checkout&#x27;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                                           </span><span class="token string" style="color:#e3116c">&#x27;remove_from_cart&#x27;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                                           </span><span class="token string" style="color:#e3116c">&#x27;purchase&#x27;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> row</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">event </span><span class="token operator" style="color:#393A34">==</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;view_item&#x27;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        user_activity_count</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">row</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">userid</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&#x27;view_item&#x27;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">+=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">elif</span><span class="token plain"> row</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">event </span><span class="token operator" style="color:#393A34">==</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;add_to_cart&#x27;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        user_activity_count</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">row</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">userid</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&#x27;add_to_cart&#x27;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">+=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">elif</span><span class="token plain"> row</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">event </span><span class="token operator" style="color:#393A34">==</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;begin_checkout&#x27;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        user_activity_count</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">row</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">userid</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&#x27;begin_checkout&#x27;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">+=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">elif</span><span class="token plain"> row</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">event </span><span class="token operator" style="color:#393A34">==</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;remove_from_cart&#x27;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        user_activity_count</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">row</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">userid</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&#x27;remove_from_cart&#x27;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">+=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">elif</span><span class="token plain"> row</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">event </span><span class="token operator" style="color:#393A34">==</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;purchase&#x27;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        user_activity_count</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">row</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">userid</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&#x27;purchase&#x27;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">+=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">user_activity </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> pd</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">DataFrame</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">user_activity_count</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">user_activity </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> user_activity</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">transpose</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">user_activity</span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&#x27;activity&#x27;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> user_activity</span><span class="token punctuation" style="color:#393A34">.</span><span class="token builtin">sum</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">axis</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">tempDF </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> pd</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">DataFrame</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">user_activity</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">activity</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">value_counts</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">reset_index</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">tempDF</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">columns </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&#x27;#Interactions&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token string" style="color:#e3116c">&#x27;#Users&#x27;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">sns</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">scatterplot</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">x</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&#x27;#Interactions&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> y</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&#x27;#Users&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> data</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">tempDF</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><p><img loading="lazy" src="data:image/png;base64,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" width="406" height="262"></p><div class="codeBlockContainer_I0IT language-python theme-code-block"><div class="codeBlockContent_wNvx python"><pre tabindex="0" class="prism-code language-python codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">df_activity </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> user_activity</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">copy</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">event </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> df_activity</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">columns</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">astype</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;str&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">sns</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">countplot</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">df_activity</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">loc</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">df_activity</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">event</span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">]</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">event</span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><p><img loading="lazy" src="/ai-kb/assets/images/260222_neg_implicit_2-45bdeff502a3c6bda2e711704c3e7d2f.png" width="402" height="263"></p><h3 class="anchor anchorWithStickyNavbar_mojV" id="add-to-cart-event-counts">Add-to-cart Event Counts<a class="hash-link" href="#add-to-cart-event-counts" title="Direct link to heading">​</a></h3><div class="codeBlockContainer_I0IT language-python theme-code-block"><div class="codeBlockContent_wNvx python"><pre tabindex="0" class="prism-code language-python codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">sns</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">countplot</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">df_activity</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">loc</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">df_activity</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">event</span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">]</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">event</span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">plt</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">show</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><p><img loading="lazy" src="data:image/png;base64,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" width="395" height="263"></p><h3 class="anchor anchorWithStickyNavbar_mojV" id="purchase-event-counts">Purchase Event Counts<a class="hash-link" href="#purchase-event-counts" title="Direct link to heading">​</a></h3><div class="codeBlockContainer_I0IT language-python theme-code-block"><div class="codeBlockContent_wNvx python"><pre tabindex="0" class="prism-code language-python codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">sns</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">countplot</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">df_activity</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">loc</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">df_activity</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">event</span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">4</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">]</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">event</span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">4</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">plt</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">show</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><p><img loading="lazy" src="data:image/png;base64,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" width="395" height="262"></p><h3 class="anchor anchorWithStickyNavbar_mojV" id="item-interactions">Item Interactions<a class="hash-link" href="#item-interactions" title="Direct link to heading">​</a></h3><div class="codeBlockContainer_I0IT language-python theme-code-block"><div class="codeBlockContent_wNvx python"><pre tabindex="0" class="prism-code language-python codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># item events</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">item_activity_count </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token builtin">dict</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">for</span><span class="token plain"> row </span><span class="token keyword" style="color:#00009f">in</span><span class="token plain"> df</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">itertuples</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> row</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">itemid </span><span class="token keyword" style="color:#00009f">not</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">in</span><span class="token plain"> item_activity_count</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        item_activity_count</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">row</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">itemid</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token string" style="color:#e3116c">&#x27;view_item&#x27;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                                           </span><span class="token string" style="color:#e3116c">&#x27;add_to_cart&#x27;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                                           </span><span class="token string" style="color:#e3116c">&#x27;begin_checkout&#x27;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                                           </span><span class="token string" style="color:#e3116c">&#x27;remove_from_cart&#x27;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                                           </span><span class="token string" style="color:#e3116c">&#x27;purchase&#x27;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> row</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">event </span><span class="token operator" style="color:#393A34">==</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;view_item&#x27;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        item_activity_count</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">row</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">itemid</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&#x27;view_item&#x27;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">+=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">elif</span><span class="token plain"> row</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">event </span><span class="token operator" style="color:#393A34">==</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;add_to_cart&#x27;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        item_activity_count</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">row</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">itemid</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&#x27;add_to_cart&#x27;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">+=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">elif</span><span class="token plain"> row</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">event </span><span class="token operator" style="color:#393A34">==</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;begin_checkout&#x27;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        item_activity_count</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">row</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">itemid</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&#x27;begin_checkout&#x27;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">+=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">elif</span><span class="token plain"> row</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">event </span><span class="token operator" style="color:#393A34">==</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;remove_from_cart&#x27;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        item_activity_count</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">row</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">itemid</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&#x27;remove_from_cart&#x27;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">+=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">elif</span><span class="token plain"> row</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">event </span><span class="token operator" style="color:#393A34">==</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;purchase&#x27;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        item_activity_count</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">row</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">itemid</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&#x27;purchase&#x27;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">+=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">item_activity </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> pd</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">DataFrame</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">item_activity_count</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">item_activity </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> item_activity</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">transpose</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">item_activity</span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&#x27;activity&#x27;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> item_activity</span><span class="token punctuation" style="color:#393A34">.</span><span class="token builtin">sum</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">axis</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">tempDF </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> pd</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">DataFrame</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">item_activity</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">activity</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">value_counts</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">reset_index</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">tempDF</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">columns </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&#x27;#Interactions&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token string" style="color:#e3116c">&#x27;#Items&#x27;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">sns</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">scatterplot</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">x</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&#x27;#Interactions&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> y</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&#x27;#Items&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> data</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">tempDF</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><p><img loading="lazy" src="/ai-kb/assets/images/260222_neg_implicit_5-937fe972cd3d1a2f4ef5675f82285a10.png" width="389" height="262"></p><div class="codeBlockContainer_I0IT language-python theme-code-block"><div class="codeBlockContent_wNvx python"><pre tabindex="0" class="prism-code language-python codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">plt</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">rcParams</span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&#x27;figure.figsize&#x27;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">15</span><span class="token punctuation" style="color:#393A34">,</span><span class="token number" style="color:#36acaa">3</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">data </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> pd</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">DataFrame</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">pd</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">to_datetime</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">df</span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&#x27;timestamp&#x27;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> infer_datetime_format</span><span class="token operator" style="color:#393A34">=</span><span class="token boolean" style="color:#36acaa">True</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">data</span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&#x27;Count&#x27;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">data</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">set_index</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;timestamp&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> inplace</span><span class="token operator" style="color:#393A34">=</span><span class="token boolean" style="color:#36acaa">True</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">data </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> data</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">resample</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;D&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token builtin">apply</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">{</span><span class="token string" style="color:#e3116c">&#x27;Count&#x27;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token string" style="color:#e3116c">&#x27;count&#x27;</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ax </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> data</span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&#x27;Count&#x27;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">plot</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">marker</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&#x27;o&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> linestyle</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&#x27;-&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><p><img loading="lazy" src="/ai-kb/assets/images/260222_neg_implicit_6-e327563ad5d131aa9cee2095826ecbb8.png" width="890" height="243"></p><h2 class="anchor anchorWithStickyNavbar_mojV" id="rule-based-approaches">Rule-based Approaches<a class="hash-link" href="#rule-based-approaches" title="Direct link to heading">​</a></h2><h3 class="anchor anchorWithStickyNavbar_mojV" id="top-n-trending-products">Top-N Trending Products<a class="hash-link" href="#top-n-trending-products" title="Direct link to heading">​</a></h3><div class="codeBlockContainer_I0IT language-python theme-code-block"><div class="codeBlockContent_wNvx python"><pre tabindex="0" class="prism-code language-python codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">def</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">top_trending</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">n</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> timeperiod</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> timestamp</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  start </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token builtin">str</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">timestamp</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">replace</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">microsecond</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">-</span><span class="token plain"> pd</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">Timedelta</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">minutes</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">timeperiod</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  end </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token builtin">str</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">timestamp</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">replace</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">microsecond</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  trending_items </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> df</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">loc</span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">df</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">timestamp</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">between</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">start</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">end</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&amp;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">df</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">event</span><span class="token operator" style="color:#393A34">==</span><span class="token string" style="color:#e3116c">&#x27;view_item&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token punctuation" style="color:#393A34">:</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">sort_values</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;timestamp&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> ascending</span><span class="token operator" style="color:#393A34">=</span><span class="token boolean" style="color:#36acaa">False</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> trending_items</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">itemid</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">value_counts</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">index</span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain">n</span><span class="token punctuation" style="color:#393A34">]</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><div class="codeBlockContainer_I0IT language-python theme-code-block"><div class="codeBlockContent_wNvx python"><pre tabindex="0" class="prism-code language-python codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">user_current_time </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> df</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">timestamp</span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">100</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">top_trending</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">5</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">50</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> user_current_time</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">Int64Index([2241, 972, 393, 1118, 126], dtype=&#x27;int64&#x27;)</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><h3 class="anchor anchorWithStickyNavbar_mojV" id="top-n-least-viewed-items">Top-N Least Viewed Items<a class="hash-link" href="#top-n-least-viewed-items" title="Direct link to heading">​</a></h3><div class="codeBlockContainer_I0IT language-python theme-code-block"><div class="codeBlockContent_wNvx python"><pre tabindex="0" class="prism-code language-python codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">def</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">least_n_items</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">n</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">10</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  temp1 </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> df</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">loc</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">df</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">event</span><span class="token operator" style="color:#393A34">==</span><span class="token string" style="color:#e3116c">&#x27;view_item&#x27;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">groupby</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&#x27;itemid&#x27;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&#x27;event&#x27;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">count</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">sort_values</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">ascending</span><span class="token operator" style="color:#393A34">=</span><span class="token boolean" style="color:#36acaa">True</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">reset_index</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  temp2 </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> df</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">groupby</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;itemid&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">timestamp</span><span class="token punctuation" style="color:#393A34">.</span><span class="token builtin">max</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">reset_index</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  item_ids </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> pd</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">merge</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">temp1</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">temp2</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">on</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&#x27;itemid&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">sort_values</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&#x27;event&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;timestamp&#x27;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> ascending</span><span class="token operator" style="color:#393A34">=</span><span class="token punctuation" style="color:#393A34">[</span><span class="token boolean" style="color:#36acaa">True</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">False</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">reset_index</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">loc</span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain">n</span><span class="token operator" style="color:#393A34">-</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">,</span><span class="token string" style="color:#e3116c">&#x27;itemid&#x27;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> itemid_encoder</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">inverse_transform</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">item_ids</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">values</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><div class="codeBlockContainer_I0IT language-python theme-code-block"><div class="codeBlockContent_wNvx python"><pre tabindex="0" class="prism-code language-python codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">least_n_items</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">10</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">array([&#x27;15742&#x27;, &#x27;16052&#x27;, &#x27;16443&#x27;, &#x27;16074&#x27;, &#x27;16424&#x27;, &#x27;11574&#x27;, &#x27;11465&#x27;, &#x27;16033&#x27;, &#x27;11711&#x27;, &#x27;16013&#x27;], dtype=object)</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><h1>Data Transformation</h1><p>Many times there are no explicit ratings or preferences given by users, that is, the interactions are usually implicit. This
information may reflect users&#x27; preference towards the items in an implicit manner.</p><p>Option 1 - Simple Count: The most simple technique is to count times of interactions between user and item for
producing affinity scores.</p><p>Option 2 - Weighted Count: It is useful to consider the types of different interactions as weights in the count
aggregation. For example, assuming weights of the three differen types, &quot;click&quot;, &quot;add&quot;, and &quot;purchase&quot;, are 1, 2, and 3, respectively.</p><p>Option 3 - Time-dependent Count: In many scenarios, time dependency plays a critical role in preparing dataset for
building a collaborative filtering model that captures user interests drift over time. One of the common techniques for
achieving time dependent count is to add a time decay factor in the counting.</p><h3 class="anchor anchorWithStickyNavbar_mojV" id="a-count">A. Count<a class="hash-link" href="#a-count" title="Direct link to heading">​</a></h3><div class="codeBlockContainer_I0IT language-python theme-code-block"><div class="codeBlockContent_wNvx python"><pre tabindex="0" class="prism-code language-python codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">data_count </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> df</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">groupby</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&#x27;userid&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;itemid&#x27;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">agg</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">{</span><span class="token string" style="color:#e3116c">&#x27;timestamp&#x27;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;count&#x27;</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">reset_index</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">data_count</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">columns </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&#x27;userid&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;itemid&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;affinity&#x27;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">data_count</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">head</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><h3 class="anchor anchorWithStickyNavbar_mojV" id="b-weighted-count">B. Weighted Count<a class="hash-link" href="#b-weighted-count" title="Direct link to heading">​</a></h3><div class="codeBlockContainer_I0IT language-python theme-code-block"><div class="codeBlockContent_wNvx python"><pre tabindex="0" class="prism-code language-python codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">data_w </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> df</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">loc</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">df</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">event</span><span class="token operator" style="color:#393A34">!=</span><span class="token string" style="color:#e3116c">&#x27;remove_from_cart&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token punctuation" style="color:#393A34">:</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">affinity_weights </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token string" style="color:#e3116c">&#x27;view_item&#x27;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token string" style="color:#e3116c">&#x27;add_to_cart&#x27;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">3</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token string" style="color:#e3116c">&#x27;begin_checkout&#x27;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">5</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token string" style="color:#e3116c">&#x27;purchase&#x27;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">6</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token string" style="color:#e3116c">&#x27;remove_from_cart&#x27;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">3</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">data_w</span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&#x27;event&#x27;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">.</span><span class="token builtin">apply</span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">lambda</span><span class="token plain"> x</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> affinity_weights</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">x</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">data_w</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">head</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><div class="codeBlockContainer_I0IT language-python theme-code-block"><div class="codeBlockContent_wNvx python"><pre tabindex="0" class="prism-code language-python codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">data_w</span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&#x27;weight&#x27;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> data_w</span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&#x27;event&#x27;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">.</span><span class="token builtin">apply</span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">lambda</span><span class="token plain"> x</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> affinity_weights</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">x</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">data_wcount </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> data_w</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">groupby</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&#x27;userid&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;itemid&#x27;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&#x27;weight&#x27;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">.</span><span class="token builtin">sum</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">reset_index</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">data_wcount</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">columns </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&#x27;userid&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;itemid&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;affinity&#x27;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">data_wcount</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">head</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><h3 class="anchor anchorWithStickyNavbar_mojV" id="c-time-dependent-count">C. Time dependent Count<a class="hash-link" href="#c-time-dependent-count" title="Direct link to heading">​</a></h3><div class="codeBlockContainer_I0IT language-python theme-code-block"><div class="codeBlockContent_wNvx python"><pre tabindex="0" class="prism-code language-python codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">T </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">30</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">t_ref </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> datetime</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">datetime</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">utcnow</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">data_w</span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&#x27;timedecay&#x27;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> data_w</span><span class="token punctuation" style="color:#393A34">.</span><span class="token builtin">apply</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">lambda</span><span class="token plain"> x</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> x</span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&#x27;weight&#x27;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">*</span><span class="token plain"> math</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">exp</span><span class="token punctuation" style="color:#393A34">(</span><span class="token operator" style="color:#393A34">-</span><span class="token plain">math</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">log2</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">t_ref </span><span class="token operator" style="color:#393A34">-</span><span class="token plain"> pd</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">to_datetime</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">x</span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&#x27;timestamp&#x27;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">tz_convert</span><span class="token punctuation" style="color:#393A34">(</span><span class="token boolean" style="color:#36acaa">None</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">days </span><span class="token operator" style="color:#393A34">/</span><span class="token plain"> T</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    axis</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">1</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">data_w</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">head</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><div class="codeBlockContainer_I0IT language-python theme-code-block"><div class="codeBlockContent_wNvx python"><pre tabindex="0" class="prism-code language-python codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">data_wt </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> data_w</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">groupby</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&#x27;userid&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;itemid&#x27;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&#x27;timedecay&#x27;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">.</span><span class="token builtin">sum</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">reset_index</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">data_wt</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">columns </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&#x27;userid&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;itemid&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;affinity&#x27;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">data_wt</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">head</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><h2 class="anchor anchorWithStickyNavbar_mojV" id="train-test-split">Train Test Split<a class="hash-link" href="#train-test-split" title="Direct link to heading">​</a></h2><p>Option 1 - Random Split: Random split simply takes in a data set and outputs the splits of the data, given the split
ratios</p><p>Option 2 - Chronological split: Chronogically splitting method takes in a dataset and splits it on timestamp</p><div class="codeBlockContainer_I0IT language-python theme-code-block"><div class="codeBlockContent_wNvx python"><pre tabindex="0" class="prism-code language-python codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">data </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> data_w</span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&#x27;userid&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token string" style="color:#e3116c">&#x27;itemid&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token string" style="color:#e3116c">&#x27;timedecay&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token string" style="color:#e3116c">&#x27;timestamp&#x27;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">col </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token string" style="color:#e3116c">&#x27;col_user&#x27;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;userid&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token string" style="color:#e3116c">&#x27;col_item&#x27;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;itemid&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token string" style="color:#e3116c">&#x27;col_rating&#x27;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;timedecay&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token string" style="color:#e3116c">&#x27;col_timestamp&#x27;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;timestamp&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">col3 </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token string" style="color:#e3116c">&#x27;col_user&#x27;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;userid&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token string" style="color:#e3116c">&#x27;col_item&#x27;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;itemid&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token string" style="color:#e3116c">&#x27;col_timestamp&#x27;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;timestamp&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">train</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> test </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> python_chrono_split</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">data</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> ratio</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">0.75</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> min_rating</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">10</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                                  filter_by</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&#x27;user&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">**</span><span class="token plain">col3</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><div class="codeBlockContainer_I0IT language-python theme-code-block"><div class="codeBlockContent_wNvx python"><pre tabindex="0" class="prism-code language-python codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">train</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">loc</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">train</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">userid</span><span class="token operator" style="color:#393A34">==</span><span class="token number" style="color:#36acaa">7</span><span class="token punctuation" style="color:#393A34">,</span><span class="token punctuation" style="color:#393A34">:</span><span class="token punctuation" style="color:#393A34">]</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><h2 class="anchor anchorWithStickyNavbar_mojV" id="experiments">Experiments<a class="hash-link" href="#experiments" title="Direct link to heading">​</a></h2><h3 class="anchor anchorWithStickyNavbar_mojV" id="item-popularity-recomendation-model">Item Popularity Recomendation Model<a class="hash-link" href="#item-popularity-recomendation-model" title="Direct link to heading">​</a></h3><div class="codeBlockContainer_I0IT language-python theme-code-block"><div class="codeBlockContent_wNvx python"><pre tabindex="0" class="prism-code language-python codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># Recommending the most popular items is intuitive and simple approach</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">item_counts </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> train</span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&#x27;itemid&#x27;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">value_counts</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">to_frame</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">reset_index</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">item_counts</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">columns </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&#x27;itemid&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;count&#x27;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">item_counts</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">head</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><div class="codeBlockContainer_I0IT language-python theme-code-block"><div class="codeBlockContent_wNvx python"><pre tabindex="0" class="prism-code language-python codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">user_item_col </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&#x27;userid&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;itemid&#x27;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Cross join users and items</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">test_users </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> test</span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&#x27;userid&#x27;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">unique</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">user_item_list </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token builtin">list</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">itertools</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">product</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">test_users</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> item_counts</span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&#x27;itemid&#x27;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">users_items </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> pd</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">DataFrame</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">user_item_list</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> columns</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">user_item_col</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">print</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;Number of user-item pairs:&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token builtin">len</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">users_items</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Remove seen items (items in the train set) as we will not recommend those again to the users</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> reco_utils</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">dataset</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">pandas_df_utils </span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> filter_by</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">users_items_remove_seen </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> filter_by</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">users_items</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> train</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> user_item_col</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">print</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;After remove seen items:&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token builtin">len</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">users_items_remove_seen</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">Number of user-item pairs: 4124250</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">After remove seen items: 4107466</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><div class="codeBlockContainer_I0IT language-python theme-code-block"><div class="codeBlockContent_wNvx python"><pre tabindex="0" class="prism-code language-python codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># Generate recommendations</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">baseline_recommendations </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> pd</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">merge</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">item_counts</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> users_items_remove_seen</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                                    on</span><span class="token operator" style="color:#393A34">=</span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&#x27;itemid&#x27;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> how</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&#x27;inner&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">baseline_recommendations</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">head</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><div class="codeBlockContainer_I0IT language-python theme-code-block"><div class="codeBlockContent_wNvx python"><pre tabindex="0" class="prism-code language-python codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">k </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">10</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">cols </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token string" style="color:#e3116c">&#x27;col_user&#x27;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;userid&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token string" style="color:#e3116c">&#x27;col_item&#x27;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;itemid&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token string" style="color:#e3116c">&#x27;col_rating&#x27;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;timedecay&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token string" style="color:#e3116c">&#x27;col_prediction&#x27;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;count&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">eval_map </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> map_at_k</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">test</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> baseline_recommendations</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> k</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">k</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">**</span><span class="token plain">cols</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">eval_ndcg </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> ndcg_at_k</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">test</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> baseline_recommendations</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> k</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">k</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">**</span><span class="token plain">cols</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">eval_precision </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> precision_at_k</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">test</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> baseline_recommendations</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> k</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">k</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">**</span><span class="token plain">cols</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">eval_recall </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> recall_at_k</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">test</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> baseline_recommendations</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> k</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">k</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">**</span><span class="token plain">cols</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><div class="codeBlockContainer_I0IT language-python theme-code-block"><div class="codeBlockContent_wNvx python"><pre tabindex="0" class="prism-code language-python codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">print</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;MAP:\t%f&quot;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">%</span><span class="token plain"> eval_map</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token string" style="color:#e3116c">&quot;NDCG@K:\t%f&quot;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">%</span><span class="token plain"> eval_ndcg</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token string" style="color:#e3116c">&quot;Precision@K:\t%f&quot;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">%</span><span class="token plain"> eval_precision</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token string" style="color:#e3116c">&quot;Recall@K:\t%f&quot;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">%</span><span class="token plain"> eval_recall</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> sep</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&#x27;\n&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">MAP:    0.005334</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">NDCG@K: 0.010356</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Precision@K:    0.007092</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Recall@K:   0.011395</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><h3 class="anchor anchorWithStickyNavbar_mojV" id="cornac-bpr-model">Cornac BPR Model<a class="hash-link" href="#cornac-bpr-model" title="Direct link to heading">​</a></h3><div class="codeBlockContainer_I0IT language-python theme-code-block"><div class="codeBlockContent_wNvx python"><pre tabindex="0" class="prism-code language-python codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">TOP_K </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">10</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">NUM_FACTORS </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">200</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">NUM_EPOCHS </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">100</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">SEED </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">40</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">train_set </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> cornac</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">data</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">Dataset</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">from_uir</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">train</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">itertuples</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">index</span><span class="token operator" style="color:#393A34">=</span><span class="token boolean" style="color:#36acaa">False</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> seed</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">SEED</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">bpr </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> cornac</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">models</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">BPR</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    k</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">NUM_FACTORS</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    max_iter</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">NUM_EPOCHS</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    learning_rate</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">0.01</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    lambda_reg</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">0.001</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    verbose</span><span class="token operator" style="color:#393A34">=</span><span class="token boolean" style="color:#36acaa">True</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    seed</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">SEED</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> reco_utils</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">common</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">timer </span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> Timer</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">with</span><span class="token plain"> Timer</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">as</span><span class="token plain"> t</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    bpr</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">fit</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">train_set</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">print</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;Took {} seconds for training.&quot;</span><span class="token punctuation" style="color:#393A34">.</span><span class="token builtin">format</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">t</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">HBox(children=(FloatProgress(value=0.0), HTML(value=&#x27;&#x27;)))</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Optimization finished!</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Took 3.1812 seconds for training.</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><div class="codeBlockContainer_I0IT language-python theme-code-block"><div class="codeBlockContent_wNvx python"><pre tabindex="0" class="prism-code language-python codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">with</span><span class="token plain"> Timer</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">as</span><span class="token plain"> t</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    all_predictions </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> predict_ranking</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">bpr</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> train</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> usercol</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&#x27;userid&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> itemcol</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&#x27;itemid&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> remove_seen</span><span class="token operator" style="color:#393A34">=</span><span class="token boolean" style="color:#36acaa">True</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">print</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;Took {} seconds for prediction.&quot;</span><span class="token punctuation" style="color:#393A34">.</span><span class="token builtin">format</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">t</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">Took 4.7581 seconds for prediction.</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><div class="codeBlockContainer_I0IT language-python theme-code-block"><div class="codeBlockContent_wNvx python"><pre tabindex="0" class="prism-code language-python codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">all_predictions</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">head</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><div class="codeBlockContainer_I0IT language-python theme-code-block"><div class="codeBlockContent_wNvx python"><pre tabindex="0" class="prism-code language-python codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">k </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">10</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">cols </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token string" style="color:#e3116c">&#x27;col_user&#x27;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;userid&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token string" style="color:#e3116c">&#x27;col_item&#x27;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;itemid&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token string" style="color:#e3116c">&#x27;col_rating&#x27;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;timedecay&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token string" style="color:#e3116c">&#x27;col_prediction&#x27;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;prediction&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">eval_map </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> map_at_k</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">test</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> all_predictions</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> k</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">k</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">**</span><span class="token plain">cols</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">eval_ndcg </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> ndcg_at_k</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">test</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> all_predictions</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> k</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">k</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">**</span><span class="token plain">cols</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">eval_precision </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> precision_at_k</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">test</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> all_predictions</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> k</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">k</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">**</span><span class="token plain">cols</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">eval_recall </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> recall_at_k</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">test</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> all_predictions</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> k</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">k</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">**</span><span class="token plain">cols</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><div class="codeBlockContainer_I0IT language-python-input theme-code-block"><div class="codeBlockContent_wNvx python-input"><pre tabindex="0" class="prism-code language-python-input codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">print(&quot;MAP:\t%f&quot; % eval_map,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      &quot;NDCG:\t%f&quot; % eval_ndcg,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      &quot;Precision@K:\t%f&quot; % eval_precision,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      &quot;Recall@K:\t%f&quot; % eval_recall, sep=&#x27;\n&#x27;)</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">MAP:    0.004738</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">NDCG:   0.009597</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Precision@K:    0.006601</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Recall@K:   0.010597</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><h3 class="anchor anchorWithStickyNavbar_mojV" id="sars-model">SARS Model<a class="hash-link" href="#sars-model" title="Direct link to heading">​</a></h3><div class="codeBlockContainer_I0IT language-python theme-code-block"><div class="codeBlockContent_wNvx python"><pre tabindex="0" class="prism-code language-python codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> reco_utils</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">recommender</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">sar</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">sar_singlenode </span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> SARSingleNode</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">TOP_K </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">10</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">header </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token string" style="color:#e3116c">&quot;col_user&quot;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;userid&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token string" style="color:#e3116c">&quot;col_item&quot;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;itemid&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token string" style="color:#e3116c">&quot;col_rating&quot;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;timedecay&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token string" style="color:#e3116c">&quot;col_timestamp&quot;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;timestamp&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token string" style="color:#e3116c">&quot;col_prediction&quot;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;prediction&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">model </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> SARSingleNode</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    similarity_type</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&quot;jaccard&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    time_decay_coefficient</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    time_now</span><span class="token operator" style="color:#393A34">=</span><span class="token boolean" style="color:#36acaa">None</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    timedecay_formula</span><span class="token operator" style="color:#393A34">=</span><span class="token boolean" style="color:#36acaa">False</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token operator" style="color:#393A34">**</span><span class="token plain">header</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">model</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">fit</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">train</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><div class="codeBlockContainer_I0IT language-python theme-code-block"><div class="codeBlockContent_wNvx python"><pre tabindex="0" class="prism-code language-python codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">top_k </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> model</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">recommend_k_items</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">test</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> remove_seen</span><span class="token operator" style="color:#393A34">=</span><span class="token boolean" style="color:#36acaa">True</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># all ranking metrics have the same arguments</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">args </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">test</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> top_k</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">kwargs </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token builtin">dict</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">col_user</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&#x27;userid&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">              col_item</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&#x27;itemid&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">              col_rating</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&#x27;timedecay&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">              col_prediction</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&#x27;prediction&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">              relevancy_method</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&#x27;top_k&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">              k</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">TOP_K</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">eval_map </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> map_at_k</span><span class="token punctuation" style="color:#393A34">(</span><span class="token operator" style="color:#393A34">*</span><span class="token plain">args</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">**</span><span class="token plain">kwargs</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">eval_ndcg </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> ndcg_at_k</span><span class="token punctuation" style="color:#393A34">(</span><span class="token operator" style="color:#393A34">*</span><span class="token plain">args</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">**</span><span class="token plain">kwargs</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">eval_precision </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> precision_at_k</span><span class="token punctuation" style="color:#393A34">(</span><span class="token operator" style="color:#393A34">*</span><span class="token plain">args</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">**</span><span class="token plain">kwargs</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">eval_recall </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> recall_at_k</span><span class="token punctuation" style="color:#393A34">(</span><span class="token operator" style="color:#393A34">*</span><span class="token plain">args</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">**</span><span class="token plain">kwargs</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><div class="codeBlockContainer_I0IT language-python theme-code-block"><div class="codeBlockContent_wNvx python"><pre tabindex="0" class="prism-code language-python codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">print</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string-interpolation string" style="color:#e3116c">f&quot;Model:&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token string-interpolation string" style="color:#e3116c">f&quot;Top K:\t\t </span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">{</span><span class="token string-interpolation interpolation">TOP_K</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">}</span><span class="token string-interpolation string" style="color:#e3116c">&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token string-interpolation string" style="color:#e3116c">f&quot;MAP:\t\t </span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">{</span><span class="token string-interpolation interpolation">eval_map</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">:</span><span class="token string-interpolation interpolation format-spec">f</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">}</span><span class="token string-interpolation string" style="color:#e3116c">&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token string-interpolation string" style="color:#e3116c">f&quot;NDCG:\t\t </span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">{</span><span class="token string-interpolation interpolation">eval_ndcg</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">:</span><span class="token string-interpolation interpolation format-spec">f</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">}</span><span class="token string-interpolation string" style="color:#e3116c">&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token string-interpolation string" style="color:#e3116c">f&quot;Precision@K:\t </span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">{</span><span class="token string-interpolation interpolation">eval_precision</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">:</span><span class="token string-interpolation interpolation format-spec">f</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">}</span><span class="token string-interpolation string" style="color:#e3116c">&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token string-interpolation string" style="color:#e3116c">f&quot;Recall@K:\t </span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">{</span><span class="token string-interpolation interpolation">eval_recall</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">:</span><span class="token string-interpolation interpolation format-spec">f</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">}</span><span class="token string-interpolation string" style="color:#e3116c">&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> sep</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&#x27;\n&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">Model:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Top K:       10</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">MAP:         0.024426</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">NDCG:        0.032738</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Precision@K:     0.019258</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Recall@K:    0.036009</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><h3 class="anchor anchorWithStickyNavbar_mojV" id="spotlight">Spotlight<a class="hash-link" href="#spotlight" title="Direct link to heading">​</a></h3><h4 class="anchor anchorWithStickyNavbar_mojV" id="implicit-factorization-model">Implicit Factorization Model<a class="hash-link" href="#implicit-factorization-model" title="Direct link to heading">​</a></h4><div class="codeBlockContainer_I0IT language-python theme-code-block"><div class="codeBlockContent_wNvx python"><pre tabindex="0" class="prism-code language-python codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">interactions </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> Interactions</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">user_ids </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> df</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">userid</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">astype</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;int32&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">values</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                            item_ids </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> df</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">itemid</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">astype</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;int32&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">values</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                            timestamps </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> df</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">timestamp</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">astype</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;int32&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                            num_users </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> df</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">userid</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">nunique</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                            num_items </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> df</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">itemid</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">nunique</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">train_user</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> test_user </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> random_train_test_split</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">interactions</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> test_percentage</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">0.2</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">model </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> ImplicitFactorizationModel</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">loss</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&#x27;bpr&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> embedding_dim</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">64</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> n_iter</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">10</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                                   batch_size</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">256</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> l2</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">0.0</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> learning_rate</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">0.01</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                                   optimizer_func</span><span class="token operator" style="color:#393A34">=</span><span class="token boolean" style="color:#36acaa">None</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> use_cuda</span><span class="token operator" style="color:#393A34">=</span><span class="token boolean" style="color:#36acaa">False</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                                   representation</span><span class="token operator" style="color:#393A34">=</span><span class="token boolean" style="color:#36acaa">None</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> sparse</span><span class="token operator" style="color:#393A34">=</span><span class="token boolean" style="color:#36acaa">False</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                                   num_negative_samples</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">10</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">model</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">fit</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">train_user</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> verbose</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">pr </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> precision_recall_score</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">model</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> test</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">test_user</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> train</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">train_user</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> k</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">10</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">print</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;Pricison@10 is {:.3f} and Recall@10 is {:.3f}&#x27;</span><span class="token punctuation" style="color:#393A34">.</span><span class="token builtin">format</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">pr</span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">mean</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> pr</span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">mean</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">Epoch 0: loss 0.26659833122392174</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Epoch 1: loss 0.06129162273462562</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Epoch 2: loss 0.022607273167640066</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Epoch 3: loss 0.013953083943443858</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Epoch 4: loss 0.01050195922488137</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Epoch 5: loss 0.009170394043447121</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Epoch 6: loss 0.008144461540834697</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Epoch 7: loss 0.007209992620171649</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Epoch 8: loss 0.00663076309035038</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Epoch 9: loss 0.006706491189820159</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Pricison@10 is 0.007 and Recall@10 is 0.050</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><p>Implicit Factorization Model with Grid Search</p><div class="codeBlockContainer_I0IT language-python theme-code-block"><div class="codeBlockContent_wNvx python"><pre tabindex="0" class="prism-code language-python codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">interactions </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> Interactions</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">user_ids </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> df</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">userid</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">astype</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;int32&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">values</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                            item_ids </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> df</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">itemid</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">astype</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;int32&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">values</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                            timestamps </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> df</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">timestamp</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">astype</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;int32&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                            num_users </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> df</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">userid</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">nunique</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                            num_items </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> df</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">itemid</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">nunique</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">train_user</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> test_user </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> random_train_test_split</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">interactions</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> test_percentage</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">0.2</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">params_grid </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token string" style="color:#e3116c">&#x27;loss&#x27;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&#x27;bpr&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;hinge&#x27;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">               </span><span class="token string" style="color:#e3116c">&#x27;embedding_dim&#x27;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">32</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">64</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">               </span><span class="token string" style="color:#e3116c">&#x27;learning_rate&#x27;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">0.01</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0.05</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0.1</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">               </span><span class="token string" style="color:#e3116c">&#x27;num_negative_samples&#x27;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">5</span><span class="token punctuation" style="color:#393A34">,</span><span class="token number" style="color:#36acaa">10</span><span class="token punctuation" style="color:#393A34">,</span><span class="token number" style="color:#36acaa">50</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">               </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">grid </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> ParameterGrid</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">params_grid</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">for</span><span class="token plain"> p </span><span class="token keyword" style="color:#00009f">in</span><span class="token plain"> grid</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  model </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> ImplicitFactorizationModel</span><span class="token punctuation" style="color:#393A34">(</span><span class="token operator" style="color:#393A34">**</span><span class="token plain">p</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> n_iter</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">10</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> batch_size</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">256</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> l2</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">0.0</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                                    optimizer_func</span><span class="token operator" style="color:#393A34">=</span><span class="token boolean" style="color:#36acaa">None</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> use_cuda</span><span class="token operator" style="color:#393A34">=</span><span class="token boolean" style="color:#36acaa">False</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                                    representation</span><span class="token operator" style="color:#393A34">=</span><span class="token boolean" style="color:#36acaa">None</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> sparse</span><span class="token operator" style="color:#393A34">=</span><span class="token boolean" style="color:#36acaa">False</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  model</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">fit</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">train_user</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> verbose</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  pr </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> precision_recall_score</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">model</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> test</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">test_user</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> train</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">train_user</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> k</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">10</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">print</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;Pricison@10 is {:.3f} and Recall@10 is {:.3f}&#x27;</span><span class="token punctuation" style="color:#393A34">.</span><span class="token builtin">format</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">pr</span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">mean</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> pr</span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">mean</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">/usr/local/lib/python3.7/dist-packages/pandas/core/series.py:1139: FutureWarning: </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Passing list-likes to .loc or [] with any missing label will raise</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">KeyError in the future, you can use .reindex() as an alternative.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">See the documentation here:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#deprecate-loc-reindex-listlike</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  return self.loc[key]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Epoch 0: loss 0.23323329780071111</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Epoch 1: loss 0.13417892158031464</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Epoch 2: loss 0.11723061798326072</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Epoch 3: loss 0.10971038677157696</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Epoch 4: loss 0.1073669156125504</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Epoch 5: loss 0.10198603978925579</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Epoch 6: loss 0.10140255498445302</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Epoch 7: loss 0.09986353406856298</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Epoch 8: loss 0.09296791315366218</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Epoch 9: loss 0.09289196610354918</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Pricison@10 is 0.004 and Recall@10 is 0.026</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Epoch 0: loss 1.8212750715074815</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Epoch 1: loss 2.368166323068441</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Epoch 2: loss 2.2547610501767736</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Epoch 3: loss 2.0896969359978987</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Epoch 4: loss 2.074246685221264</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Epoch 5: loss 2.107905259206172</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Epoch 6: loss 2.1261368730252195</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Epoch 7: loss 2.0352458648168006</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Epoch 8: loss 2.1936914333384903</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Epoch 9: loss 2.0269214924412906</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Pricison@10 is 0.004 and Recall@10 is 0.031</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Epoch 0: loss 1.8324132722673692</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Epoch 1: loss 2.4329963008307183</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Epoch 2: loss 2.2162452385164917</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Epoch 3: loss 2.092274981104676</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Epoch 4: loss 2.1043862517432</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Epoch 5: loss 2.0506169550671838</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Epoch 6: loss 2.1609063529412462</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Epoch 7: loss 2.1431561312683143</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Epoch 8: loss 2.0215363380322504</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Epoch 9: loss 1.9930379555180333</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Pricison@10 is 0.004 and Recall@10 is 0.028</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Epoch 0: loss 1.8448880979869144</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Epoch 1: loss 2.378598579448136</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Epoch 2: loss 2.296310121415129</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Epoch 3: loss 2.131826051657606</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Epoch 4: loss 2.101037339573888</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Epoch 5: loss 2.0981224655530077</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Epoch 6: loss 2.1441538588793714</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Epoch 7: loss 2.014261698416192</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Epoch 8: loss 1.9355182779228188</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Epoch 9: loss 2.084795298492027</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Pricison@10 is 0.004 and Recall@10 is 0.030</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><h4 class="anchor anchorWithStickyNavbar_mojV" id="cnn-pooling-sequence-model">CNN Pooling Sequence Model<a class="hash-link" href="#cnn-pooling-sequence-model" title="Direct link to heading">​</a></h4><div class="codeBlockContainer_I0IT language-python theme-code-block"><div class="codeBlockContent_wNvx python"><pre tabindex="0" class="prism-code language-python codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">interactions </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> Interactions</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">user_ids </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> df</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">userid</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">astype</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;int32&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">values</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                            item_ids </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> df</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">itemid</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">astype</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;int32&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">values</span><span class="token operator" style="color:#393A34">+</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                            timestamps </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> df</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">timestamp</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">astype</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;int32&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">train</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> test </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> random_train_test_split</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">interactions</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> test_percentage</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">0.2</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">train_seq </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> train</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">to_sequence</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">max_sequence_length</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">10</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">test_seq </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> test</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">to_sequence</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">max_sequence_length</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">10</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">model </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> ImplicitSequenceModel</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">loss</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&#x27;bpr&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> representation</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&#x27;pooling&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                              embedding_dim</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">32</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> n_iter</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">10</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> batch_size</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">256</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                              l2</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">0.0</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> learning_rate</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">0.01</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> optimizer_func</span><span class="token operator" style="color:#393A34">=</span><span class="token boolean" style="color:#36acaa">None</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                              use_cuda</span><span class="token operator" style="color:#393A34">=</span><span class="token boolean" style="color:#36acaa">False</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> sparse</span><span class="token operator" style="color:#393A34">=</span><span class="token boolean" style="color:#36acaa">False</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> num_negative_samples</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">5</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">model</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">fit</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">train_seq</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> verbose</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">mrr_seq </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> sequence_mrr_score</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">model</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> test_seq</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">mrr_seq</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">mean</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">Epoch 0: loss 0.4226887328702895</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Epoch 1: loss 0.23515070266410953</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Epoch 2: loss 0.16919970976524665</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Epoch 3: loss 0.1425025990751923</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Epoch 4: loss 0.12612225017586692</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Epoch 5: loss 0.11565039795441706</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Epoch 6: loss 0.10787886735357222</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Epoch 7: loss 0.10086931410383006</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Epoch 8: loss 0.09461003749585542</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Epoch 9: loss 0.09128284808553633</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">0.10435609591957387</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><h2 class="anchor anchorWithStickyNavbar_mojV" id="fastai-collablearner">FastAI CollabLearner<a class="hash-link" href="#fastai-collablearner" title="Direct link to heading">​</a></h2><div class="codeBlockContainer_I0IT language-python theme-code-block"><div class="codeBlockContent_wNvx python"><pre tabindex="0" class="prism-code language-python codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">df</span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&#x27;rating&#x27;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> df</span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&#x27;event&#x27;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">.</span><span class="token builtin">map</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">{</span><span class="token string" style="color:#e3116c">&#x27;view_item&#x27;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                                </span><span class="token string" style="color:#e3116c">&#x27;add_to_cart&#x27;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">2</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                                </span><span class="token string" style="color:#e3116c">&#x27;begin_checkout&#x27;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">3</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                                </span><span class="token string" style="color:#e3116c">&#x27;purchase&#x27;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">5</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                               </span><span class="token string" style="color:#e3116c">&#x27;remove_from_cart&#x27;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                                </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ratings </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> df</span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&quot;userid&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;itemid&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;rating&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;timestamp&#x27;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">copy</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">data </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> CollabDataBunch</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">from_df</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">ratings</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> seed</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">42</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">data</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">TabularDataBunch;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Train: LabelList (79546 items)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">x: CollabList</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">userid 3141; itemid 236; ,userid 3421; itemid 1001; ,userid 550; itemid 972; ,userid 550; itemid 972; ,userid 550; itemid 972; </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">y: FloatList</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">1.0,2.0,1.0,1.0,2.0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Path: .;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Valid: LabelList (19886 items)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">x: CollabList</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">userid 6785; itemid 183; ,userid 1458; itemid 1356; ,userid 3817; itemid 2368; ,userid 9777; itemid 2466; ,userid 11077; itemid 1359; </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">y: FloatList</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">1.0,3.0,3.0,1.0,2.0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Path: .;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Test: None</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><div class="codeBlockContainer_I0IT language-python theme-code-block"><div class="codeBlockContent_wNvx python"><pre tabindex="0" class="prism-code language-python codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">learn </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> collab_learner</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">data</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> n_factors</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">50</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> y_range</span><span class="token operator" style="color:#393A34">=</span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">,</span><span class="token number" style="color:#36acaa">5.5</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">learn</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">lr_find</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">learn</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">recorder</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">plot</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">skip_end</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">15</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><p><img loading="lazy" src="/ai-kb/assets/images/260222_neg_implicit_7-faea52d5ab96e925f6665b8d3814e6f8.png" width="909" height="208"></p><div class="codeBlockContainer_I0IT language-python theme-code-block"><div class="codeBlockContent_wNvx python"><pre tabindex="0" class="prism-code language-python codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">learn</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">fit_one_cycle</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">5e-6</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><div class="codeBlockContainer_I0IT language-python theme-code-block"><div class="codeBlockContent_wNvx python"><pre tabindex="0" class="prism-code language-python codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">learn</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">summary</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">EmbeddingDotBias</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">======================================================================</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Layer (type)         Output Shape         Param #    Trainable </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">======================================================================</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Embedding            [50]                 534,000    True      </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">______________________________________________________________________</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Embedding            [50]                 129,150    True      </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">______________________________________________________________________</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Embedding            [1]                  10,680     True      </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">______________________________________________________________________</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Embedding            [1]                  2,583      True      </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">______________________________________________________________________</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Total params: 676,413</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Total trainable params: 676,413</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Total non-trainable params: 0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Optimized with &#x27;torch.optim.adam.Adam&#x27;, betas=(0.9, 0.99)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Using true weight decay as discussed in https://www.fast.ai/2018/07/02/adam-weight-decay/ </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Loss function : FlattenedLoss</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">======================================================================</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Callbacks functions applied </span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><div class="codeBlockContainer_I0IT language-python theme-code-block"><div class="codeBlockContent_wNvx python"><pre tabindex="0" class="prism-code language-python codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">learn</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">fit</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">10</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1e-3</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/sparsh-ai/ai-kb/docs/04-tutorials/negative-implicit-feedback-rec.mdx" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_dcUD" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_foO9"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/ai-kb/docs/tutorials/name-address-parsing"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Name and Address Parsing</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/ai-kb/docs/tutorials/outliers-handling"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Outliers Handling</div></a></div></nav></div></div><div class="col col--3"><div class="tableOfContents_cNA8 thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#data-loading" class="table-of-contents__link toc-highlight">Data Loading</a></li><li><a href="#wrangling" class="table-of-contents__link toc-highlight">Wrangling</a><ul><li><a href="#removing-duplicates" class="table-of-contents__link toc-highlight">Removing Duplicates</a></li><li><a href="#label-encoding" class="table-of-contents__link toc-highlight">Label Encoding</a></li></ul></li><li><a href="#exploration" class="table-of-contents__link toc-highlight">Exploration</a><ul><li><a href="#user-interactions" class="table-of-contents__link toc-highlight">User Interactions</a></li><li><a href="#add-to-cart-event-counts" class="table-of-contents__link toc-highlight">Add-to-cart Event Counts</a></li><li><a href="#purchase-event-counts" class="table-of-contents__link toc-highlight">Purchase Event Counts</a></li><li><a href="#item-interactions" class="table-of-contents__link toc-highlight">Item Interactions</a></li></ul></li><li><a href="#rule-based-approaches" class="table-of-contents__link toc-highlight">Rule-based Approaches</a><ul><li><a href="#top-n-trending-products" class="table-of-contents__link toc-highlight">Top-N Trending Products</a></li><li><a href="#top-n-least-viewed-items" class="table-of-contents__link toc-highlight">Top-N Least Viewed Items</a></li><li><a href="#a-count" class="table-of-contents__link toc-highlight">A. Count</a></li><li><a href="#b-weighted-count" class="table-of-contents__link toc-highlight">B. Weighted Count</a></li><li><a href="#c-time-dependent-count" class="table-of-contents__link toc-highlight">C. Time dependent Count</a></li></ul></li><li><a href="#train-test-split" class="table-of-contents__link toc-highlight">Train Test Split</a></li><li><a href="#experiments" class="table-of-contents__link toc-highlight">Experiments</a><ul><li><a href="#item-popularity-recomendation-model" class="table-of-contents__link toc-highlight">Item Popularity Recomendation Model</a></li><li><a href="#cornac-bpr-model" class="table-of-contents__link toc-highlight">Cornac BPR Model</a></li><li><a href="#sars-model" class="table-of-contents__link toc-highlight">SARS Model</a></li><li><a href="#spotlight" class="table-of-contents__link toc-highlight">Spotlight</a></li></ul></li><li><a href="#fastai-collablearner" class="table-of-contents__link toc-highlight">FastAI CollabLearner</a></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2022 AIKB Docs, Inc. Built with Docusaurus.</div></div></div></footer></div>
<script src="/ai-kb/assets/js/runtime~main.6de31ed9.js"></script>
<script src="/ai-kb/assets/js/main.cf94d7b4.js"></script>
</body>
</html>