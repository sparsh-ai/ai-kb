<!doctype html>
<html class="docs-version-current" lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.17">
<link rel="alternate" type="application/rss+xml" href="/ai-kb/blog/rss.xml" title="AIKB RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/ai-kb/blog/atom.xml" title="AIKB Atom Feed">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.13.24/dist/katex.min.css" integrity="sha384-odtC+0UGzzFL/6PNoE8rX/SPcQDXBJ+uRepguP4QkPCm2LBxH3FA3y+fKSiJ+AmM" crossorigin="anonymous"><title data-rh="true">Name and Address Parsing | AIKB</title><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://kb.recohut.com/ai-kb/docs/tutorials/name-address-parsing"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Name and Address Parsing | AIKB"><meta data-rh="true" name="description" content="Recognising Person names and Addresses in a text using NER and NLP modeling techniques"><meta data-rh="true" property="og:description" content="Recognising Person names and Addresses in a text using NER and NLP modeling techniques"><link data-rh="true" rel="icon" href="/ai-kb/img/logo.svg"><link data-rh="true" rel="canonical" href="https://kb.recohut.com/ai-kb/docs/tutorials/name-address-parsing"><link data-rh="true" rel="alternate" href="https://kb.recohut.com/ai-kb/docs/tutorials/name-address-parsing" hreflang="en"><link data-rh="true" rel="alternate" href="https://kb.recohut.com/ai-kb/docs/tutorials/name-address-parsing" hreflang="x-default"><link rel="stylesheet" href="/ai-kb/assets/css/styles.af9e0313.css">
<link rel="preload" href="/ai-kb/assets/js/runtime~main.4448d8b2.js" as="script">
<link rel="preload" href="/ai-kb/assets/js/main.b26486b4.js" as="script">
</head>
<body class="navigation-with-keyboard" data-theme="light">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div role="region"><a href="#" class="skipToContent_ZgBM">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/ai-kb/"><div class="navbar__logo"><img src="/ai-kb/img/logo.svg" alt="aikb Logo" class="themedImage_W2Cr themedImage--light_TfLj"><img src="/ai-kb/img/logo.svg" alt="aikb Logo" class="themedImage_W2Cr themedImage--dark_oUvU"></div><b class="navbar__title">AIKB</b></a><a class="navbar__item navbar__link navbar__link--active" href="/ai-kb/docs/intro">Docs</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/sparsh-ai/ai-kb" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link"><span>GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_I5OW"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a><div class="toggle_S7eR toggle_TdHA toggleDisabled_f9M3"><div class="toggleButton_rCf9" role="button" tabindex="-1"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_v35p"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_nQuB"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></div><input type="checkbox" class="toggleScreenReader_g2nN" aria-label="Switch between dark and light mode (currently light mode)"></div><div class="dsla-search-wrapper"><div class="dsla-search-field" data-tags="default,docs-default-current"></div></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper docs-wrapper docs-doc-page"><div class="docPage_P2Lg"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_RiI4" type="button"></button><aside class="theme-doc-sidebar-container docSidebarContainer_rKC_"><div class="sidebar_CW9Y"><nav class="menu thin-scrollbar menu_SkdO"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/ai-kb/docs/intro">Introduction</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/ai-kb/docs/projects/">Projects</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link" href="/ai-kb/docs/concepts/">Concepts</a><button aria-label="Toggle the collapsible sidebar category &#x27;Concepts&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--active" href="/ai-kb/docs/tutorials/">Tutorials</a><button aria-label="Toggle the collapsible sidebar category &#x27;Tutorials&#x27;" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/ai-kb/docs/tutorials/amazon-personalize">Amazon Personalize</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/ai-kb/docs/tutorials/data-loading">Data Loading</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/ai-kb/docs/tutorials/database-conn">Database Connections</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/ai-kb/docs/tutorials/email-classification">Email Classification</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/ai-kb/docs/tutorials/graph">Graph-based Modeling</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/ai-kb/docs/tutorials/mathematics">Mathematics</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/ai-kb/docs/tutorials/matrix-factorizations">Matrix Factorizations</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/ai-kb/docs/tutorials/mlops">MLOps</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/ai-kb/docs/tutorials/model-optimization">Model Optimization</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/ai-kb/docs/tutorials/multi-touch-attribution">Multi-Touch Attribution</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/ai-kb/docs/tutorials/name-address-parsing">Name and Address Parsing</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/ai-kb/docs/tutorials/negative-implicit-feedback-rec">Negative Implicit Feedback in Recommendations</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/ai-kb/docs/tutorials/pdf-to-wordcloud-mail">PDF to WordCloud via Email</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/ai-kb/docs/tutorials/python-snippets">Python code</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/ai-kb/docs/tutorials/recsys-evaluation">Recommender System Evaluation</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/ai-kb/docs/tutorials/regression">Regression</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/ai-kb/docs/tutorials/resale-price-prediction">Resale Price Prediction</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/ai-kb/docs/tutorials/text-cleaning">Text Cleaning</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/ai-kb/docs/tutorials/text-embeddings">Text Embeddings</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/ai-kb/docs/tutorials/text-processing">Text Processing</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/ai-kb/docs/tutorials/unix-shell-snippets">Unix shell</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/ai-kb/docs/tutorials/vector-search">Vector Search</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/ai-kb/docs/tutorials/word2vec">Word2vec</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link" href="/ai-kb/docs/tools/">Tools</a><button aria-label="Toggle the collapsible sidebar category &#x27;Tools&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/ai-kb/docs/notebooks/">Notebooks</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link" href="/ai-kb/docs/best-practices/">Best Practices</a><button aria-label="Toggle the collapsible sidebar category &#x27;Best Practices&#x27;" type="button" class="clean-btn menu__caret"></button></div></li></ul></nav></div></aside><main class="docMainContainer_TCnq"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_DM6M"><div class="docItemContainer_vinB"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Xlws" aria-label="breadcrumbs"><ul class="breadcrumbs"><li class="breadcrumbs__item"><a class="breadcrumbs__link breadcrumbsItemLink_e5ie" href="/ai-kb/">🏠</a></li><li class="breadcrumbs__item"><a class="breadcrumbs__link breadcrumbsItemLink_e5ie" href="/ai-kb/docs/tutorials/">Tutorials</a></li><li class="breadcrumbs__item breadcrumbs__item--active"><a class="breadcrumbs__link breadcrumbsItemLink_e5ie" href="/ai-kb/docs/tutorials/name-address-parsing">Name and Address Parsing</a></li></ul></nav><div class="tocCollapsible_jdIR theme-doc-toc-mobile tocMobile_TmEX"><button type="button" class="clean-btn tocCollapsibleButton_Fzxq">On this page</button></div><div class="theme-doc-markdown markdown"><h1>Name and Address Parsing</h1><blockquote><p>Recognising Person names and Addresses in a text using NER and NLP modeling techniques</p></blockquote><a href="https://nbviewer.org/github/recohut/nbs/blob/main/2022-01-01-name-address-parsing.ipynb" target="_blank" rel="noopener noreferrer" alt=""> <img src="https://colab.research.google.com/assets/colab-badge.svg"></a><h2 class="anchor anchorWithStickyNavbar_mojV" id="get-data-from-mongodb">Get data from MongoDB<a class="hash-link" href="#get-data-from-mongodb" title="Direct link to heading">​</a></h2><div class="codeBlockContainer_I0IT language-python theme-code-block"><div class="codeBlockContent_wNvx python"><pre tabindex="0" class="prism-code language-python codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">!pip install pymongo</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">tls</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">srv</span><span class="token punctuation" style="color:#393A34">]</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><div class="codeBlockContainer_I0IT language-python theme-code-block"><div class="codeBlockContent_wNvx python"><pre tabindex="0" class="prism-code language-python codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> pandas </span><span class="token keyword" style="color:#00009f">as</span><span class="token plain"> pd</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> tqdm </span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> tqdm</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">tqdm</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">pandas</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token operator" style="color:#393A34">%</span><span class="token plain">reload_ext google</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">colab</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">data_table</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><div class="codeBlockContainer_I0IT language-python theme-code-block"><div class="codeBlockContent_wNvx python"><pre tabindex="0" class="prism-code language-python codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> pymongo </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> pprint</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">mongo_uri </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;mongodb+srv://&lt;userid&gt;:&lt;pass&gt;@&lt;server&gt;.azure.mongodb.net/&lt;db&gt;?retryWrites=true&amp;w=majority&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">client </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> pymongo</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">MongoClient</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">mongo_uri</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><div class="codeBlockContainer_I0IT language-python theme-code-block"><div class="codeBlockContent_wNvx python"><pre tabindex="0" class="prism-code language-python codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">listdb </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> client</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">list_database_names</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> listdb</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">[&#x27;testdb&#x27;]</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><div class="codeBlockContainer_I0IT language-python theme-code-block"><div class="codeBlockContent_wNvx python"><pre tabindex="0" class="prism-code language-python codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">db </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> client</span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&#x27;testdb&#x27;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">db</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">list_collection_names</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">[&#x27;entities&#x27;, &#x27;parcels&#x27;, &#x27;taxes&#x27;]</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><div class="codeBlockContainer_I0IT language-python theme-code-block"><div class="codeBlockContent_wNvx python"><pre tabindex="0" class="prism-code language-python codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># print(db.command(&quot;collstats&quot;, &quot;events&quot;))</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">db</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">command</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;dbstats&quot;</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">{&#x27;$clusterTime&#x27;: {&#x27;clusterTime&#x27;: Timestamp(1598254711, 1),</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &#x27;signature&#x27;: {&#x27;hash&#x27;: b&#x27;\x19\x92\xd6\x94\x06\xed\xa9\xb5s+\x8e\xcaqn\xb3J\x13_\x1e\xab&#x27;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   &#x27;keyId&#x27;: 6839689286636273667}},</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> &#x27;avgObjSize&#x27;: 597.6787450874097,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> &#x27;collections&#x27;: 3,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> &#x27;dataSize&#x27;: 5494893423.0,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> &#x27;db&#x27;: &#x27;testdb&#x27;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> &#x27;fsTotalSize&#x27;: 34342961152.0,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> &#x27;fsUsedSize&#x27;: 11420770304.0,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> &#x27;indexSize&#x27;: 378994688.0,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> &#x27;indexes&#x27;: 9,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> &#x27;numExtents&#x27;: 0,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> &#x27;objects&#x27;: 9193724,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> &#x27;ok&#x27;: 1.0,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> &#x27;operationTime&#x27;: Timestamp(1598254711, 1),</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> &#x27;scaleFactor&#x27;: 1.0,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> &#x27;storageSize&#x27;: 2160832512.0,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> &#x27;views&#x27;: 0}</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><div class="codeBlockContainer_I0IT language-python theme-code-block"><div class="codeBlockContent_wNvx python"><pre tabindex="0" class="prism-code language-python codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># collection1 = db[&#x27;entities&#x27;]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># df1 = pd.DataFrame(list(collection1.find()))</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># print(df1.info())</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># # print(df1.describe())</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># df1.sample(5)</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><div class="codeBlockContainer_I0IT language-python theme-code-block"><div class="codeBlockContent_wNvx python"><pre tabindex="0" class="prism-code language-python codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># df1.to_pickle(&#x27;/content/drive/My Drive/df_entities.p&#x27;)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># del df1</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># import gc</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># gc.collect()</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">258</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><div class="codeBlockContainer_I0IT language-python theme-code-block"><div class="codeBlockContent_wNvx python"><pre tabindex="0" class="prism-code language-python codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">collection2 </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> db</span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&#x27;parcels&#x27;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">cursor </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> collection2</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">find</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token builtin">max</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">maxL </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">for</span><span class="token plain"> i </span><span class="token keyword" style="color:#00009f">in</span><span class="token plain"> </span><span class="token builtin">range</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">cnt</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  xx </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token builtin">next</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">cursor</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> </span><span class="token builtin">len</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">xx</span><span class="token punctuation" style="color:#393A34">)</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token builtin">max</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token builtin">max</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token builtin">len</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">xx</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    maxL </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> xx</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token builtin">max</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">46</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><div class="codeBlockContainer_I0IT language-python theme-code-block"><div class="codeBlockContent_wNvx python"><pre tabindex="0" class="prism-code language-python codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">cnt </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> collection2</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">count</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><div class="codeBlockContainer_I0IT language-python theme-code-block"><div class="codeBlockContent_wNvx python"><pre tabindex="0" class="prism-code language-python codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token builtin">list</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">maxL</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">4597</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><div class="codeBlockContainer_I0IT language-python theme-code-block"><div class="codeBlockContent_wNvx python"><pre tabindex="0" class="prism-code language-python codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">collection2 </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> db</span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&#x27;parcels&#x27;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">cursor </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> collection2</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">find</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">XX </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> pd</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">DataFrame</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">columns</span><span class="token operator" style="color:#393A34">=</span><span class="token builtin">list</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">maxL</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">XX</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">to_csv</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;df_parcels.csv&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> index</span><span class="token operator" style="color:#393A34">=</span><span class="token boolean" style="color:#36acaa">False</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">for</span><span class="token plain"> i </span><span class="token keyword" style="color:#00009f">in</span><span class="token plain"> tqdm</span><span class="token punctuation" style="color:#393A34">(</span><span class="token builtin">range</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">cnt</span><span class="token operator" style="color:#393A34">//</span><span class="token number" style="color:#36acaa">10000</span><span class="token punctuation" style="color:#393A34">)</span><span class="token operator" style="color:#393A34">+</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  YY </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">for</span><span class="token plain"> j </span><span class="token keyword" style="color:#00009f">in</span><span class="token plain"> </span><span class="token builtin">range</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">10000</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    YY</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">j</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token builtin">next</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">cursor</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  pd</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">DataFrame</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">YY</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">T</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">to_csv</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;df_parcels.csv&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> mode</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&#x27;a&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> index</span><span class="token operator" style="color:#393A34">=</span><span class="token boolean" style="color:#36acaa">False</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> header</span><span class="token operator" style="color:#393A34">=</span><span class="token boolean" style="color:#36acaa">False</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># pd.DataFrame(next(cursor), index=[j]).to_csv(&#x27;df_parcels.csv&#x27;, mode=&#x27;a&#x27;, index=False, header=False)</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain"> 33%|███▎      | 150/460 [04:52&lt;10:09,  1.97s/it]</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><div class="codeBlockContainer_I0IT language-python theme-code-block"><div class="codeBlockContent_wNvx python"><pre tabindex="0" class="prism-code language-python codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">pd</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">read_csv</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;df_parcels.csv&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><div class="codeBlockContainer_I0IT language-python theme-code-block"><div class="codeBlockContent_wNvx python"><pre tabindex="0" class="prism-code language-python codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">collection2 </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> db</span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&#x27;parcels&#x27;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">df2 </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> pd</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">DataFrame</span><span class="token punctuation" style="color:#393A34">(</span><span class="token builtin">list</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">collection2</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">find</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">print</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">df2</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">info</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># print(df2.describe())</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># df2.sample(5)</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><h2 class="anchor anchorWithStickyNavbar_mojV" id="data-wrangling">Data wrangling<a class="hash-link" href="#data-wrangling" title="Direct link to heading">​</a></h2><div class="codeBlockContainer_I0IT language-python theme-code-block"><div class="codeBlockContent_wNvx python"><pre tabindex="0" class="prism-code language-python codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">!pip install </span><span class="token operator" style="color:#393A34">-</span><span class="token plain">q probablepeople</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">!pip install </span><span class="token operator" style="color:#393A34">-</span><span class="token plain">q usaddress</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><div class="codeBlockContainer_I0IT language-python theme-code-block"><div class="codeBlockContent_wNvx python"><pre tabindex="0" class="prism-code language-python codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> os</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> re</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> numpy </span><span class="token keyword" style="color:#00009f">as</span><span class="token plain"> np</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> pandas </span><span class="token keyword" style="color:#00009f">as</span><span class="token plain"> pd</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> tqdm </span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> tqdm</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> seaborn </span><span class="token keyword" style="color:#00009f">as</span><span class="token plain"> sns</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> matplotlib</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">pyplot </span><span class="token keyword" style="color:#00009f">as</span><span class="token plain"> plt</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">import</span><span class="token plain">  probablepeople </span><span class="token keyword" style="color:#00009f">as</span><span class="token plain"> pp</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> usaddress </span><span class="token keyword" style="color:#00009f">as</span><span class="token plain"> ua</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> nltk</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">nltk</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">download</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;punkt&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">nltk</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">download</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;averaged_perceptron_tagger&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">nltk</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">download</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;maxent_ne_chunker&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">nltk</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">download</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;words&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> warnings</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">warnings</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">filterwarnings</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;ignore&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">tqdm</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">pandas</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token operator" style="color:#393A34">%</span><span class="token plain">reload_ext autoreload</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token operator" style="color:#393A34">%</span><span class="token plain">autoreload </span><span class="token number" style="color:#36acaa">2</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token operator" style="color:#393A34">%</span><span class="token plain">reload_ext google</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">colab</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">data_table</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token operator" style="color:#393A34">%</span><span class="token plain">config InlineBackend</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">figure_format </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;retina&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">plt</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">style</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">use</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;fivethirtyeight&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">plt</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">style</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">use</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;seaborn-notebook&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><div class="codeBlockContainer_I0IT language-python theme-code-block"><div class="codeBlockContent_wNvx python"><pre tabindex="0" class="prism-code language-python codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">df </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> pd</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">read_pickle</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">os</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">path</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">join</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">path</span><span class="token punctuation" style="color:#393A34">,</span><span class="token string" style="color:#e3116c">&#x27;sample.p&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">df</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">info</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">data </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> df</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">oor</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">tolist</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">&lt;class &#x27;pandas.core.frame.DataFrame&#x27;&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Int64Index: 1000 entries, 3605089 to 2516200</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Data columns (total 2 columns):</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> #   Column  Non-Null Count  Dtype </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">---  ------  --------------  ----- </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 0   _id     1000 non-null   object</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 1   oor     1000 non-null   object</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">dtypes: object(2)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">memory usage: 23.4+ KB</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><div class="codeBlockContainer_I0IT language-python theme-code-block"><div class="codeBlockContent_wNvx python"><pre tabindex="0" class="prism-code language-python codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">data</span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">:</span><span class="token number" style="color:#36acaa">10</span><span class="token punctuation" style="color:#393A34">]</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><div class="codeBlockContainer_I0IT language-python theme-code-block"><div class="codeBlockContent_wNvx python"><pre tabindex="0" class="prism-code language-python codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">combos </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&#x27; US &#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token string" style="color:#e3116c">&#x27; USA &#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token string" style="color:#e3116c">&#x27; U.S. &#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token string" style="color:#e3116c">&#x27; U.S.A. &#x27;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">def</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">patch_country</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">text</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  cflagz </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  otext </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> text</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  text </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> text</span><span class="token punctuation" style="color:#393A34">[</span><span class="token operator" style="color:#393A34">-</span><span class="token number" style="color:#36acaa">10</span><span class="token punctuation" style="color:#393A34">:</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  text </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27; &#x27;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> text </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27; &#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">for</span><span class="token plain"> i </span><span class="token keyword" style="color:#00009f">in</span><span class="token plain"> combos</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> i </span><span class="token keyword" style="color:#00009f">in</span><span class="token plain"> text</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      cflagz </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> i</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  text </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> otext</span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">:</span><span class="token operator" style="color:#393A34">-</span><span class="token number" style="color:#36acaa">10</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> re</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">sub</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">cflagz</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> text</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> text</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> cflagz</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><div class="codeBlockContainer_I0IT language-python theme-code-block"><div class="codeBlockContent_wNvx python"><pre tabindex="0" class="prism-code language-python codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">def</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">patch_household</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">xz</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  xx </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> pd</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">DataFrame</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">pp</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">tag</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">xz</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> index</span><span class="token operator" style="color:#393A34">=</span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  xx</span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&#x27;Type&#x27;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;Person&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;And&#x27;</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">in</span><span class="token plain"> xx</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">columns</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">tolist</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    xx </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> pd</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">DataFrame</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">{</span><span class="token string" style="color:#e3116c">&#x27;Household&#x27;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain">xz</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> index</span><span class="token operator" style="color:#393A34">=</span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    xx</span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&#x27;Type&#x27;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;Household&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> xx</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><div class="codeBlockContainer_I0IT language-python theme-code-block"><div class="codeBlockContent_wNvx python"><pre tabindex="0" class="prism-code language-python codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">tags </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> pp</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">LABELS</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">tags</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">extend</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">ua</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">LABELS</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">tags </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token builtin">list</span><span class="token punctuation" style="color:#393A34">(</span><span class="token builtin">set</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">tags</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">additionals </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&#x27;CountryName&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;Household&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;Type&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;NameConfidence&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;AddrConfidence&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;Text&#x27;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">tags</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">extend</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">additionals</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><div class="codeBlockContainer_I0IT language-python theme-code-block"><div class="codeBlockContent_wNvx python"><pre tabindex="0" class="prism-code language-python codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">dfx </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> pd</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">DataFrame</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">columns</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">tags</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">dfx </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> dfx</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">loc</span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">:</span><span class="token punctuation" style="color:#393A34">,</span><span class="token operator" style="color:#393A34">~</span><span class="token plain">dfx</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">columns</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">duplicated</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">]</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><div class="codeBlockContainer_I0IT language-python theme-code-block"><div class="codeBlockContent_wNvx python"><pre tabindex="0" class="prism-code language-python codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># def temp(text):</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">#   # replace long country name with short one</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">#   text = re.sub(&#x27;UNITED STATES OF AMERICA&#x27;,&#x27;US&#x27;,text)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">#   # country patch</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">#   text, cflag = patch_country(text)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">#   # try and catch</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">#   try:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">#     df1 = pd.DataFrame(ua.tag(text)[0], index=[0])</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">#     xz = df1.Recipient.values[0]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">#     df2 = patch_household(xz)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">#     xx = pd.concat([df1,df2], axis=1)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">#     xx[&#x27;Confidence&#x27;] = ua.tag(text)[1]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">#   except:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">#     try:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">#       df2 = patch_household(text)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">#       xx = df2</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">#       xx[&#x27;Confidence&#x27;] = &#x27;AddressError&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">#     except:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">#       xx = pd.DataFrame({&#x27;Recipient&#x27;:text}, index=[0])</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">#       xx[&#x27;Confidence&#x27;] = &#x27;PersonError&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">#   # add country label</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">#   if cflag!=&#x27;&#x27;:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">#     xx[&#x27;CountryName&#x27;] = cflag</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">#   return xx#.T.to_dict()[0]</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><div class="codeBlockContainer_I0IT language-python theme-code-block"><div class="codeBlockContent_wNvx python"><pre tabindex="0" class="prism-code language-python codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">def</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">temp</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">text</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic"># country patch</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  text </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> re</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">sub</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;UNITED STATES OF AMERICA&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token string" style="color:#e3116c">&#x27;US&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">text</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  text</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> cflag </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> patch_country</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">text</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic"># address parsing</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">try</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    df1 </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> pd</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">DataFrame</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">ua</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">tag</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">text</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> index</span><span class="token operator" style="color:#393A34">=</span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    df1</span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&#x27;AddrConfidence&#x27;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> ua</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">tag</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">text</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">except</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    df1 </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> pd</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">DataFrame</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">ua</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">parse</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">text</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">groupby</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">agg</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">{</span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">lambda</span><span class="token plain"> x</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27; &#x27;</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">join</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">x</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">T</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    df1</span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&#x27;AddrConfidence&#x27;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;Error&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic"># address to name linking</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">try</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    xz </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> df1</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">Recipient</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">values</span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">except</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    xz </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> text</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic"># name parsing</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">try</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    df2 </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> pd</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">DataFrame</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">pp</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">tag</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">xz</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> index</span><span class="token operator" style="color:#393A34">=</span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    df2</span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&#x27;NameConfidence&#x27;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> pp</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">tag</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">xz</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">except</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    df2 </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> pd</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">DataFrame</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">pp</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">parse</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">xz</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">groupby</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">agg</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">{</span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">lambda</span><span class="token plain"> x</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27; &#x27;</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">join</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">x</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">T</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    df2</span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&#x27;NameConfidence&#x27;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;Error&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic"># person name patch</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  df2</span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&#x27;Type&#x27;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;Person&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;MiddleName&#x27;</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">in</span><span class="token plain"> df2</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">columns</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">tolist</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    gname</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> mname</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> sname </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> df2</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">MiddleName</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> df2</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">Surname</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> df2</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">GivenName</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    df2</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">MiddleName</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> df2</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">Surname</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> df2</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">GivenName </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> mname</span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> sname</span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> gname</span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">elif</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;GivenName&#x27;</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">in</span><span class="token plain"> df2</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">columns</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">tolist</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    gname</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> sname </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> df2</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">Surname</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> df2</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">GivenName</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    df2</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">Surname</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> df2</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">GivenName </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> sname</span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> gname</span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic"># household name patch</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;And&#x27;</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">in</span><span class="token plain"> df2</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">columns</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">tolist</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    df2 </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> pd</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">DataFrame</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">{</span><span class="token string" style="color:#e3116c">&#x27;Household&#x27;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain">xz</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> index</span><span class="token operator" style="color:#393A34">=</span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    df2</span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&#x27;Type&#x27;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;Household&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic"># concatenation</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  df </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> pd</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">concat</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">df1</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">df2</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> axis</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  df</span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&#x27;Text&#x27;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> text  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  df</span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&#x27;CountryName&#x27;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> cflag </span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> cflag</span><span class="token operator" style="color:#393A34">!=</span><span class="token string" style="color:#e3116c">&#x27;&#x27;</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">else</span><span class="token plain"> np</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">NaN</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">try</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    df</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">loc</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">pd</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">notnull</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">df</span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&#x27;CorporationName&#x27;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;Type&#x27;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;Corporation&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">except</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">pass</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> df</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><div class="codeBlockContainer_I0IT language-python theme-code-block"><div class="codeBlockContent_wNvx python"><pre tabindex="0" class="prism-code language-python codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">errs </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">dfx </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> pd</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">DataFrame</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">columns</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">tags</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">dfx </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> dfx</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">loc</span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">:</span><span class="token punctuation" style="color:#393A34">,</span><span class="token operator" style="color:#393A34">~</span><span class="token plain">dfx</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">columns</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">duplicated</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">for</span><span class="token plain"> idx</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> text </span><span class="token keyword" style="color:#00009f">in</span><span class="token plain"> tqdm</span><span class="token punctuation" style="color:#393A34">(</span><span class="token builtin">enumerate</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">data</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">try</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    dfx </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> dfx</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">append</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">temp</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">text</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    dfx</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">loc</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">pd</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">notnull</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">dfx</span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&#x27;CorporationName&#x27;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;Type&#x27;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;Corporation&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">except</span><span class="token plain"> Exception </span><span class="token keyword" style="color:#00009f">as</span><span class="token plain"> e</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    errs</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">idx</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> e</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">pass</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">dfx </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> dfx</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">fillna</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">1000it [00:18, 52.66it/s]</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><div class="codeBlockContainer_I0IT language-python theme-code-block"><div class="codeBlockContent_wNvx python"><pre tabindex="0" class="prism-code language-python codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">err_df </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> pd</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">DataFrame</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">errs</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> index</span><span class="token operator" style="color:#393A34">=</span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">T</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">err_df </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> err_df</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">merge</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">pd</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">Series</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">data</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> name</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&#x27;text&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> left_index</span><span class="token operator" style="color:#393A34">=</span><span class="token boolean" style="color:#36acaa">True</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> right_index</span><span class="token operator" style="color:#393A34">=</span><span class="token boolean" style="color:#36acaa">True</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">err_df</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">columns </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&#x27;error&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token string" style="color:#e3116c">&#x27;text&#x27;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">err_df </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> err_df</span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&#x27;text&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token string" style="color:#e3116c">&#x27;error&#x27;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">err_df</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">iloc</span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">:</span><span class="token punctuation" style="color:#393A34">]</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><div class="codeBlockContainer_I0IT language-python theme-code-block"><div class="codeBlockContent_wNvx python"><pre tabindex="0" class="prism-code language-python codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">dfbackup </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> dfx</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">copy</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><div class="codeBlockContainer_I0IT language-python theme-code-block"><div class="codeBlockContent_wNvx python"><pre tabindex="0" class="prism-code language-python codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">dfx </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> dfbackup</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">tags</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">dfx</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">drop</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&#x27;Recipient&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;CountryName&#x27;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> axis</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> inplace</span><span class="token operator" style="color:#393A34">=</span><span class="token boolean" style="color:#36acaa">True</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">dfx </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> dfx</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">replace</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">r&#x27;^\s*$&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> np</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">nan</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> regex</span><span class="token operator" style="color:#393A34">=</span><span class="token boolean" style="color:#36acaa">True</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">dropna</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">axis</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> how</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&#x27;all&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">dfx</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">info</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">&lt;class &#x27;pandas.core.frame.DataFrame&#x27;&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Int64Index: 989 entries, 0 to 0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Data columns (total 39 columns):</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> #   Column                           Non-Null Count  Dtype </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">---  ------                           --------------  ----- </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 0   USPSBoxType                      59 non-null     object</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 1   CorporationCommitteeType         1 non-null      object</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 2   SubaddressType                   18 non-null     object</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 3   ZipCode                          703 non-null    object</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 4   GivenName                        417 non-null    object</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 5   StreetNamePreDirectional         86 non-null     object</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 6   CorporationNameAndCompany        4 non-null      object</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 7   StreetName                       906 non-null    object</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 8   CorporationName                  381 non-null    object</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 9   PlaceName                        888 non-null    object</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 10  StateName                        807 non-null    object</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 11  ShortForm                        1 non-null      object</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 12  Surname                          407 non-null    object</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 13  CorporationLegalType             106 non-null    object</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 14  StreetNamePostType               863 non-null    object</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 15  PrefixOther                      7 non-null      object</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 16  CorporationNameBranchType        4 non-null      object</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 17  AddressNumber                    902 non-null    object</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 18  USPSBoxID                        59 non-null     object</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 19  MiddleInitial                    152 non-null    object</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 20  AddressNumberSuffix              1 non-null      object</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 21  CorporationNameBranchIdentifier  9 non-null      object</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 22  SuffixOther                      3 non-null      object</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 23  LandmarkName                     2 non-null      object</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 24  CorporationNameOrganization      57 non-null     object</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 25  BuildingName                     52 non-null     object</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 26  OccupancyIdentifier              227 non-null    object</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 27  MiddleName                       33 non-null     object</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 28  StreetNamePreType                16 non-null     object</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 29  StreetNamePostDirectional        15 non-null     object</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 30  OccupancyType                    170 non-null    object</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 31  FirstInitial                     1 non-null      object</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 32  SubaddressIdentifier             19 non-null     object</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 33  SuffixGenerational               8 non-null      object</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 34  Household                        192 non-null    object</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 35  Type                             989 non-null    object</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 36  NameConfidence                   797 non-null    object</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 37  AddrConfidence                   989 non-null    object</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 38  Text                             986 non-null    object</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">dtypes: object(39)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">memory usage: 309.1+ KB</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><div class="codeBlockContainer_I0IT language-python theme-code-block"><div class="codeBlockContent_wNvx python"><pre tabindex="0" class="prism-code language-python codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">def</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">func</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">text</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  text </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token builtin">str</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">text</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  xx </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> temp</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">text</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  xx </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> xx</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">drop</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&#x27;AddrConfidence&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token string" style="color:#e3116c">&#x27;NameConfidence&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token string" style="color:#e3116c">&#x27;Text&#x27;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> axis</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">try</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    xx </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> xx</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">drop</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&#x27;Recipient&#x27;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> axis</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">except</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">pass</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  xx </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> xx</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">T</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">to_dict</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> </span><span class="token builtin">str</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">xx</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><div class="codeBlockContainer_I0IT language-python theme-code-block"><div class="codeBlockContent_wNvx python"><pre tabindex="0" class="prism-code language-python codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># !pip install -q gradio</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># import gradio as gr</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">gr</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">Interface</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">fn</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">func</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> inputs</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&quot;text&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> outputs</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&quot;text&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">launch</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><h2 class="anchor anchorWithStickyNavbar_mojV" id="sampling">Sampling<a class="hash-link" href="#sampling" title="Direct link to heading">​</a></h2><div class="codeBlockContainer_I0IT language-python theme-code-block"><div class="codeBlockContent_wNvx python"><pre tabindex="0" class="prism-code language-python codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">path </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;.&#x27;</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><div class="codeBlockContainer_I0IT language-python theme-code-block"><div class="codeBlockContent_wNvx python"><pre tabindex="0" class="prism-code language-python codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> os</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> re</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> numpy </span><span class="token keyword" style="color:#00009f">as</span><span class="token plain"> np</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> pandas </span><span class="token keyword" style="color:#00009f">as</span><span class="token plain"> pd</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> tqdm </span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> tqdm</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> warnings</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">tqdm</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">pandas</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">warnings</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">filterwarnings</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;ignore&quot;</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><div class="codeBlockContainer_I0IT language-python theme-code-block"><div class="codeBlockContent_wNvx python"><pre tabindex="0" class="prism-code language-python codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># df = pd.read_pickle(os.path.join(path,&#x27;df_entities.p&#x27;))</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># df.info()</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><div class="codeBlockContainer_I0IT language-python theme-code-block"><div class="codeBlockContent_wNvx python"><pre tabindex="0" class="prism-code language-python codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># def process_text(text):</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">#   text = re.sub(&#x27;&quot;&#x27;,&#x27;&#x27;,text)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">#   text = re.sub(&#x27;,&#x27;,&#x27;&#x27;,text)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">#   text = &#x27; &#x27;.join(text.split())</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">#   return text</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># sampledf = df[[&#x27;oor&#x27;]].sample(5000, random_state=40)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># sampledf[&#x27;oor&#x27;] = sampledf.oor.apply(process_text)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># sampledf = sampledf.replace(r&#x27;^\s*$&#x27;, np.nan, regex=True).dropna()</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># msk = np.random.rand(len(sampledf)) &lt; 0.8</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># sampledf[msk].to_csv(&#x27;train_28118_21.csv&#x27;, index=False, header=None)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># sampledf[~msk].to_csv(&#x27;test_28118_21.csv&#x27;, index=False, header=None)</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><div class="codeBlockContainer_I0IT language-python theme-code-block"><div class="codeBlockContent_wNvx python"><pre tabindex="0" class="prism-code language-python codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">!pip install doccano</span><span class="token operator" style="color:#393A34">-</span><span class="token plain">transformer</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> spacy</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> random</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> doccano_transformer</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">datasets </span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> NERDataset</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> doccano_transformer</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">utils </span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> read_jsonl</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">dataset </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> read_jsonl</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">filepath</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&#x27;file.json1&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> dataset</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">NERDataset</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> encoding</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&#x27;utf-8&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">dataset</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">to_spacy</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">tokenizer</span><span class="token operator" style="color:#393A34">=</span><span class="token builtin">str</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">split</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">TRAIN_DATA </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">for</span><span class="token plain"> x </span><span class="token keyword" style="color:#00009f">in</span><span class="token plain"> dataset</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  xx </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">try</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    xx</span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&#x27;entities&#x27;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token builtin">list</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">x</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">labels</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">values</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    TRAIN_DATA</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">append</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">x</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">text</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">lower</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> xx</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">except</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">pass</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><div class="codeBlockContainer_I0IT language-python theme-code-block"><div class="codeBlockContent_wNvx python"><pre tabindex="0" class="prism-code language-python codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">def</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">train_spacy</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">data</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> iterations</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> model</span><span class="token operator" style="color:#393A34">=</span><span class="token boolean" style="color:#36acaa">None</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    TRAIN_DATA </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> data</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> model </span><span class="token keyword" style="color:#00009f">is</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">not</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">None</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        nlp </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> spacy</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">load</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">model</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">print</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;Loaded model &#x27;%s&#x27;&quot;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">%</span><span class="token plain"> model</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">else</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        nlp </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> spacy</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">blank</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;en&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">print</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;Created blank &#x27;en&#x27; model&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;ner&#x27;</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">not</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">in</span><span class="token plain"> nlp</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">pipe_names</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        ner </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> nlp</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">create_pipe</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;ner&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        nlp</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">add_pipe</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">ner</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> last</span><span class="token operator" style="color:#393A34">=</span><span class="token boolean" style="color:#36acaa">True</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">else</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        ner </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> nlp</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">get_pipe</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;ner&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic"># add labels</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">for</span><span class="token plain"> _</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> annotations </span><span class="token keyword" style="color:#00009f">in</span><span class="token plain"> TRAIN_DATA</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">         </span><span class="token keyword" style="color:#00009f">for</span><span class="token plain"> ent </span><span class="token keyword" style="color:#00009f">in</span><span class="token plain"> annotations</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">get</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;entities&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            ner</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">add_label</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">ent</span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">2</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic"># get names of other pipes to disable them during training</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    other_pipes </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">pipe </span><span class="token keyword" style="color:#00009f">for</span><span class="token plain"> pipe </span><span class="token keyword" style="color:#00009f">in</span><span class="token plain"> nlp</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">pipe_names </span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> pipe </span><span class="token operator" style="color:#393A34">!=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;ner&#x27;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">with</span><span class="token plain"> nlp</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">disable_pipes</span><span class="token punctuation" style="color:#393A34">(</span><span class="token operator" style="color:#393A34">*</span><span class="token plain">other_pipes</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic"># only train NER</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        optimizer </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> nlp</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">begin_training</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">for</span><span class="token plain"> itn </span><span class="token keyword" style="color:#00009f">in</span><span class="token plain"> </span><span class="token builtin">range</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">iterations</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token keyword" style="color:#00009f">print</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;Statring iteration &quot;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> </span><span class="token builtin">str</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">itn</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            random</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">shuffle</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">TRAIN_DATA</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            losses </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token keyword" style="color:#00009f">for</span><span class="token plain"> text</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> annotations </span><span class="token keyword" style="color:#00009f">in</span><span class="token plain"> TRAIN_DATA</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                nlp</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">update</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">text</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic"># batch of texts</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">annotations</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic"># batch of annotations</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    drop</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">0.1</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic"># dropout - make it harder to memorise data</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    sgd</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">optimizer</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic"># callable to update weights</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    losses</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">losses</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token keyword" style="color:#00009f">print</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">losses</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> nlp</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">prdnlp </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> train_spacy</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">TRAIN_DATA</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">200</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">Created blank &#x27;en&#x27; model</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Statring iteration 0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">{&#x27;ner&#x27;: 3007.4073503919476}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Statring iteration 1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">{&#x27;ner&#x27;: 1640.818005657745}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Statring iteration 2</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">{&#x27;ner&#x27;: 1289.2707772499139}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Statring iteration 3</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">{&#x27;ner&#x27;: 1141.5257107774235}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Statring iteration 4</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">{&#x27;ner&#x27;: 915.537918427113}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Statring iteration 5</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">{&#x27;ner&#x27;: 880.0738022538334}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Statring iteration 6</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">{&#x27;ner&#x27;: 697.9718340145506}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Statring iteration 7</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">{&#x27;ner&#x27;: 477.89584190603824}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Statring iteration 192</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">{&#x27;ner&#x27;: 81.44864770046895}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Statring iteration 193</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">{&#x27;ner&#x27;: 78.21613277818398}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Statring iteration 194</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">{&#x27;ner&#x27;: 62.061153309127164}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Statring iteration 195</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">{&#x27;ner&#x27;: 62.953992718801345}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Statring iteration 196</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">{&#x27;ner&#x27;: 53.10038627353098}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Statring iteration 197</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">{&#x27;ner&#x27;: 98.58842041503256}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Statring iteration 198</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">{&#x27;ner&#x27;: 71.83606691682377}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Statring iteration 199</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">{&#x27;ner&#x27;: 72.84951195810225}</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><div class="codeBlockContainer_I0IT language-python theme-code-block"><div class="codeBlockContent_wNvx python"><pre tabindex="0" class="prism-code language-python codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># Save our trained Model</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># modelfile = input(&quot;Enter your Model Name: &quot;)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># prdnlp.to_disk(modelfile)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">prdnlp</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">to_disk</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;ner233&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> shutil</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">shutil</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">make_archive</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">os</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">path</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">join</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">path</span><span class="token punctuation" style="color:#393A34">,</span><span class="token string" style="color:#e3116c">&#x27;ner233&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token string" style="color:#e3116c">&#x27;zip&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token string" style="color:#e3116c">&#x27;/content/ner233&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><div class="codeBlockContainer_I0IT language-python theme-code-block"><div class="codeBlockContent_wNvx python"><pre tabindex="0" class="prism-code language-python codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># test = pd.read_csv(&#x27;/content/test_28118_21.csv&#x27;, header=None)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># test.head()</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><div class="codeBlockContainer_I0IT language-python theme-code-block"><div class="codeBlockContent_wNvx python"><pre tabindex="0" class="prism-code language-python codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># from spacy.gold import GoldParse</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># from spacy.scorer import Scorer</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># def evaluate(ner_model, examples):</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">#     scorer = Scorer()</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">#     for input_, annot in examples:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">#         doc_gold_text = ner_model.make_doc(input_)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">#         gold = GoldParse(doc_gold_text, entities=annot)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">#         pred_value = ner_model(input_)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">#         scorer.score(pred_value, gold)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">#     return scorer.scores</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># examples = [</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">#     (&#x27;Who is Shaka Khan?&#x27;,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">#      [(7, 17, &#x27;PERSON&#x27;)]),</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">#     (&#x27;I like London and Berlin.&#x27;,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">#      [(7, 13, &#x27;LOC&#x27;), (18, 24, &#x27;LOC&#x27;)])</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># ]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># results = evaluate(prdnlp, examples)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># def report_scores(scores, e):</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">#     &quot;&quot;&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">#     prints precision recall and f_measure</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">#     :param scores:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">#     :return:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">#     &quot;&quot;&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">#     precision = &#x27;%.2f&#x27; % scores[&#x27;ents_p&#x27;]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">#     recall = &#x27;%.2f&#x27; % scores[&#x27;ents_r&#x27;]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">#     f_measure = &#x27;%.2f&#x27; % scores[&#x27;ents_f&#x27;]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">#     print(&#x27;%-25s %-10s %-10s %-10s&#x27; % (e, precision, recall, f_measure))</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># report_scores(results, &#x27;x&#x27;)</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">x                         0.00       0.00       0.00      </span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><div class="codeBlockContainer_I0IT language-python theme-code-block"><div class="codeBlockContent_wNvx python"><pre tabindex="0" class="prism-code language-python codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># Household -&gt; Pass again for name tags</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><div class="codeBlockContainer_I0IT language-python theme-code-block"><div class="codeBlockContent_wNvx python"><pre tabindex="0" class="prism-code language-python codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">tags </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&#x27;EntityType&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token string" style="color:#e3116c">&#x27;Recipient&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token string" style="color:#e3116c">&#x27;Address&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token string" style="color:#e3116c">&#x27;GivenName&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token string" style="color:#e3116c">&#x27;MiddleName&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token string" style="color:#e3116c">&#x27;SurName&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token string" style="color:#e3116c">&#x27;Household&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token string" style="color:#e3116c">&#x27;Corporation&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token string" style="color:#e3116c">&#x27;StreetAddress&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token string" style="color:#e3116c">&#x27;City&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token string" style="color:#e3116c">&#x27;State&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token string" style="color:#e3116c">&#x27;Zipcode&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token string" style="color:#e3116c">&#x27;Country&#x27;</span><span class="token punctuation" style="color:#393A34">]</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><div class="codeBlockContainer_I0IT language-python theme-code-block"><div class="codeBlockContent_wNvx python"><pre tabindex="0" class="prism-code language-python codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">PAD_TAIL </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;&lt;redacted&gt;&#x27;</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><div class="codeBlockContainer_I0IT language-python theme-code-block"><div class="codeBlockContent_wNvx python"><pre tabindex="0" class="prism-code language-python codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">def</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">household_patch</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">row</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> row</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">EntityType</span><span class="token operator" style="color:#393A34">==</span><span class="token string" style="color:#e3116c">&#x27;Household&#x27;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    text </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> row</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">Household</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">split</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;&amp;&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;&amp;&#x27;</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">in</span><span class="token plain"> row</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">Household </span><span class="token keyword" style="color:#00009f">else</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27; &#x27;</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">join</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">row</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">Household</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">split</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">:</span><span class="token number" style="color:#36acaa">2</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    text </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> parseit</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">text</span><span class="token operator" style="color:#393A34">+</span><span class="token plain">PAD_TAIL</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    row</span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&#x27;GivenName&#x27;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> text</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">loc</span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">,</span><span class="token string" style="color:#e3116c">&#x27;GivenName&#x27;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    row</span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&#x27;SurName&#x27;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> text</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">loc</span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">,</span><span class="token string" style="color:#e3116c">&#x27;SurName&#x27;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    row</span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&#x27;MiddleName&#x27;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> text</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">loc</span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">,</span><span class="token string" style="color:#e3116c">&#x27;MiddleName&#x27;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> row</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><div class="codeBlockContainer_I0IT language-python theme-code-block"><div class="codeBlockContent_wNvx python"><pre tabindex="0" class="prism-code language-python codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">def</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">add_on</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">xx</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic"># Address is the combination of street, city, state, zip and country</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  xx</span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&#x27;Address&#x27;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> xx</span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&#x27;StreetAddress&#x27;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">+</span><span class="token string" style="color:#e3116c">&#x27; &#x27;</span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> xx</span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&#x27;City&#x27;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">+</span><span class="token string" style="color:#e3116c">&#x27; &#x27;</span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> xx</span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&#x27;State&#x27;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">+</span><span class="token string" style="color:#e3116c">&#x27; &#x27;</span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> xx</span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&#x27;Zipcode&#x27;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">+</span><span class="token string" style="color:#e3116c">&#x27; &#x27;</span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> xx</span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&#x27;Country&#x27;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic"># default is person, if household column is not empty, then household, same for corporation</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  xx</span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&#x27;EntityType&#x27;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;Person&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  xx</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">loc</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">xx</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">Household</span><span class="token operator" style="color:#393A34">!=</span><span class="token string" style="color:#e3116c">&#x27;&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token string" style="color:#e3116c">&#x27;EntityType&#x27;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;Household&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  xx</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">loc</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">xx</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">Corporation</span><span class="token operator" style="color:#393A34">!=</span><span class="token string" style="color:#e3116c">&#x27;&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token string" style="color:#e3116c">&#x27;EntityType&#x27;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;Corporation&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic"># default is full name of person, if entity is corporation ,then corporation name, same for household</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  xx</span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&#x27;Recipient&#x27;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> xx</span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&#x27;SurName&#x27;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">+</span><span class="token string" style="color:#e3116c">&#x27; &#x27;</span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> xx</span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&#x27;GivenName&#x27;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">+</span><span class="token string" style="color:#e3116c">&#x27; &#x27;</span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> xx</span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&#x27;MiddleName&#x27;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  xx</span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&#x27;Recipient&#x27;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> xx</span><span class="token punctuation" style="color:#393A34">.</span><span class="token builtin">apply</span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">lambda</span><span class="token plain"> row</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> row</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">Corporation </span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> row</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">EntityType</span><span class="token operator" style="color:#393A34">==</span><span class="token string" style="color:#e3116c">&#x27;Corporation&#x27;</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">else</span><span class="token plain"> row</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">Recipient</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> axis</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  xx</span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&#x27;Recipient&#x27;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> xx</span><span class="token punctuation" style="color:#393A34">.</span><span class="token builtin">apply</span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">lambda</span><span class="token plain"> row</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> row</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">Household </span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> row</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">EntityType</span><span class="token operator" style="color:#393A34">==</span><span class="token string" style="color:#e3116c">&#x27;Household&#x27;</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">else</span><span class="token plain"> row</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">Recipient</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> axis</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic"># adding household to name field patch</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  xx </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> xx</span><span class="token punctuation" style="color:#393A34">.</span><span class="token builtin">apply</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">household_patch</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> axis</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic"># converting to dictionary format</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  xx </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> xx</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">replace</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">r&#x27;^\s*$&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> np</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">nan</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> regex</span><span class="token operator" style="color:#393A34">=</span><span class="token boolean" style="color:#36acaa">True</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">dropna</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">axis</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> how</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&#x27;any&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  xx </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> xx</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">T</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">to_dict</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic"># return the processed data</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> xx</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><div class="codeBlockContainer_I0IT language-python theme-code-block"><div class="codeBlockContent_wNvx python"><pre tabindex="0" class="prism-code language-python codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">def</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">parseit</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">text</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  text </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token builtin">str</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">text</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">upper</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  text </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> re</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">sub</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;&quot;&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token string" style="color:#e3116c">&#x27;&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">text</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  text </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> re</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">sub</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;,&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token string" style="color:#e3116c">&#x27;&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">text</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  text </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27; &#x27;</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">join</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">text</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">split</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  output </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  doc </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> prdnlp</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">text</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">for</span><span class="token plain"> ent </span><span class="token keyword" style="color:#00009f">in</span><span class="token plain"> doc</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">ents</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    output</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">ent</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">label_</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> ent</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">text</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  df </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> pd</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">DataFrame</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">output</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> index</span><span class="token operator" style="color:#393A34">=</span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  dfx </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> pd</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">DataFrame</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">columns</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">tags</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  dfx </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> dfx</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">append</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">df</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">fillna</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> dfx</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><div class="codeBlockContainer_I0IT language-python theme-code-block"><div class="codeBlockContent_wNvx python"><pre tabindex="0" class="prism-code language-python codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">def</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">func</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">text</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  X </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> parseit</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">text</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  X </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> add_on</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">X</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  X </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token builtin">str</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">X</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> X</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><div class="codeBlockContainer_I0IT language-python theme-code-block"><div class="codeBlockContent_wNvx python"><pre tabindex="0" class="prism-code language-python codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># text = test[0].sample().tolist()[0]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">text </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;&lt;redacted&gt;&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># xx = parseit(text); xx</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># xx = pd.DataFrame(xx, index=[0]).T.reset_index(); xx.columns = [&#x27;Tag&#x27;,&#x27;Entity&#x27;]; xx</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><div class="codeBlockContainer_I0IT language-python theme-code-block"><div class="codeBlockContent_wNvx python"><pre tabindex="0" class="prism-code language-python codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">func</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;&lt;redacted&gt;&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><div class="codeBlockContainer_I0IT language-python theme-code-block"><div class="codeBlockContent_wNvx python"><pre tabindex="0" class="prism-code language-python codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># !pip install -q gradio</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># import gradio as gr</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># inputs = gr.inputs.Textbox(lines=3, label=&#x27;Input&#x27;)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># outputs = gr.outputs.Textbox(label=&#x27;Output&#x27;)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">gr</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">Interface</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">fn</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">func</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> inputs</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">inputs</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> outputs</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">outputs</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">launch</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><h2 class="anchor anchorWithStickyNavbar_mojV" id="flair-ner-model">Flair NER Model<a class="hash-link" href="#flair-ner-model" title="Direct link to heading">​</a></h2><div class="codeBlockContainer_I0IT language-python theme-code-block"><div class="codeBlockContent_wNvx python"><pre tabindex="0" class="prism-code language-python codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">!pip install doccano</span><span class="token operator" style="color:#393A34">-</span><span class="token plain">transformer</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> doccano_transformer</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">datasets </span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> NERDataset</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> doccano_transformer</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">utils </span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> read_jsonl</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">dataset </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> read_jsonl</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">filepath</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&#x27;file_2.json1&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> dataset</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">NERDataset</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> encoding</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&#x27;utf-8&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">dataset</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">to_spacy</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">tokenizer</span><span class="token operator" style="color:#393A34">=</span><span class="token builtin">str</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">split</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><div class="codeBlockContainer_I0IT language-python theme-code-block"><div class="codeBlockContent_wNvx python"><pre tabindex="0" class="prism-code language-python codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">TRAIN_DATA </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">for</span><span class="token plain"> x </span><span class="token keyword" style="color:#00009f">in</span><span class="token plain"> dataset</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  xx </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">try</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    xx</span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&#x27;entities&#x27;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token builtin">list</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">x</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">labels</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">values</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    TRAIN_DATA</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">append</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">x</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">text</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> xx</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">except</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">pass</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><div class="codeBlockContainer_I0IT language-python theme-code-block"><div class="codeBlockContent_wNvx python"><pre tabindex="0" class="prism-code language-python codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> spacy</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> spacy</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">gold </span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> biluo_tags_from_offsets</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">nlp </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> spacy</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">load</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;en_core_web_sm&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">docs </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">for</span><span class="token plain"> text</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> annot </span><span class="token keyword" style="color:#00009f">in</span><span class="token plain"> TRAIN_DATA</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    doc </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> nlp</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">text</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    tags </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> biluo_tags_from_offsets</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">doc</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> annot</span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&#x27;entities&#x27;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    tags </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">x</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">replace</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;U-&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token string" style="color:#e3116c">&#x27;B-&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">for</span><span class="token plain"> x </span><span class="token keyword" style="color:#00009f">in</span><span class="token plain"> tags</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    tags </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">x</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">replace</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;L-&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token string" style="color:#e3116c">&#x27;I-&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">for</span><span class="token plain"> x </span><span class="token keyword" style="color:#00009f">in</span><span class="token plain"> tags</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    tmpdocs </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">x</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">y</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">for</span><span class="token plain"> x</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">y </span><span class="token keyword" style="color:#00009f">in</span><span class="token plain"> </span><span class="token builtin">zip</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">text</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">split</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">tags</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    docs</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">append</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">tmpdocs</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><div class="codeBlockContainer_I0IT language-python theme-code-block"><div class="codeBlockContent_wNvx python"><pre tabindex="0" class="prism-code language-python codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> random</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> pandas </span><span class="token keyword" style="color:#00009f">as</span><span class="token plain"> pd</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">X </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> pd</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">DataFrame</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">docs</span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">X</span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&#x27;break&#x27;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;train&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">X </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> X</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">append</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">pd</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">Series</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">dtype</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&#x27;str&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> ignore_index</span><span class="token operator" style="color:#393A34">=</span><span class="token boolean" style="color:#36acaa">True</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">for</span><span class="token plain"> x </span><span class="token keyword" style="color:#00009f">in</span><span class="token plain"> docs</span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">:</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  Xt </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> pd</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">DataFrame</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">x</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  Xt </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> Xt</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">append</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">pd</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">Series</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">dtype</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&#x27;str&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> ignore_index</span><span class="token operator" style="color:#393A34">=</span><span class="token boolean" style="color:#36acaa">True</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  Xt</span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&#x27;break&#x27;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> random</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">choices</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&#x27;train&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token string" style="color:#e3116c">&#x27;val&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token string" style="color:#e3116c">&#x27;test&#x27;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> weights</span><span class="token operator" style="color:#393A34">=</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">90</span><span class="token punctuation" style="color:#393A34">,</span><span class="token number" style="color:#36acaa">5</span><span class="token punctuation" style="color:#393A34">,</span><span class="token number" style="color:#36acaa">5</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> k</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  X </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> X</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">append</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">Xt</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">X </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> X</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">fillna</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">X </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> X</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">reset_index</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">drop</span><span class="token operator" style="color:#393A34">=</span><span class="token boolean" style="color:#36acaa">True</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">train </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> X</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">loc</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">X</span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&#x27;break&#x27;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token operator" style="color:#393A34">==</span><span class="token string" style="color:#e3116c">&#x27;train&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">,</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> train</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">to_csv</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;train.txt&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> sep</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&#x27; &#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> header</span><span class="token operator" style="color:#393A34">=</span><span class="token boolean" style="color:#36acaa">None</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> index</span><span class="token operator" style="color:#393A34">=</span><span class="token boolean" style="color:#36acaa">False</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">val </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> X</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">loc</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">X</span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&#x27;break&#x27;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token operator" style="color:#393A34">==</span><span class="token string" style="color:#e3116c">&#x27;val&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">,</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> val</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">to_csv</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;val.txt&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> sep</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&#x27; &#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> header</span><span class="token operator" style="color:#393A34">=</span><span class="token boolean" style="color:#36acaa">None</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> index</span><span class="token operator" style="color:#393A34">=</span><span class="token boolean" style="color:#36acaa">False</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">test </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> X</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">loc</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">X</span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&#x27;break&#x27;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token operator" style="color:#393A34">==</span><span class="token string" style="color:#e3116c">&#x27;test&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">,</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> test</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">to_csv</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;test.txt&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> sep</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&#x27; &#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> header</span><span class="token operator" style="color:#393A34">=</span><span class="token boolean" style="color:#36acaa">None</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> index</span><span class="token operator" style="color:#393A34">=</span><span class="token boolean" style="color:#36acaa">False</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><div class="codeBlockContainer_I0IT language-python theme-code-block"><div class="codeBlockContent_wNvx python"><pre tabindex="0" class="prism-code language-python codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> re</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> numpy </span><span class="token keyword" style="color:#00009f">as</span><span class="token plain"> np</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><div class="codeBlockContainer_I0IT language-python theme-code-block"><div class="codeBlockContent_wNvx python"><pre tabindex="0" class="prism-code language-python codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">!pip install </span><span class="token operator" style="color:#393A34">-</span><span class="token plain">q flair</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> flair</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">data </span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> Corpus</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> flair</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">datasets </span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> ColumnCorpus</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">columns </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">:</span><span class="token string" style="color:#e3116c">&#x27;text&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">:</span><span class="token string" style="color:#e3116c">&#x27;ner&#x27;</span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">data_folder </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;/content&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">corpus</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> Corpus </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> ColumnCorpus</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">data_folder</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> columns</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                              train_file </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;train.txt&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                              test_file </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;test.txt&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                              dev_file </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;val.txt&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><div class="codeBlockContainer_I0IT language-python theme-code-block"><div class="codeBlockContent_wNvx python"><pre tabindex="0" class="prism-code language-python codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">tag_type </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;ner&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">tag_dictionary </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> corpus</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">make_tag_dictionary</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">tag_type</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">tag_type</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><div class="codeBlockContainer_I0IT language-python theme-code-block"><div class="codeBlockContent_wNvx python"><pre tabindex="0" class="prism-code language-python codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> flair</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">embeddings </span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> WordEmbeddings</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> StackedEmbeddings</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> FlairEmbeddings</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> CharacterEmbeddings</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">embedding_types </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    WordEmbeddings</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;glove&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic"># comment in this line to use character embeddings</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic"># CharacterEmbeddings(),</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic"># comment in these lines to use flair embeddings</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic"># FlairEmbeddings(&#x27;news-forward&#x27;),</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic"># FlairEmbeddings(&#x27;news-backward&#x27;),</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">embeddings </span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> StackedEmbeddings </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> StackedEmbeddings</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">embeddings</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">embedding_types</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><div class="codeBlockContainer_I0IT language-python theme-code-block"><div class="codeBlockContent_wNvx python"><pre tabindex="0" class="prism-code language-python codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> flair</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">models </span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> SequenceTagger</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">tagger </span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> SequenceTagger </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> SequenceTagger</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">hidden_size</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">256</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                                       embeddings</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">embeddings</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                                       tag_dictionary</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">tag_dictionary</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                                       tag_type</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">tag_type</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                                       use_crf</span><span class="token operator" style="color:#393A34">=</span><span class="token boolean" style="color:#36acaa">True</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><div class="codeBlockContainer_I0IT language-python theme-code-block"><div class="codeBlockContent_wNvx python"><pre tabindex="0" class="prism-code language-python codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> flair</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">trainers </span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> ModelTrainer</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">trainer </span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> ModelTrainer </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> ModelTrainer</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">tagger</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> corpus</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">trainer</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">train</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;/content&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">              learning_rate</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">0.5</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">              mini_batch_size</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">32</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">              max_epochs</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">150</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">              </span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:30:11,352 ----------------------------------------------------------------------------------------------------</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:30:11,354 Model: &quot;SequenceTagger(</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  (embeddings): StackedEmbeddings(</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    (list_embedding_0): WordEmbeddings(&#x27;glove&#x27;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  )</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  (word_dropout): WordDropout(p=0.05)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  (locked_dropout): LockedDropout(p=0.5)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  (embedding2nn): Linear(in_features=100, out_features=100, bias=True)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  (rnn): LSTM(100, 256, batch_first=True, bidirectional=True)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  (linear): Linear(in_features=512, out_features=24, bias=True)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  (beta): 1.0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  (weights): None</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  (weight_tensor) None</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">)&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:30:11,357 ----------------------------------------------------------------------------------------------------</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:30:11,359 Corpus: &quot;Corpus: 526 train + 36 dev + 31 test sentences&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:30:11,360 ----------------------------------------------------------------------------------------------------</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:30:11,364 Parameters:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:30:11,365  - learning_rate: &quot;0.5&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:30:11,368  - mini_batch_size: &quot;32&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:30:11,373  - patience: &quot;3&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:30:11,374  - anneal_factor: &quot;0.5&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:30:11,376  - max_epochs: &quot;150&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:30:11,377  - shuffle: &quot;True&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:30:11,378  - train_with_dev: &quot;False&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:30:11,380  - batch_growth_annealing: &quot;False&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:30:11,381 ----------------------------------------------------------------------------------------------------</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:30:11,382 Model training base path: &quot;/content&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:30:11,384 ----------------------------------------------------------------------------------------------------</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:30:11,385 Device: cuda:0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:30:11,387 ----------------------------------------------------------------------------------------------------</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:30:11,388 Embeddings storage mode: cpu</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:30:11,390 ----------------------------------------------------------------------------------------------------</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:30:11,535 epoch 1 - iter 1/17 - loss 3.43299055 - samples/sec: 224.37 - lr: 0.500000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:30:11,674 epoch 1 - iter 2/17 - loss 16.62798858 - samples/sec: 233.49 - lr: 0.500000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:30:11,773 epoch 1 - iter 3/17 - loss 12.71970431 - samples/sec: 327.61 - lr: 0.500000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:30:11,886 epoch 1 - iter 4/17 - loss 12.07628489 - samples/sec: 288.50 - lr: 0.500000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:30:12,011 epoch 1 - iter 5/17 - loss 11.39370499 - samples/sec: 258.89 - lr: 0.500000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:30:12,120 epoch 1 - iter 6/17 - loss 10.47585432 - samples/sec: 297.29 - lr: 0.500000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:30:12,226 epoch 1 - iter 7/17 - loss 10.23672819 - samples/sec: 315.00 - lr: 0.500000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:30:12,327 epoch 1 - iter 8/17 - loss 10.13630027 - samples/sec: 326.75 - lr: 0.500000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:30:12,438 epoch 1 - iter 9/17 - loss 9.72696336 - samples/sec: 292.91 - lr: 0.500000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:30:12,542 epoch 1 - iter 10/17 - loss 9.41571531 - samples/sec: 317.52 - lr: 0.500000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:30:12,654 epoch 1 - iter 11/17 - loss 9.45854959 - samples/sec: 288.96 - lr: 0.500000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:30:12,769 epoch 1 - iter 12/17 - loss 9.27839812 - samples/sec: 282.59 - lr: 0.500000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:30:12,887 epoch 1 - iter 13/17 - loss 9.43319035 - samples/sec: 280.07 - lr: 0.500000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:30:13,009 epoch 1 - iter 14/17 - loss 9.24219717 - samples/sec: 264.80 - lr: 0.500000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:30:13,120 epoch 1 - iter 15/17 - loss 9.08057699 - samples/sec: 291.56 - lr: 0.500000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:30:13,239 epoch 1 - iter 16/17 - loss 9.04910478 - samples/sec: 272.95 - lr: 0.500000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:30:13,321 epoch 1 - iter 17/17 - loss 9.02534998 - samples/sec: 401.20 - lr: 0.500000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:30:13,324 ----------------------------------------------------------------------------------------------------</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:30:13,325 EPOCH 1 done: loss 9.0253 - lr 0.5000000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:30:13,419 DEV : loss 5.717854976654053 - score 0.8698</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:30:13,423 BAD EPOCHS (no improvement): 0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">saving best model</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:30:16,358 ----------------------------------------------------------------------------------------------------</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:30:16,472 epoch 2 - iter 1/17 - loss 5.83918762 - samples/sec: 296.08 - lr: 0.500000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:30:16,588 epoch 2 - iter 2/17 - loss 6.36326265 - samples/sec: 277.67 - lr: 0.500000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:30:16,713 epoch 2 - iter 3/17 - loss 6.86526155 - samples/sec: 258.96 - lr: 0.500000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:30:16,825 epoch 2 - iter 4/17 - loss 6.52817869 - samples/sec: 295.13 - lr: 0.500000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:30:16,952 epoch 2 - iter 5/17 - loss 6.21855764 - samples/sec: 253.81 - lr: 0.500000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:30:17,070 epoch 2 - iter 6/17 - loss 6.00696262 - samples/sec: 275.53 - lr: 0.500000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:30:17,186 epoch 2 - iter 7/17 - loss 5.75874615 - samples/sec: 277.33 - lr: 0.500000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:30:17,302 epoch 2 - iter 8/17 - loss 6.11816967 - samples/sec: 278.78 - lr: 0.500000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:30:17,415 epoch 2 - iter 9/17 - loss 6.44984976 - samples/sec: 288.02 - lr: 0.500000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:30:17,530 epoch 2 - iter 10/17 - loss 6.60953989 - samples/sec: 279.91 - lr: 0.500000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:30:17,642 epoch 2 - iter 11/17 - loss 6.44363026 - samples/sec: 291.03 - lr: 0.500000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:30:17,764 epoch 2 - iter 12/17 - loss 6.50487467 - samples/sec: 263.27 - lr: 0.500000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:30:17,875 epoch 2 - iter 13/17 - loss 6.54225309 - samples/sec: 291.79 - lr: 0.500000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:30:18,001 epoch 2 - iter 14/17 - loss 6.54856760 - samples/sec: 257.35 - lr: 0.500000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:30:18,115 epoch 2 - iter 15/17 - loss 6.56940902 - samples/sec: 282.18 - lr: 0.500000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:30:18,222 epoch 2 - iter 16/17 - loss 6.58133185 - samples/sec: 303.36 - lr: 0.500000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:30:18,317 epoch 2 - iter 17/17 - loss 6.60969802 - samples/sec: 342.00 - lr: 0.500000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:30:18,319 ----------------------------------------------------------------------------------------------------</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:30:18,325 EPOCH 2 done: loss 6.6097 - lr 0.5000000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:30:18,418 DEV : loss 7.014471054077148 - score 0.7978</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:30:18,421 BAD EPOCHS (no improvement): 1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:30:18,427 ----------------------------------------------------------------------------------------------------</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:30:18,541 epoch 3 - iter 1/17 - loss 4.26388168 - samples/sec: 286.30 - lr: 0.500000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:30:18,669 epoch 3 - iter 2/17 - loss 4.22117805 - samples/sec: 251.47 - lr: 0.500000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:30:18,789 epoch 3 - iter 3/17 - loss 4.93522231 - samples/sec: 269.09 - lr: 0.500000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:30:18,908 epoch 3 - iter 4/17 - loss 5.27011728 - samples/sec: 272.53 - lr: 0.500000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:30:19,023 epoch 3 - iter 5/17 - loss 5.39386015 - samples/sec: 282.34 - lr: 0.500000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:30:19,147 epoch 3 - iter 6/17 - loss 5.57506188 - samples/sec: 260.17 - lr: 0.500000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:30:19,263 epoch 3 - iter 7/17 - loss 5.80165243 - samples/sec: 280.20 - lr: 0.500000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:30:19,377 epoch 3 - iter 8/17 - loss 5.74144500 - samples/sec: 284.49 - lr: 0.500000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:30:19,489 epoch 3 - iter 9/17 - loss 5.83528980 - samples/sec: 289.27 - lr: 0.500000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:30:19,602 epoch 3 - iter 10/17 - loss 5.94376082 - samples/sec: 285.24 - lr: 0.500000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:30:19,719 epoch 3 - iter 11/17 - loss 6.10046205 - samples/sec: 276.22 - lr: 0.500000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:30:19,834 epoch 3 - iter 12/17 - loss 6.31112369 - samples/sec: 281.37 - lr: 0.500000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:30:19,943 epoch 3 - iter 13/17 - loss 6.59776673 - samples/sec: 296.36 - lr: 0.500000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:30:20,049 epoch 3 - iter 14/17 - loss 6.57175589 - samples/sec: 306.47 - lr: 0.500000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:30:20,175 epoch 3 - iter 15/17 - loss 6.53515657 - samples/sec: 256.03 - lr: 0.500000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:30:20,280 epoch 3 - iter 16/17 - loss 6.45572126 - samples/sec: 308.22 - lr: 0.500000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:30:20,363 epoch 3 - iter 17/17 - loss 6.33213214 - samples/sec: 394.86 - lr: 0.500000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:30:20,364 ----------------------------------------------------------------------------------------------------</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:30:20,369 EPOCH 3 done: loss 6.3321 - lr 0.5000000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:30:20,447 DEV : loss 6.267121315002441 - score 0.7705</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:30:20,451 BAD EPOCHS (no improvement): 2</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:30:20,453 ----------------------------------------------------------------------------------------------------</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:30:20,567 epoch 4 - iter 1/17 - loss 5.04142189 - samples/sec: 288.98 - lr: 0.500000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:30:20,708 epoch 4 - iter 2/17 - loss 6.17017388 - samples/sec: 229.78 - lr: 0.500000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:30:20,842 epoch 4 - iter 3/17 - loss 5.64043872 - samples/sec: 241.44 - lr: 0.500000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:30:20,949 epoch 4 - iter 4/17 - loss 5.29508078 - samples/sec: 311.53 - lr: 0.500000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:30:21,053 epoch 4 - iter 5/17 - loss 4.82136688 - samples/sec: 311.77 - lr: 0.500000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:30:21,174 epoch 4 - iter 6/17 - loss 4.83669527 - samples/sec: 269.39 - lr: 0.500000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:30:21,286 epoch 4 - iter 7/17 - loss 4.87344299 - samples/sec: 293.77 - lr: 0.500000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:30:21,396 epoch 4 - iter 8/17 - loss 5.19339198 - samples/sec: 292.26 - lr: 0.500000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:30:21,504 epoch 4 - iter 9/17 - loss 5.36148289 - samples/sec: 303.14 - lr: 0.500000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:30:21,612 epoch 4 - iter 10/17 - loss 5.43170042 - samples/sec: 298.35 - lr: 0.500000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:30:21,724 epoch 4 - iter 11/17 - loss 5.40744721 - samples/sec: 290.04 - lr: 0.500000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:30:21,838 epoch 4 - iter 12/17 - loss 5.46409893 - samples/sec: 284.06 - lr: 0.500000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:30:21,947 epoch 4 - iter 13/17 - loss 5.48474825 - samples/sec: 295.24 - lr: 0.500000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:30:22,054 epoch 4 - iter 14/17 - loss 5.34932395 - samples/sec: 303.95 - lr: 0.500000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:30:22,167 epoch 4 - iter 15/17 - loss 5.32448457 - samples/sec: 284.46 - lr: 0.500000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:30:22,292 epoch 4 - iter 16/17 - loss 5.21404728 - samples/sec: 260.52 - lr: 0.500000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:30:22,374 epoch 4 - iter 17/17 - loss 5.10825051 - samples/sec: 394.18 - lr: 0.500000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:30:22,375 ----------------------------------------------------------------------------------------------------</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:30:22,380 EPOCH 4 done: loss 5.1083 - lr 0.5000000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:30:22,456 DEV : loss 4.367828369140625 - score 0.8491</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:30:22,459 BAD EPOCHS (no improvement): 3</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:30:22,461 ----------------------------------------------------------------------------------------------------</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:30:22,570 epoch 5 - iter 1/17 - loss 6.80663157 - samples/sec: 303.24 - lr: 0.500000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:30:22,666 epoch 5 - iter 2/17 - loss 5.35868144 - samples/sec: 341.59 - lr: 0.500000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:30:22,779 epoch 5 - iter 3/17 - loss 5.17130645 - samples/sec: 288.28 - lr: 0.500000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:30:22,892 epoch 5 - iter 4/17 - loss 4.78146195 - samples/sec: 284.10 - lr: 0.500000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:30:23,007 epoch 5 - iter 5/17 - loss 4.49372272 - samples/sec: 283.10 - lr: 0.500000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:30:23,116 epoch 5 - iter 6/17 - loss 4.40794814 - samples/sec: 296.27 - lr: 0.500000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:30:23,233 epoch 5 - iter 7/17 - loss 5.19045050 - samples/sec: 277.11 - lr: 0.500000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:30:23,341 epoch 5 - iter 8/17 - loss 5.04928717 - samples/sec: 300.85 - lr: 0.500000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:30:23,461 epoch 5 - iter 9/17 - loss 4.83003471 - samples/sec: 268.51 - lr: 0.500000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:30:23,569 epoch 5 - iter 10/17 - loss 5.06927426 - samples/sec: 301.46 - lr: 0.500000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:30:23,696 epoch 5 - iter 11/17 - loss 4.97240255 - samples/sec: 255.22 - lr: 0.500000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:30:23,806 epoch 5 - iter 12/17 - loss 5.07106882 - samples/sec: 294.08 - lr: 0.500000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:30:23,929 epoch 5 - iter 13/17 - loss 5.17605252 - samples/sec: 262.74 - lr: 0.500000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:30:24,038 epoch 5 - iter 14/17 - loss 5.14826872 - samples/sec: 295.90 - lr: 0.500000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:30:24,144 epoch 5 - iter 15/17 - loss 5.33293700 - samples/sec: 305.56 - lr: 0.500000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:30:24,257 epoch 5 - iter 16/17 - loss 5.31216620 - samples/sec: 286.96 - lr: 0.500000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:30:24,342 epoch 5 - iter 17/17 - loss 5.50642596 - samples/sec: 380.72 - lr: 0.500000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:30:24,347 ----------------------------------------------------------------------------------------------------</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:30:24,348 EPOCH 5 done: loss 5.5064 - lr 0.5000000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:30:24,428 DEV : loss 7.306588172912598 - score 0.8609</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Epoch     5: reducing learning rate of group 0 to 2.5000e-01.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:30:24,430 BAD EPOCHS (no improvement): 4</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:30:24,434 ----------------------------------------------------------------------------------------------------</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:30:24,544 epoch 6 - iter 1/17 - loss 6.96324205 - samples/sec: 296.94 - lr: 0.250000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:30:24,658 epoch 6 - iter 2/17 - loss 5.62635350 - samples/sec: 284.77 - lr: 0.250000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:30:24,779 epoch 6 - iter 3/17 - loss 5.42040205 - samples/sec: 266.03 - lr: 0.250000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:30:24,922 epoch 6 - iter 4/17 - loss 5.56092465 - samples/sec: 226.18 - lr: 0.250000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:30:25,033 epoch 6 - iter 5/17 - loss 5.47617340 - samples/sec: 291.45 - lr: 0.250000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:30:25,141 epoch 6 - iter 6/17 - loss 5.06147250 - samples/sec: 300.30 - lr: 0.250000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:30:25,253 epoch 6 - iter 7/17 - loss 4.85828168 - samples/sec: 288.46 - lr: 0.250000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:30:25,371 epoch 6 - iter 8/17 - loss 4.62894660 - samples/sec: 273.66 - lr: 0.250000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:30:25,485 epoch 6 - iter 9/17 - loss 4.33706284 - samples/sec: 283.62 - lr: 0.250000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:30:25,613 epoch 6 - iter 10/17 - loss 4.21852846 - samples/sec: 253.76 - lr: 0.250000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:30:25,719 epoch 6 - iter 11/17 - loss 4.07177886 - samples/sec: 305.92 - lr: 0.250000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:30:25,833 epoch 6 - iter 12/17 - loss 3.97449460 - samples/sec: 283.66 - lr: 0.250000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:30:25,952 epoch 6 - iter 13/17 - loss 3.94040249 - samples/sec: 272.32 - lr: 0.250000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:30:26,055 epoch 6 - iter 14/17 - loss 3.86654231 - samples/sec: 315.98 - lr: 0.250000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:30:26,171 epoch 6 - iter 15/17 - loss 3.94532137 - samples/sec: 277.03 - lr: 0.250000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:30:26,283 epoch 6 - iter 16/17 - loss 3.87008142 - samples/sec: 290.29 - lr: 0.250000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:30:26,349 epoch 6 - iter 17/17 - loss 3.82113767 - samples/sec: 506.56 - lr: 0.250000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:30:26,350 ----------------------------------------------------------------------------------------------------</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:30:26,355 EPOCH 6 done: loss 3.8211 - lr 0.2500000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:30:26,436 DEV : loss 3.1234371662139893 - score 0.8808</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:30:26,438 BAD EPOCHS (no improvement): 0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">saving best model</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:30:29,221 ----------------------------------------------------------------------------------------------------</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:30:29,343 epoch 7 - iter 1/17 - loss 3.70950317 - samples/sec: 268.26 - lr: 0.250000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:30:29,446 epoch 7 - iter 2/17 - loss 3.15139985 - samples/sec: 313.16 - lr: 0.250000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:30:29,557 epoch 7 - iter 3/17 - loss 2.90648588 - samples/sec: 292.79 - lr: 0.250000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:30:29,691 epoch 7 - iter 4/17 - loss 2.84409702 - samples/sec: 240.22 - lr: 0.250000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:30:29,792 epoch 7 - iter 5/17 - loss 2.73230619 - samples/sec: 322.98 - lr: 0.250000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:30:29,917 epoch 7 - iter 6/17 - loss 2.97766495 - samples/sec: 258.82 - lr: 0.250000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:30:30,024 epoch 7 - iter 7/17 - loss 3.07457617 - samples/sec: 301.19 - lr: 0.250000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:30:30,129 epoch 7 - iter 8/17 - loss 3.16595078 - samples/sec: 311.51 - lr: 0.250000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:30:30,226 epoch 7 - iter 9/17 - loss 3.29891888 - samples/sec: 332.91 - lr: 0.250000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:30:30,337 epoch 7 - iter 10/17 - loss 3.39236808 - samples/sec: 291.15 - lr: 0.250000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:30:30,441 epoch 7 - iter 11/17 - loss 3.41726154 - samples/sec: 312.11 - lr: 0.250000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:30:30,549 epoch 7 - iter 12/17 - loss 3.41482002 - samples/sec: 299.15 - lr: 0.250000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:30:30,648 epoch 7 - iter 13/17 - loss 3.32942341 - samples/sec: 326.18 - lr: 0.250000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:30:30,793 epoch 7 - iter 14/17 - loss 3.42877962 - samples/sec: 223.33 - lr: 0.250000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:30:30,905 epoch 7 - iter 15/17 - loss 3.37255146 - samples/sec: 287.33 - lr: 0.250000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:30:31,012 epoch 7 - iter 16/17 - loss 3.29338527 - samples/sec: 302.59 - lr: 0.250000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:30:31,097 epoch 7 - iter 17/17 - loss 3.36279516 - samples/sec: 382.70 - lr: 0.250000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:30:31,098 ----------------------------------------------------------------------------------------------------</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:30:31,104 EPOCH 7 done: loss 3.3628 - lr 0.2500000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:30:31,181 DEV : loss 2.352734327316284 - score 0.8164</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:30:31,183 BAD EPOCHS (no improvement): 1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:30:31,187 ----------------------------------------------------------------------------------------------------</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:30:31,298 epoch 8 - iter 1/17 - loss 3.31515622 - samples/sec: 294.10 - lr: 0.250000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:30:31,430 epoch 8 - iter 2/17 - loss 3.51384747 - samples/sec: 245.22 - lr: 0.250000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:30:31,541 epoch 8 - iter 3/17 - loss 3.30893199 - samples/sec: 290.08 - lr: 0.250000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:30:31,656 epoch 8 - iter 4/17 - loss 3.24576128 - samples/sec: 283.74 - lr: 0.250000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:30:31,758 epoch 8 - iter 5/17 - loss 3.12689247 - samples/sec: 315.29 - lr: 0.250000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:30:31,862 epoch 8 - iter 6/17 - loss 2.94166811 - samples/sec: 313.46 - lr: 0.250000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:30:31,992 epoch 8 - iter 7/17 - loss 3.11964280 - samples/sec: 251.93 - lr: 0.250000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:30:32,098 epoch 8 - iter 8/17 - loss 3.04969150 - samples/sec: 304.60 - lr: 0.250000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:30:32,205 epoch 8 - iter 9/17 - loss 3.06001208 - samples/sec: 302.37 - lr: 0.250000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:30:32,313 epoch 8 - iter 10/17 - loss 3.13563135 - samples/sec: 298.31 - lr: 0.250000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:30:32,428 epoch 8 - iter 11/17 - loss 3.17867511 - samples/sec: 281.42 - lr: 0.250000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:30:32,542 epoch 8 - iter 12/17 - loss 3.17592837 - samples/sec: 287.75 - lr: 0.250000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:30:32,643 epoch 8 - iter 13/17 - loss 3.17387684 - samples/sec: 321.38 - lr: 0.250000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:30:32,752 epoch 8 - iter 14/17 - loss 3.30220359 - samples/sec: 296.03 - lr: 0.250000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:30:32,864 epoch 8 - iter 15/17 - loss 3.28310798 - samples/sec: 288.32 - lr: 0.250000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:30:32,984 epoch 8 - iter 16/17 - loss 3.27035704 - samples/sec: 270.40 - lr: 0.250000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:30:33,059 epoch 8 - iter 17/17 - loss 3.25974651 - samples/sec: 429.82 - lr: 0.250000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:30:33,060 ----------------------------------------------------------------------------------------------------</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:30:33,065 EPOCH 8 done: loss 3.2597 - lr 0.2500000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:30:33,142 DEV : loss 2.3950960636138916 - score 0.8911</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:30:33,145 BAD EPOCHS (no improvement): 0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">saving best model</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:30:35,928 ----------------------------------------------------------------------------------------------------</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:30:36,063 epoch 9 - iter 1/17 - loss 4.13516760 - samples/sec: 241.45 - lr: 0.250000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:30:36,177 epoch 9 - iter 2/17 - loss 4.22095203 - samples/sec: 283.96 - lr: 0.250000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:30:36,282 epoch 9 - iter 3/17 - loss 3.74937018 - samples/sec: 307.81 - lr: 0.250000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:30:36,384 epoch 9 - iter 4/17 - loss 3.56653398 - samples/sec: 316.58 - lr: 0.250000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:30:36,505 epoch 9 - iter 5/17 - loss 3.27518516 - samples/sec: 267.32 - lr: 0.250000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:30:36,619 epoch 9 - iter 6/17 - loss 3.02496213 - samples/sec: 285.21 - lr: 0.250000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:30:36,746 epoch 9 - iter 7/17 - loss 3.03646287 - samples/sec: 253.72 - lr: 0.250000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:30:36,862 epoch 9 - iter 8/17 - loss 3.04716738 - samples/sec: 281.19 - lr: 0.250000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:30:36,966 epoch 9 - iter 9/17 - loss 3.13016204 - samples/sec: 310.68 - lr: 0.250000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:30:37,094 epoch 9 - iter 10/17 - loss 3.07540933 - samples/sec: 250.78 - lr: 0.250000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:30:37,203 epoch 9 - iter 11/17 - loss 2.99208668 - samples/sec: 298.74 - lr: 0.250000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:30:37,326 epoch 9 - iter 12/17 - loss 3.08011819 - samples/sec: 262.50 - lr: 0.250000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:30:37,437 epoch 9 - iter 13/17 - loss 3.15795074 - samples/sec: 290.04 - lr: 0.250000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:30:37,554 epoch 9 - iter 14/17 - loss 3.13511590 - samples/sec: 276.32 - lr: 0.250000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:30:37,658 epoch 9 - iter 15/17 - loss 3.09624709 - samples/sec: 312.35 - lr: 0.250000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:30:37,770 epoch 9 - iter 16/17 - loss 3.20836692 - samples/sec: 288.37 - lr: 0.250000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:30:37,857 epoch 9 - iter 17/17 - loss 3.14222338 - samples/sec: 372.18 - lr: 0.250000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:30:37,859 ----------------------------------------------------------------------------------------------------</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:30:37,865 EPOCH 9 done: loss 3.1422 - lr 0.2500000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:30:37,942 DEV : loss 2.601285934448242 - score 0.8783</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:30:37,944 BAD EPOCHS (no improvement): 1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:30:37,949 ----------------------------------------------------------------------------------------------------</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:30:38,064 epoch 10 - iter 1/17 - loss 2.18587756 - samples/sec: 286.91 - lr: 0.250000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:30:38,173 epoch 10 - iter 2/17 - loss 2.85696280 - samples/sec: 297.21 - lr: 0.250000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:30:38,279 epoch 10 - iter 3/17 - loss 3.14432240 - samples/sec: 308.52 - lr: 0.250000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:30:38,385 epoch 10 - iter 4/17 - loss 3.15336317 - samples/sec: 303.25 - lr: 0.250000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:30:38,514 epoch 10 - iter 5/17 - loss 3.14261246 - samples/sec: 250.19 - lr: 0.250000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:30:38,621 epoch 10 - iter 6/17 - loss 3.17861811 - samples/sec: 303.24 - lr: 0.250000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:30:38,734 epoch 10 - iter 7/17 - loss 3.23335017 - samples/sec: 286.76 - lr: 0.250000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:30:38,844 epoch 10 - iter 8/17 - loss 3.17415664 - samples/sec: 293.62 - lr: 0.250000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:30:38,955 epoch 10 - iter 9/17 - loss 3.23231522 - samples/sec: 291.92 - lr: 0.250000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:30:39,075 epoch 10 - iter 10/17 - loss 3.25380137 - samples/sec: 269.14 - lr: 0.250000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:30:39,190 epoch 10 - iter 11/17 - loss 3.16060584 - samples/sec: 280.60 - lr: 0.250000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:30:39,294 epoch 10 - iter 12/17 - loss 3.02024135 - samples/sec: 312.62 - lr: 0.250000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:30:39,401 epoch 10 - iter 13/17 - loss 3.02866225 - samples/sec: 301.38 - lr: 0.250000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:30:39,530 epoch 10 - iter 14/17 - loss 3.05385321 - samples/sec: 250.16 - lr: 0.250000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:30:39,644 epoch 10 - iter 15/17 - loss 3.06730847 - samples/sec: 283.84 - lr: 0.250000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:30:39,757 epoch 10 - iter 16/17 - loss 3.21189360 - samples/sec: 286.73 - lr: 0.250000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:30:39,832 epoch 10 - iter 17/17 - loss 3.28693191 - samples/sec: 432.01 - lr: 0.250000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:30:39,833 ----------------------------------------------------------------------------------------------------</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:30:39,838 EPOCH 10 done: loss 3.2869 - lr 0.2500000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:30:39,919 DEV : loss 2.621568202972412 - score 0.8878</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:30:39,921 BAD EPOCHS (no improvement): 2</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:30:39,923 ----------------------------------------------------------------------------------------------------</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:30:40,028 epoch 11 - iter 1/17 - loss 1.97674811 - samples/sec: 312.16 - lr: 0.250000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:30:40,146 epoch 11 - iter 2/17 - loss 2.63742667 - samples/sec: 273.63 - lr: 0.250000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:30:40,247 epoch 11 - iter 3/17 - loss 3.29801786 - samples/sec: 321.25 - lr: 0.250000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:30:40,365 epoch 11 - iter 4/17 - loss 3.60576668 - samples/sec: 272.73 - lr: 0.250000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:30:40,474 epoch 11 - iter 5/17 - loss 3.71707928 - samples/sec: 303.02 - lr: 0.250000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:30:40,589 epoch 11 - iter 6/17 - loss 3.40174667 - samples/sec: 281.19 - lr: 0.250000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:30:40,712 epoch 11 - iter 7/17 - loss 3.18708919 - samples/sec: 261.80 - lr: 0.250000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:30:40,826 epoch 11 - iter 8/17 - loss 3.04836126 - samples/sec: 287.11 - lr: 0.250000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:30:40,943 epoch 11 - iter 9/17 - loss 2.98250650 - samples/sec: 276.91 - lr: 0.250000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:30:41,058 epoch 11 - iter 10/17 - loss 2.92936121 - samples/sec: 282.13 - lr: 0.250000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:30:41,167 epoch 11 - iter 11/17 - loss 2.92226912 - samples/sec: 294.92 - lr: 0.250000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:30:41,281 epoch 11 - iter 12/17 - loss 2.89158462 - samples/sec: 285.59 - lr: 0.250000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:30:41,389 epoch 11 - iter 13/17 - loss 3.05706126 - samples/sec: 300.46 - lr: 0.250000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:30:41,497 epoch 11 - iter 14/17 - loss 3.01038414 - samples/sec: 304.51 - lr: 0.250000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:30:41,619 epoch 11 - iter 15/17 - loss 3.13056888 - samples/sec: 266.18 - lr: 0.250000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:30:41,749 epoch 11 - iter 16/17 - loss 3.20361467 - samples/sec: 248.63 - lr: 0.250000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:30:41,824 epoch 11 - iter 17/17 - loss 3.17225321 - samples/sec: 450.57 - lr: 0.250000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:30:41,825 ----------------------------------------------------------------------------------------------------</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:30:41,831 EPOCH 11 done: loss 3.1723 - lr 0.2500000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:30:41,909 DEV : loss 2.6496293544769287 - score 0.9175</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:30:41,911 BAD EPOCHS (no improvement): 0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">saving best model</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:30:44,727 ----------------------------------------------------------------------------------------------------</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:30:44,843 epoch 12 - iter 1/17 - loss 3.06218433 - samples/sec: 278.55 - lr: 0.250000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:30:44,962 epoch 12 - iter 2/17 - loss 2.53818643 - samples/sec: 273.01 - lr: 0.250000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:30:45,080 epoch 12 - iter 3/17 - loss 2.66141121 - samples/sec: 276.04 - lr: 0.250000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:30:45,196 epoch 12 - iter 4/17 - loss 2.73923683 - samples/sec: 278.75 - lr: 0.250000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:30:45,304 epoch 12 - iter 5/17 - loss 2.70134916 - samples/sec: 302.96 - lr: 0.250000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:30:45,411 epoch 12 - iter 6/17 - loss 2.47173454 - samples/sec: 301.51 - lr: 0.250000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:30:45,524 epoch 12 - iter 7/17 - loss 2.56464466 - samples/sec: 288.11 - lr: 0.250000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:30:45,638 epoch 12 - iter 8/17 - loss 2.83810382 - samples/sec: 284.02 - lr: 0.250000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:30:45,753 epoch 12 - iter 9/17 - loss 2.96720710 - samples/sec: 283.20 - lr: 0.250000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:30:45,863 epoch 12 - iter 10/17 - loss 3.00092806 - samples/sec: 293.61 - lr: 0.250000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:30:45,980 epoch 12 - iter 11/17 - loss 3.04209977 - samples/sec: 282.71 - lr: 0.250000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:30:46,103 epoch 12 - iter 12/17 - loss 3.06752718 - samples/sec: 261.65 - lr: 0.250000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:30:46,219 epoch 12 - iter 13/17 - loss 3.10638168 - samples/sec: 278.15 - lr: 0.250000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:30:46,325 epoch 12 - iter 14/17 - loss 3.11180851 - samples/sec: 307.11 - lr: 0.250000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:30:46,435 epoch 12 - iter 15/17 - loss 3.11393329 - samples/sec: 295.05 - lr: 0.250000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:30:46,563 epoch 12 - iter 16/17 - loss 3.17738984 - samples/sec: 251.88 - lr: 0.250000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:30:46,640 epoch 12 - iter 17/17 - loss 3.13963230 - samples/sec: 419.02 - lr: 0.250000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:30:46,642 ----------------------------------------------------------------------------------------------------</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:30:46,647 EPOCH 12 done: loss 3.1396 - lr 0.2500000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:30:46,753 DEV : loss 2.456434726715088 - score 0.8571</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:30:46,757 BAD EPOCHS (no improvement): 1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:30:46,759 ----------------------------------------------------------------------------------------------------</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:30:46,872 epoch 13 - iter 1/17 - loss 3.74742985 - samples/sec: 288.46 - lr: 0.250000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:30:46,978 epoch 13 - iter 2/17 - loss 3.21253848 - samples/sec: 306.03 - lr: 0.250000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:30:47,084 epoch 13 - iter 3/17 - loss 3.31751029 - samples/sec: 306.26 - lr: 0.250000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:30:47,192 epoch 13 - iter 4/17 - loss 2.90003487 - samples/sec: 298.68 - lr: 0.250000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:30:47,310 epoch 13 - iter 5/17 - loss 2.77682316 - samples/sec: 274.49 - lr: 0.250000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:30:47,423 epoch 13 - iter 6/17 - loss 2.92825923 - samples/sec: 284.24 - lr: 0.250000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:30:47,535 epoch 13 - iter 7/17 - loss 2.93475987 - samples/sec: 290.65 - lr: 0.250000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:30:47,660 epoch 13 - iter 8/17 - loss 3.03747167 - samples/sec: 258.99 - lr: 0.250000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:30:47,782 epoch 13 - iter 9/17 - loss 3.01528635 - samples/sec: 265.17 - lr: 0.250000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:30:47,887 epoch 13 - iter 10/17 - loss 3.02738467 - samples/sec: 308.06 - lr: 0.250000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:30:47,995 epoch 13 - iter 11/17 - loss 3.00082893 - samples/sec: 297.64 - lr: 0.250000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:30:48,106 epoch 13 - iter 12/17 - loss 3.03533484 - samples/sec: 298.56 - lr: 0.250000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:30:48,214 epoch 13 - iter 13/17 - loss 2.99576386 - samples/sec: 299.72 - lr: 0.250000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:30:48,320 epoch 13 - iter 14/17 - loss 2.99190849 - samples/sec: 304.07 - lr: 0.250000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:30:48,430 epoch 13 - iter 15/17 - loss 3.02248323 - samples/sec: 293.57 - lr: 0.250000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:30:48,539 epoch 13 - iter 16/17 - loss 3.00460766 - samples/sec: 297.44 - lr: 0.250000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:30:48,619 epoch 13 - iter 17/17 - loss 2.95338992 - samples/sec: 409.80 - lr: 0.250000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:30:48,620 ----------------------------------------------------------------------------------------------------</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:30:48,626 EPOCH 13 done: loss 2.9534 - lr 0.2500000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:30:48,702 DEV : loss 2.8066673278808594 - score 0.8548</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:30:48,704 BAD EPOCHS (no improvement): 2</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:30:48,705 ----------------------------------------------------------------------------------------------------</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:30:48,833 epoch 14 - iter 1/17 - loss 2.78732395 - samples/sec: 257.25 - lr: 0.250000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:30:48,945 epoch 14 - iter 2/17 - loss 2.74681008 - samples/sec: 288.53 - lr: 0.250000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:30:49,061 epoch 14 - iter 3/17 - loss 2.75188263 - samples/sec: 278.90 - lr: 0.250000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:30:49,182 epoch 14 - iter 4/17 - loss 2.79956216 - samples/sec: 266.16 - lr: 0.250000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:30:49,289 epoch 14 - iter 5/17 - loss 2.81255398 - samples/sec: 303.61 - lr: 0.250000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:30:49,399 epoch 14 - iter 6/17 - loss 2.67327150 - samples/sec: 293.32 - lr: 0.250000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:30:49,509 epoch 14 - iter 7/17 - loss 2.64780256 - samples/sec: 296.43 - lr: 0.250000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:30:49,626 epoch 14 - iter 8/17 - loss 2.89155030 - samples/sec: 274.99 - lr: 0.250000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:30:49,732 epoch 14 - iter 9/17 - loss 2.80368842 - samples/sec: 304.67 - lr: 0.250000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:30:49,848 epoch 14 - iter 10/17 - loss 3.01142316 - samples/sec: 280.74 - lr: 0.250000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:30:49,969 epoch 14 - iter 11/17 - loss 3.08519667 - samples/sec: 266.39 - lr: 0.250000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:30:50,095 epoch 14 - iter 12/17 - loss 3.10426335 - samples/sec: 257.15 - lr: 0.250000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:30:50,209 epoch 14 - iter 13/17 - loss 3.06903934 - samples/sec: 282.02 - lr: 0.250000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:30:50,324 epoch 14 - iter 14/17 - loss 3.03085591 - samples/sec: 295.41 - lr: 0.250000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:30:50,424 epoch 14 - iter 15/17 - loss 3.02578127 - samples/sec: 321.50 - lr: 0.250000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:30:50,545 epoch 14 - iter 16/17 - loss 2.98861359 - samples/sec: 267.74 - lr: 0.250000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:30:50,625 epoch 14 - iter 17/17 - loss 3.04630093 - samples/sec: 407.75 - lr: 0.250000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:30:50,626 ----------------------------------------------------------------------------------------------------</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:30:50,630 EPOCH 14 done: loss 3.0463 - lr 0.2500000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:30:50,726 DEV : loss 2.356717109680176 - score 0.9039</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:30:50,730 BAD EPOCHS (no improvement): 3</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:30:50,732 ----------------------------------------------------------------------------------------------------</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:30:50,868 epoch 15 - iter 1/17 - loss 4.18320131 - samples/sec: 237.43 - lr: 0.250000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:30:50,981 epoch 15 - iter 2/17 - loss 3.43749928 - samples/sec: 287.59 - lr: 0.250000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:30:51,089 epoch 15 - iter 3/17 - loss 3.32088296 - samples/sec: 302.31 - lr: 0.250000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:30:51,195 epoch 15 - iter 4/17 - loss 3.32438457 - samples/sec: 303.65 - lr: 0.250000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:30:51,317 epoch 15 - iter 5/17 - loss 3.04261053 - samples/sec: 265.50 - lr: 0.250000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:30:51,431 epoch 15 - iter 6/17 - loss 3.01294063 - samples/sec: 284.89 - lr: 0.250000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:30:51,547 epoch 15 - iter 7/17 - loss 3.07561300 - samples/sec: 279.72 - lr: 0.250000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:30:51,650 epoch 15 - iter 8/17 - loss 3.14126436 - samples/sec: 312.54 - lr: 0.250000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:30:51,755 epoch 15 - iter 9/17 - loss 3.12974224 - samples/sec: 311.04 - lr: 0.250000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:30:51,872 epoch 15 - iter 10/17 - loss 3.00686265 - samples/sec: 280.14 - lr: 0.250000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:30:51,984 epoch 15 - iter 11/17 - loss 3.00323490 - samples/sec: 288.18 - lr: 0.250000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:30:52,091 epoch 15 - iter 12/17 - loss 2.97433997 - samples/sec: 302.88 - lr: 0.250000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:30:52,203 epoch 15 - iter 13/17 - loss 2.99207349 - samples/sec: 290.19 - lr: 0.250000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:30:52,333 epoch 15 - iter 14/17 - loss 2.94220261 - samples/sec: 249.46 - lr: 0.250000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:30:52,447 epoch 15 - iter 15/17 - loss 2.89441790 - samples/sec: 283.54 - lr: 0.250000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:30:52,554 epoch 15 - iter 16/17 - loss 2.89061851 - samples/sec: 302.51 - lr: 0.250000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:30:52,632 epoch 15 - iter 17/17 - loss 2.86109092 - samples/sec: 415.69 - lr: 0.250000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:30:52,634 ----------------------------------------------------------------------------------------------------</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:30:52,637 EPOCH 15 done: loss 2.8611 - lr 0.2500000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:30:52,715 DEV : loss 2.2419240474700928 - score 0.8964</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Epoch    15: reducing learning rate of group 0 to 1.2500e-01.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:30:52,719 BAD EPOCHS (no improvement): 4</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:30:52,720 ----------------------------------------------------------------------------------------------------</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:30:52,835 epoch 16 - iter 1/17 - loss 3.22716141 - samples/sec: 281.04 - lr: 0.125000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:30:52,945 epoch 16 - iter 2/17 - loss 2.45503211 - samples/sec: 296.44 - lr: 0.125000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:30:53,049 epoch 16 - iter 3/17 - loss 2.48855003 - samples/sec: 323.45 - lr: 0.125000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:30:53,154 epoch 16 - iter 4/17 - loss 2.59882224 - samples/sec: 307.89 - lr: 0.125000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:30:53,269 epoch 16 - iter 5/17 - loss 2.60306301 - samples/sec: 281.55 - lr: 0.125000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:30:53,382 epoch 16 - iter 6/17 - loss 2.49932460 - samples/sec: 286.07 - lr: 0.125000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:30:53,488 epoch 16 - iter 7/17 - loss 2.50845940 - samples/sec: 305.77 - lr: 0.125000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:30:53,596 epoch 16 - iter 8/17 - loss 2.45025101 - samples/sec: 299.80 - lr: 0.125000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:30:53,706 epoch 16 - iter 9/17 - loss 2.47416223 - samples/sec: 296.94 - lr: 0.125000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:30:53,842 epoch 16 - iter 10/17 - loss 2.48455787 - samples/sec: 237.17 - lr: 0.125000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:30:53,951 epoch 16 - iter 11/17 - loss 2.49519675 - samples/sec: 297.89 - lr: 0.125000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:30:54,074 epoch 16 - iter 12/17 - loss 2.41682629 - samples/sec: 262.08 - lr: 0.125000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:30:54,179 epoch 16 - iter 13/17 - loss 2.43769492 - samples/sec: 310.28 - lr: 0.125000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:30:54,297 epoch 16 - iter 14/17 - loss 2.46912466 - samples/sec: 274.40 - lr: 0.125000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:30:54,410 epoch 16 - iter 15/17 - loss 2.47079910 - samples/sec: 285.36 - lr: 0.125000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:30:54,521 epoch 16 - iter 16/17 - loss 2.49755961 - samples/sec: 292.36 - lr: 0.125000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:30:54,597 epoch 16 - iter 17/17 - loss 2.52624600 - samples/sec: 426.15 - lr: 0.125000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:30:54,598 ----------------------------------------------------------------------------------------------------</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:30:54,600 EPOCH 16 done: loss 2.5262 - lr 0.1250000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:30:54,681 DEV : loss 2.1843576431274414 - score 0.8964</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:30:54,684 BAD EPOCHS (no improvement): 1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:30:54,686 ----------------------------------------------------------------------------------------------------</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:30:54,806 epoch 17 - iter 1/17 - loss 2.76969957 - samples/sec: 270.53 - lr: 0.125000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:30:54,922 epoch 17 - iter 2/17 - loss 2.50936592 - samples/sec: 280.56 - lr: 0.125000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:30:55,046 epoch 17 - iter 3/17 - loss 2.33596226 - samples/sec: 258.96 - lr: 0.125000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:30:55,162 epoch 17 - iter 4/17 - loss 2.50554565 - samples/sec: 279.75 - lr: 0.125000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:30:55,265 epoch 17 - iter 5/17 - loss 2.27989476 - samples/sec: 316.59 - lr: 0.125000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:30:55,383 epoch 17 - iter 6/17 - loss 2.29474705 - samples/sec: 274.08 - lr: 0.125000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:30:55,494 epoch 17 - iter 7/17 - loss 2.42519081 - samples/sec: 290.64 - lr: 0.125000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:30:55,600 epoch 17 - iter 8/17 - loss 2.52284651 - samples/sec: 303.65 - lr: 0.125000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:30:55,702 epoch 17 - iter 9/17 - loss 2.41699484 - samples/sec: 318.36 - lr: 0.125000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:30:55,808 epoch 17 - iter 10/17 - loss 2.39273806 - samples/sec: 303.67 - lr: 0.125000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:30:55,944 epoch 17 - iter 11/17 - loss 2.39208945 - samples/sec: 238.63 - lr: 0.125000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:30:56,054 epoch 17 - iter 12/17 - loss 2.32023218 - samples/sec: 293.26 - lr: 0.125000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:30:56,160 epoch 17 - iter 13/17 - loss 2.35094486 - samples/sec: 305.68 - lr: 0.125000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:30:56,270 epoch 17 - iter 14/17 - loss 2.42827324 - samples/sec: 296.42 - lr: 0.125000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:30:56,396 epoch 17 - iter 15/17 - loss 2.45238497 - samples/sec: 257.97 - lr: 0.125000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:30:56,507 epoch 17 - iter 16/17 - loss 2.39506280 - samples/sec: 292.19 - lr: 0.125000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:30:56,584 epoch 17 - iter 17/17 - loss 2.49167655 - samples/sec: 422.23 - lr: 0.125000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:30:56,585 ----------------------------------------------------------------------------------------------------</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:30:56,590 EPOCH 17 done: loss 2.4917 - lr 0.1250000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:30:56,669 DEV : loss 2.249250888824463 - score 0.8912</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:30:56,672 BAD EPOCHS (no improvement): 2</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:30:56,674 ----------------------------------------------------------------------------------------------------</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:30:56,786 epoch 18 - iter 1/17 - loss 1.70234942 - samples/sec: 297.37 - lr: 0.125000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:30:56,888 epoch 18 - iter 2/17 - loss 1.85333061 - samples/sec: 315.17 - lr: 0.125000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:30:56,998 epoch 18 - iter 3/17 - loss 1.89275738 - samples/sec: 294.29 - lr: 0.125000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:30:57,114 epoch 18 - iter 4/17 - loss 1.86746427 - samples/sec: 278.81 - lr: 0.125000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:30:57,222 epoch 18 - iter 5/17 - loss 2.20966289 - samples/sec: 299.47 - lr: 0.125000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:30:57,332 epoch 18 - iter 6/17 - loss 2.16520981 - samples/sec: 293.48 - lr: 0.125000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:30:57,443 epoch 18 - iter 7/17 - loss 2.11290937 - samples/sec: 292.71 - lr: 0.125000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:30:57,543 epoch 18 - iter 8/17 - loss 2.15310632 - samples/sec: 325.15 - lr: 0.125000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:30:57,652 epoch 18 - iter 9/17 - loss 2.18450381 - samples/sec: 296.34 - lr: 0.125000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:30:57,766 epoch 18 - iter 10/17 - loss 2.19876078 - samples/sec: 282.87 - lr: 0.125000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:30:57,908 epoch 18 - iter 11/17 - loss 2.24738829 - samples/sec: 228.46 - lr: 0.125000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:30:58,022 epoch 18 - iter 12/17 - loss 2.29583320 - samples/sec: 283.50 - lr: 0.125000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:30:58,126 epoch 18 - iter 13/17 - loss 2.42597394 - samples/sec: 310.80 - lr: 0.125000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:30:58,225 epoch 18 - iter 14/17 - loss 2.40854189 - samples/sec: 326.30 - lr: 0.125000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:30:58,330 epoch 18 - iter 15/17 - loss 2.55437588 - samples/sec: 307.40 - lr: 0.125000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:30:58,442 epoch 18 - iter 16/17 - loss 2.60625351 - samples/sec: 289.05 - lr: 0.125000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:30:58,514 epoch 18 - iter 17/17 - loss 2.60324173 - samples/sec: 452.42 - lr: 0.125000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:30:58,515 ----------------------------------------------------------------------------------------------------</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:30:58,519 EPOCH 18 done: loss 2.6032 - lr 0.1250000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:30:58,605 DEV : loss 2.1045773029327393 - score 0.8901</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:30:58,608 BAD EPOCHS (no improvement): 3</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:30:58,610 ----------------------------------------------------------------------------------------------------</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:30:58,727 epoch 19 - iter 1/17 - loss 2.05735612 - samples/sec: 278.66 - lr: 0.125000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:30:58,847 epoch 19 - iter 2/17 - loss 2.11045420 - samples/sec: 269.04 - lr: 0.125000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:30:58,974 epoch 19 - iter 3/17 - loss 2.07742627 - samples/sec: 254.10 - lr: 0.125000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:30:59,084 epoch 19 - iter 4/17 - loss 2.27933270 - samples/sec: 295.28 - lr: 0.125000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:30:59,190 epoch 19 - iter 5/17 - loss 2.52328839 - samples/sec: 303.98 - lr: 0.125000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:30:59,299 epoch 19 - iter 6/17 - loss 2.53958567 - samples/sec: 303.08 - lr: 0.125000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:30:59,415 epoch 19 - iter 7/17 - loss 2.43096699 - samples/sec: 280.08 - lr: 0.125000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:30:59,519 epoch 19 - iter 8/17 - loss 2.36722346 - samples/sec: 310.25 - lr: 0.125000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:30:59,625 epoch 19 - iter 9/17 - loss 2.32014529 - samples/sec: 305.11 - lr: 0.125000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:30:59,733 epoch 19 - iter 10/17 - loss 2.40720191 - samples/sec: 301.33 - lr: 0.125000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:30:59,859 epoch 19 - iter 11/17 - loss 2.39145192 - samples/sec: 255.91 - lr: 0.125000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:30:59,974 epoch 19 - iter 12/17 - loss 2.35232800 - samples/sec: 281.75 - lr: 0.125000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:00,092 epoch 19 - iter 13/17 - loss 2.34161122 - samples/sec: 280.33 - lr: 0.125000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:00,202 epoch 19 - iter 14/17 - loss 2.39985812 - samples/sec: 291.89 - lr: 0.125000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:00,315 epoch 19 - iter 15/17 - loss 2.34814619 - samples/sec: 289.62 - lr: 0.125000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:00,447 epoch 19 - iter 16/17 - loss 2.40359858 - samples/sec: 245.59 - lr: 0.125000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:00,524 epoch 19 - iter 17/17 - loss 2.37741771 - samples/sec: 445.32 - lr: 0.125000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:00,525 ----------------------------------------------------------------------------------------------------</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:00,530 EPOCH 19 done: loss 2.3774 - lr 0.1250000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:00,607 DEV : loss 1.987985372543335 - score 0.9039</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Epoch    19: reducing learning rate of group 0 to 6.2500e-02.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:00,611 BAD EPOCHS (no improvement): 4</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:00,614 ----------------------------------------------------------------------------------------------------</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:00,726 epoch 20 - iter 1/17 - loss 1.71020281 - samples/sec: 296.47 - lr: 0.062500</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:00,832 epoch 20 - iter 2/17 - loss 2.09335452 - samples/sec: 305.37 - lr: 0.062500</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:00,942 epoch 20 - iter 3/17 - loss 2.28337387 - samples/sec: 293.37 - lr: 0.062500</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:01,055 epoch 20 - iter 4/17 - loss 2.47729316 - samples/sec: 284.93 - lr: 0.062500</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:01,159 epoch 20 - iter 5/17 - loss 2.56094611 - samples/sec: 314.81 - lr: 0.062500</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:01,257 epoch 20 - iter 6/17 - loss 2.50572254 - samples/sec: 328.52 - lr: 0.062500</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:01,380 epoch 20 - iter 7/17 - loss 2.47985882 - samples/sec: 262.47 - lr: 0.062500</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:01,495 epoch 20 - iter 8/17 - loss 2.40888305 - samples/sec: 281.91 - lr: 0.062500</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:01,597 epoch 20 - iter 9/17 - loss 2.43964536 - samples/sec: 320.29 - lr: 0.062500</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:01,718 epoch 20 - iter 10/17 - loss 2.36184093 - samples/sec: 266.20 - lr: 0.062500</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:01,834 epoch 20 - iter 11/17 - loss 2.33077885 - samples/sec: 277.68 - lr: 0.062500</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:01,945 epoch 20 - iter 12/17 - loss 2.31888257 - samples/sec: 291.73 - lr: 0.062500</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:02,060 epoch 20 - iter 13/17 - loss 2.30530426 - samples/sec: 281.27 - lr: 0.062500</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:02,163 epoch 20 - iter 14/17 - loss 2.32191645 - samples/sec: 314.84 - lr: 0.062500</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:02,267 epoch 20 - iter 15/17 - loss 2.34071354 - samples/sec: 309.11 - lr: 0.062500</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:02,367 epoch 20 - iter 16/17 - loss 2.40924118 - samples/sec: 325.52 - lr: 0.062500</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:02,444 epoch 20 - iter 17/17 - loss 2.38642045 - samples/sec: 422.96 - lr: 0.062500</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:02,445 ----------------------------------------------------------------------------------------------------</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:02,449 EPOCH 20 done: loss 2.3864 - lr 0.0625000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:02,524 DEV : loss 2.02628755569458 - score 0.9039</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:02,526 BAD EPOCHS (no improvement): 1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:02,531 ----------------------------------------------------------------------------------------------------</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:02,634 epoch 21 - iter 1/17 - loss 2.01805162 - samples/sec: 313.46 - lr: 0.062500</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:02,740 epoch 21 - iter 2/17 - loss 1.95761949 - samples/sec: 307.95 - lr: 0.062500</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:02,865 epoch 21 - iter 3/17 - loss 2.05638238 - samples/sec: 257.24 - lr: 0.062500</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:02,986 epoch 21 - iter 4/17 - loss 2.24450067 - samples/sec: 268.72 - lr: 0.062500</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:03,099 epoch 21 - iter 5/17 - loss 2.27903502 - samples/sec: 285.77 - lr: 0.062500</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:03,203 epoch 21 - iter 6/17 - loss 2.38084318 - samples/sec: 308.65 - lr: 0.062500</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:03,310 epoch 21 - iter 7/17 - loss 2.30562082 - samples/sec: 303.05 - lr: 0.062500</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:03,444 epoch 21 - iter 8/17 - loss 2.33702309 - samples/sec: 240.19 - lr: 0.062500</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:03,550 epoch 21 - iter 9/17 - loss 2.24217778 - samples/sec: 309.72 - lr: 0.062500</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:03,652 epoch 21 - iter 10/17 - loss 2.26832607 - samples/sec: 316.97 - lr: 0.062500</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:03,762 epoch 21 - iter 11/17 - loss 2.26648381 - samples/sec: 294.96 - lr: 0.062500</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:03,867 epoch 21 - iter 12/17 - loss 2.28058559 - samples/sec: 307.86 - lr: 0.062500</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:03,976 epoch 21 - iter 13/17 - loss 2.25714514 - samples/sec: 296.97 - lr: 0.062500</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:04,091 epoch 21 - iter 14/17 - loss 2.23559930 - samples/sec: 281.10 - lr: 0.062500</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:04,206 epoch 21 - iter 15/17 - loss 2.27486047 - samples/sec: 283.20 - lr: 0.062500</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:04,312 epoch 21 - iter 16/17 - loss 2.25765611 - samples/sec: 310.23 - lr: 0.062500</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:04,382 epoch 21 - iter 17/17 - loss 2.24482668 - samples/sec: 463.98 - lr: 0.062500</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:04,383 ----------------------------------------------------------------------------------------------------</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:04,389 EPOCH 21 done: loss 2.2448 - lr 0.0625000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:04,476 DEV : loss 1.9274215698242188 - score 0.9039</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:04,479 BAD EPOCHS (no improvement): 2</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:04,482 ----------------------------------------------------------------------------------------------------</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:04,591 epoch 22 - iter 1/17 - loss 2.05779243 - samples/sec: 299.29 - lr: 0.062500</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:04,712 epoch 22 - iter 2/17 - loss 2.54358244 - samples/sec: 267.17 - lr: 0.062500</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:04,843 epoch 22 - iter 3/17 - loss 2.38451076 - samples/sec: 246.03 - lr: 0.062500</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:04,950 epoch 22 - iter 4/17 - loss 2.44637775 - samples/sec: 303.17 - lr: 0.062500</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:05,057 epoch 22 - iter 5/17 - loss 2.30466504 - samples/sec: 302.91 - lr: 0.062500</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:05,178 epoch 22 - iter 6/17 - loss 2.26858521 - samples/sec: 266.10 - lr: 0.062500</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:05,277 epoch 22 - iter 7/17 - loss 2.12332932 - samples/sec: 328.32 - lr: 0.062500</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:05,377 epoch 22 - iter 8/17 - loss 2.16235070 - samples/sec: 321.38 - lr: 0.062500</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:05,507 epoch 22 - iter 9/17 - loss 2.22368626 - samples/sec: 253.23 - lr: 0.062500</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:05,611 epoch 22 - iter 10/17 - loss 2.20117749 - samples/sec: 310.81 - lr: 0.062500</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:05,711 epoch 22 - iter 11/17 - loss 2.23854591 - samples/sec: 323.73 - lr: 0.062500</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:05,832 epoch 22 - iter 12/17 - loss 2.23895742 - samples/sec: 264.75 - lr: 0.062500</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:05,976 epoch 22 - iter 13/17 - loss 2.28941275 - samples/sec: 224.52 - lr: 0.062500</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:06,084 epoch 22 - iter 14/17 - loss 2.28183858 - samples/sec: 302.04 - lr: 0.062500</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:06,196 epoch 22 - iter 15/17 - loss 2.27302086 - samples/sec: 286.23 - lr: 0.062500</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:06,309 epoch 22 - iter 16/17 - loss 2.25989293 - samples/sec: 287.92 - lr: 0.062500</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:06,386 epoch 22 - iter 17/17 - loss 2.19085824 - samples/sec: 419.62 - lr: 0.062500</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:06,388 ----------------------------------------------------------------------------------------------------</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:06,393 EPOCH 22 done: loss 2.1909 - lr 0.0625000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:06,480 DEV : loss 1.9331698417663574 - score 0.9039</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:06,484 BAD EPOCHS (no improvement): 3</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:06,486 ----------------------------------------------------------------------------------------------------</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:06,601 epoch 23 - iter 1/17 - loss 1.70134401 - samples/sec: 283.94 - lr: 0.062500</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:06,711 epoch 23 - iter 2/17 - loss 2.13410854 - samples/sec: 299.57 - lr: 0.062500</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:06,818 epoch 23 - iter 3/17 - loss 2.12737036 - samples/sec: 301.17 - lr: 0.062500</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:06,945 epoch 23 - iter 4/17 - loss 2.07283798 - samples/sec: 254.23 - lr: 0.062500</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:07,062 epoch 23 - iter 5/17 - loss 2.13042910 - samples/sec: 277.10 - lr: 0.062500</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:07,180 epoch 23 - iter 6/17 - loss 2.22374584 - samples/sec: 273.38 - lr: 0.062500</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:07,293 epoch 23 - iter 7/17 - loss 2.24066106 - samples/sec: 285.75 - lr: 0.062500</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:07,402 epoch 23 - iter 8/17 - loss 2.25720285 - samples/sec: 298.11 - lr: 0.062500</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:07,520 epoch 23 - iter 9/17 - loss 2.20347146 - samples/sec: 273.03 - lr: 0.062500</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:07,633 epoch 23 - iter 10/17 - loss 2.24449781 - samples/sec: 285.70 - lr: 0.062500</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:07,744 epoch 23 - iter 11/17 - loss 2.31409958 - samples/sec: 292.72 - lr: 0.062500</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:07,860 epoch 23 - iter 12/17 - loss 2.29987424 - samples/sec: 279.58 - lr: 0.062500</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:07,986 epoch 23 - iter 13/17 - loss 2.30229404 - samples/sec: 255.65 - lr: 0.062500</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:08,088 epoch 23 - iter 14/17 - loss 2.32035975 - samples/sec: 317.76 - lr: 0.062500</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:08,205 epoch 23 - iter 15/17 - loss 2.29056011 - samples/sec: 275.83 - lr: 0.062500</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:08,321 epoch 23 - iter 16/17 - loss 2.27713012 - samples/sec: 280.00 - lr: 0.062500</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:08,399 epoch 23 - iter 17/17 - loss 2.26789435 - samples/sec: 413.97 - lr: 0.062500</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:08,401 ----------------------------------------------------------------------------------------------------</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:08,406 EPOCH 23 done: loss 2.2679 - lr 0.0625000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:08,484 DEV : loss 1.9181852340698242 - score 0.9039</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Epoch    23: reducing learning rate of group 0 to 3.1250e-02.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:08,489 BAD EPOCHS (no improvement): 4</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:08,490 ----------------------------------------------------------------------------------------------------</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:08,603 epoch 24 - iter 1/17 - loss 2.76224279 - samples/sec: 300.34 - lr: 0.031250</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:08,713 epoch 24 - iter 2/17 - loss 2.52293849 - samples/sec: 293.60 - lr: 0.031250</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:08,826 epoch 24 - iter 3/17 - loss 2.32014473 - samples/sec: 285.65 - lr: 0.031250</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:08,939 epoch 24 - iter 4/17 - loss 2.27968848 - samples/sec: 288.03 - lr: 0.031250</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:09,047 epoch 24 - iter 5/17 - loss 2.19507091 - samples/sec: 300.27 - lr: 0.031250</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:09,143 epoch 24 - iter 6/17 - loss 2.15499967 - samples/sec: 335.25 - lr: 0.031250</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:09,262 epoch 24 - iter 7/17 - loss 2.34728897 - samples/sec: 271.65 - lr: 0.031250</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:09,371 epoch 24 - iter 8/17 - loss 2.23135819 - samples/sec: 297.18 - lr: 0.031250</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:09,487 epoch 24 - iter 9/17 - loss 2.35803510 - samples/sec: 279.54 - lr: 0.031250</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:09,603 epoch 24 - iter 10/17 - loss 2.30058753 - samples/sec: 279.13 - lr: 0.031250</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:09,719 epoch 24 - iter 11/17 - loss 2.25945546 - samples/sec: 280.01 - lr: 0.031250</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:09,835 epoch 24 - iter 12/17 - loss 2.27051020 - samples/sec: 278.96 - lr: 0.031250</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:09,945 epoch 24 - iter 13/17 - loss 2.23163500 - samples/sec: 292.98 - lr: 0.031250</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:10,057 epoch 24 - iter 14/17 - loss 2.25586351 - samples/sec: 290.07 - lr: 0.031250</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:10,167 epoch 24 - iter 15/17 - loss 2.26975231 - samples/sec: 291.75 - lr: 0.031250</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:10,284 epoch 24 - iter 16/17 - loss 2.23412069 - samples/sec: 278.97 - lr: 0.031250</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:10,378 epoch 24 - iter 17/17 - loss 2.21847627 - samples/sec: 346.19 - lr: 0.031250</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:10,379 ----------------------------------------------------------------------------------------------------</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:10,385 EPOCH 24 done: loss 2.2185 - lr 0.0312500</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:10,464 DEV : loss 1.9145869016647339 - score 0.9039</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:10,467 BAD EPOCHS (no improvement): 1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:10,469 ----------------------------------------------------------------------------------------------------</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:10,576 epoch 25 - iter 1/17 - loss 2.68180037 - samples/sec: 308.77 - lr: 0.031250</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:10,701 epoch 25 - iter 2/17 - loss 2.58654761 - samples/sec: 259.33 - lr: 0.031250</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:10,806 epoch 25 - iter 3/17 - loss 2.54156987 - samples/sec: 306.55 - lr: 0.031250</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:10,922 epoch 25 - iter 4/17 - loss 2.45042753 - samples/sec: 278.73 - lr: 0.031250</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:11,030 epoch 25 - iter 5/17 - loss 2.37050085 - samples/sec: 300.68 - lr: 0.031250</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:11,131 epoch 25 - iter 6/17 - loss 2.17418148 - samples/sec: 320.10 - lr: 0.031250</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:11,238 epoch 25 - iter 7/17 - loss 2.03742301 - samples/sec: 303.48 - lr: 0.031250</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:11,349 epoch 25 - iter 8/17 - loss 2.02971898 - samples/sec: 293.46 - lr: 0.031250</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:11,475 epoch 25 - iter 9/17 - loss 1.98951248 - samples/sec: 257.54 - lr: 0.031250</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:11,590 epoch 25 - iter 10/17 - loss 2.04102901 - samples/sec: 279.25 - lr: 0.031250</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:11,702 epoch 25 - iter 11/17 - loss 2.12209180 - samples/sec: 289.60 - lr: 0.031250</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:11,808 epoch 25 - iter 12/17 - loss 2.12565103 - samples/sec: 307.27 - lr: 0.031250</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:11,916 epoch 25 - iter 13/17 - loss 2.21383809 - samples/sec: 301.98 - lr: 0.031250</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:12,021 epoch 25 - iter 14/17 - loss 2.22879870 - samples/sec: 308.28 - lr: 0.031250</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:12,143 epoch 25 - iter 15/17 - loss 2.25462717 - samples/sec: 265.38 - lr: 0.031250</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:12,261 epoch 25 - iter 16/17 - loss 2.24462736 - samples/sec: 273.45 - lr: 0.031250</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:12,339 epoch 25 - iter 17/17 - loss 2.26452670 - samples/sec: 422.20 - lr: 0.031250</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:12,340 ----------------------------------------------------------------------------------------------------</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:12,342 EPOCH 25 done: loss 2.2645 - lr 0.0312500</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:12,425 DEV : loss 1.8926992416381836 - score 0.9039</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:12,429 BAD EPOCHS (no improvement): 2</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:12,431 ----------------------------------------------------------------------------------------------------</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:12,547 epoch 26 - iter 1/17 - loss 1.52716124 - samples/sec: 279.51 - lr: 0.031250</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:12,670 epoch 26 - iter 2/17 - loss 1.83199435 - samples/sec: 264.82 - lr: 0.031250</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:12,783 epoch 26 - iter 3/17 - loss 1.96283241 - samples/sec: 291.04 - lr: 0.031250</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:12,890 epoch 26 - iter 4/17 - loss 1.96469370 - samples/sec: 304.40 - lr: 0.031250</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:13,001 epoch 26 - iter 5/17 - loss 2.03075287 - samples/sec: 290.77 - lr: 0.031250</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:13,114 epoch 26 - iter 6/17 - loss 2.18692909 - samples/sec: 286.41 - lr: 0.031250</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:13,238 epoch 26 - iter 7/17 - loss 2.29399492 - samples/sec: 261.06 - lr: 0.031250</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:13,359 epoch 26 - iter 8/17 - loss 2.21845753 - samples/sec: 266.94 - lr: 0.031250</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:13,465 epoch 26 - iter 9/17 - loss 2.27986459 - samples/sec: 304.67 - lr: 0.031250</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:13,574 epoch 26 - iter 10/17 - loss 2.31232477 - samples/sec: 297.41 - lr: 0.031250</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:13,690 epoch 26 - iter 11/17 - loss 2.29177281 - samples/sec: 282.18 - lr: 0.031250</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:13,811 epoch 26 - iter 12/17 - loss 2.25202786 - samples/sec: 267.51 - lr: 0.031250</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:13,918 epoch 26 - iter 13/17 - loss 2.21773954 - samples/sec: 302.48 - lr: 0.031250</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:14,029 epoch 26 - iter 14/17 - loss 2.19228974 - samples/sec: 290.48 - lr: 0.031250</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:14,140 epoch 26 - iter 15/17 - loss 2.16736569 - samples/sec: 292.30 - lr: 0.031250</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:14,245 epoch 26 - iter 16/17 - loss 2.16703309 - samples/sec: 307.62 - lr: 0.031250</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:14,336 epoch 26 - iter 17/17 - loss 2.20482035 - samples/sec: 355.35 - lr: 0.031250</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:14,337 ----------------------------------------------------------------------------------------------------</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:14,339 EPOCH 26 done: loss 2.2048 - lr 0.0312500</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:14,418 DEV : loss 1.829909324645996 - score 0.9039</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:14,420 BAD EPOCHS (no improvement): 3</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:14,423 ----------------------------------------------------------------------------------------------------</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:14,535 epoch 27 - iter 1/17 - loss 2.94158649 - samples/sec: 289.52 - lr: 0.031250</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:14,650 epoch 27 - iter 2/17 - loss 2.31759334 - samples/sec: 279.59 - lr: 0.031250</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:14,769 epoch 27 - iter 3/17 - loss 2.34357309 - samples/sec: 274.76 - lr: 0.031250</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:14,901 epoch 27 - iter 4/17 - loss 2.31417656 - samples/sec: 252.17 - lr: 0.031250</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:15,019 epoch 27 - iter 5/17 - loss 2.19485738 - samples/sec: 274.71 - lr: 0.031250</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:15,131 epoch 27 - iter 6/17 - loss 2.24387747 - samples/sec: 289.75 - lr: 0.031250</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:15,248 epoch 27 - iter 7/17 - loss 2.31949151 - samples/sec: 276.19 - lr: 0.031250</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:15,372 epoch 27 - iter 8/17 - loss 2.27232495 - samples/sec: 261.82 - lr: 0.031250</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:15,501 epoch 27 - iter 9/17 - loss 2.23626822 - samples/sec: 251.21 - lr: 0.031250</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:15,634 epoch 27 - iter 10/17 - loss 2.19940158 - samples/sec: 243.44 - lr: 0.031250</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:15,745 epoch 27 - iter 11/17 - loss 2.25831646 - samples/sec: 289.98 - lr: 0.031250</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:15,860 epoch 27 - iter 12/17 - loss 2.20441757 - samples/sec: 286.89 - lr: 0.031250</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:15,971 epoch 27 - iter 13/17 - loss 2.22872842 - samples/sec: 297.65 - lr: 0.031250</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:16,081 epoch 27 - iter 14/17 - loss 2.20987686 - samples/sec: 292.10 - lr: 0.031250</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:16,191 epoch 27 - iter 15/17 - loss 2.19334530 - samples/sec: 295.28 - lr: 0.031250</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:16,299 epoch 27 - iter 16/17 - loss 2.17026734 - samples/sec: 297.75 - lr: 0.031250</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:16,393 epoch 27 - iter 17/17 - loss 2.12320886 - samples/sec: 344.81 - lr: 0.031250</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:16,394 ----------------------------------------------------------------------------------------------------</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:16,396 EPOCH 27 done: loss 2.1232 - lr 0.0312500</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:16,477 DEV : loss 1.877849817276001 - score 0.9039</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Epoch    27: reducing learning rate of group 0 to 1.5625e-02.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:16,480 BAD EPOCHS (no improvement): 4</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:16,482 ----------------------------------------------------------------------------------------------------</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:16,598 epoch 28 - iter 1/17 - loss 1.15935516 - samples/sec: 281.50 - lr: 0.015625</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:16,730 epoch 28 - iter 2/17 - loss 1.71386480 - samples/sec: 244.95 - lr: 0.015625</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:16,843 epoch 28 - iter 3/17 - loss 1.80357365 - samples/sec: 288.82 - lr: 0.015625</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:16,953 epoch 28 - iter 4/17 - loss 1.88561693 - samples/sec: 293.88 - lr: 0.015625</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:17,069 epoch 28 - iter 5/17 - loss 1.87196920 - samples/sec: 280.24 - lr: 0.015625</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:17,191 epoch 28 - iter 6/17 - loss 1.89888237 - samples/sec: 264.96 - lr: 0.015625</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:17,299 epoch 28 - iter 7/17 - loss 2.00117913 - samples/sec: 298.19 - lr: 0.015625</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:17,419 epoch 28 - iter 8/17 - loss 1.97936609 - samples/sec: 269.09 - lr: 0.015625</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:17,526 epoch 28 - iter 9/17 - loss 1.89083740 - samples/sec: 304.52 - lr: 0.015625</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:17,635 epoch 28 - iter 10/17 - loss 2.04024680 - samples/sec: 298.68 - lr: 0.015625</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:17,750 epoch 28 - iter 11/17 - loss 2.15808472 - samples/sec: 280.07 - lr: 0.015625</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:17,862 epoch 28 - iter 12/17 - loss 2.18874393 - samples/sec: 288.12 - lr: 0.015625</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:17,979 epoch 28 - iter 13/17 - loss 2.18398133 - samples/sec: 277.47 - lr: 0.015625</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:18,107 epoch 28 - iter 14/17 - loss 2.23524254 - samples/sec: 252.52 - lr: 0.015625</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:18,209 epoch 28 - iter 15/17 - loss 2.20884586 - samples/sec: 317.97 - lr: 0.015625</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:18,328 epoch 28 - iter 16/17 - loss 2.19283289 - samples/sec: 271.69 - lr: 0.015625</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:18,411 epoch 28 - iter 17/17 - loss 2.17065479 - samples/sec: 389.14 - lr: 0.015625</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:18,412 ----------------------------------------------------------------------------------------------------</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:18,416 EPOCH 28 done: loss 2.1707 - lr 0.0156250</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:18,497 DEV : loss 1.8591759204864502 - score 0.9039</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:18,501 BAD EPOCHS (no improvement): 1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:18,504 ----------------------------------------------------------------------------------------------------</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:18,616 epoch 29 - iter 1/17 - loss 2.38848042 - samples/sec: 295.16 - lr: 0.015625</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:18,730 epoch 29 - iter 2/17 - loss 2.01982307 - samples/sec: 281.73 - lr: 0.015625</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:18,842 epoch 29 - iter 3/17 - loss 2.28015947 - samples/sec: 289.15 - lr: 0.015625</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:18,973 epoch 29 - iter 4/17 - loss 2.35284030 - samples/sec: 248.54 - lr: 0.015625</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:19,100 epoch 29 - iter 5/17 - loss 2.46799192 - samples/sec: 253.52 - lr: 0.015625</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:19,208 epoch 29 - iter 6/17 - loss 2.40597574 - samples/sec: 298.77 - lr: 0.015625</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:19,316 epoch 29 - iter 7/17 - loss 2.27038290 - samples/sec: 301.48 - lr: 0.015625</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:19,432 epoch 29 - iter 8/17 - loss 2.20697598 - samples/sec: 277.52 - lr: 0.015625</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:19,545 epoch 29 - iter 9/17 - loss 2.14561096 - samples/sec: 286.38 - lr: 0.015625</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:19,656 epoch 29 - iter 10/17 - loss 2.20748037 - samples/sec: 293.48 - lr: 0.015625</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:19,763 epoch 29 - iter 11/17 - loss 2.22472450 - samples/sec: 302.61 - lr: 0.015625</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:19,878 epoch 29 - iter 12/17 - loss 2.24347988 - samples/sec: 286.50 - lr: 0.015625</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:19,994 epoch 29 - iter 13/17 - loss 2.21828763 - samples/sec: 277.90 - lr: 0.015625</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:20,105 epoch 29 - iter 14/17 - loss 2.18254331 - samples/sec: 294.47 - lr: 0.015625</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:20,213 epoch 29 - iter 15/17 - loss 2.22664884 - samples/sec: 299.30 - lr: 0.015625</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:20,322 epoch 29 - iter 16/17 - loss 2.23254411 - samples/sec: 297.41 - lr: 0.015625</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:20,399 epoch 29 - iter 17/17 - loss 2.21945810 - samples/sec: 422.06 - lr: 0.015625</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:20,400 ----------------------------------------------------------------------------------------------------</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:20,402 EPOCH 29 done: loss 2.2195 - lr 0.0156250</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:20,492 DEV : loss 1.8752442598342896 - score 0.9039</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:20,496 BAD EPOCHS (no improvement): 2</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:20,497 ----------------------------------------------------------------------------------------------------</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:20,607 epoch 30 - iter 1/17 - loss 1.82208562 - samples/sec: 297.46 - lr: 0.015625</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:20,721 epoch 30 - iter 2/17 - loss 2.00882280 - samples/sec: 284.76 - lr: 0.015625</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:20,838 epoch 30 - iter 3/17 - loss 2.11731188 - samples/sec: 276.32 - lr: 0.015625</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:20,946 epoch 30 - iter 4/17 - loss 1.95303643 - samples/sec: 300.17 - lr: 0.015625</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:21,047 epoch 30 - iter 5/17 - loss 2.05010142 - samples/sec: 322.80 - lr: 0.015625</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:21,164 epoch 30 - iter 6/17 - loss 2.18919861 - samples/sec: 276.19 - lr: 0.015625</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:21,273 epoch 30 - iter 7/17 - loss 2.20131217 - samples/sec: 298.11 - lr: 0.015625</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:21,389 epoch 30 - iter 8/17 - loss 2.24543753 - samples/sec: 282.40 - lr: 0.015625</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:21,506 epoch 30 - iter 9/17 - loss 2.20305248 - samples/sec: 277.27 - lr: 0.015625</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:21,611 epoch 30 - iter 10/17 - loss 2.13625307 - samples/sec: 309.91 - lr: 0.015625</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:21,733 epoch 30 - iter 11/17 - loss 2.14368816 - samples/sec: 264.68 - lr: 0.015625</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:21,870 epoch 30 - iter 12/17 - loss 2.21769957 - samples/sec: 235.08 - lr: 0.015625</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:21,980 epoch 30 - iter 13/17 - loss 2.18367576 - samples/sec: 297.07 - lr: 0.015625</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:22,087 epoch 30 - iter 14/17 - loss 2.16648819 - samples/sec: 303.74 - lr: 0.015625</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:22,193 epoch 30 - iter 15/17 - loss 2.19202752 - samples/sec: 304.22 - lr: 0.015625</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:22,301 epoch 30 - iter 16/17 - loss 2.19048543 - samples/sec: 304.97 - lr: 0.015625</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:22,394 epoch 30 - iter 17/17 - loss 2.21348506 - samples/sec: 351.18 - lr: 0.015625</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:22,395 ----------------------------------------------------------------------------------------------------</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:22,400 EPOCH 30 done: loss 2.2135 - lr 0.0156250</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:22,481 DEV : loss 1.8820831775665283 - score 0.9039</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:22,484 BAD EPOCHS (no improvement): 3</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:22,486 ----------------------------------------------------------------------------------------------------</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:22,600 epoch 31 - iter 1/17 - loss 2.38624716 - samples/sec: 288.82 - lr: 0.015625</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:22,707 epoch 31 - iter 2/17 - loss 2.14800692 - samples/sec: 304.05 - lr: 0.015625</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:22,816 epoch 31 - iter 3/17 - loss 1.89553030 - samples/sec: 296.20 - lr: 0.015625</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:22,921 epoch 31 - iter 4/17 - loss 1.80254796 - samples/sec: 308.79 - lr: 0.015625</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:23,025 epoch 31 - iter 5/17 - loss 2.05551784 - samples/sec: 312.82 - lr: 0.015625</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:23,132 epoch 31 - iter 6/17 - loss 2.07799266 - samples/sec: 303.13 - lr: 0.015625</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:23,242 epoch 31 - iter 7/17 - loss 2.12334066 - samples/sec: 292.67 - lr: 0.015625</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:23,354 epoch 31 - iter 8/17 - loss 2.12068520 - samples/sec: 289.28 - lr: 0.015625</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:23,464 epoch 31 - iter 9/17 - loss 2.06356608 - samples/sec: 295.16 - lr: 0.015625</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:23,596 epoch 31 - iter 10/17 - loss 2.07550075 - samples/sec: 244.25 - lr: 0.015625</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:23,718 epoch 31 - iter 11/17 - loss 2.08892419 - samples/sec: 264.35 - lr: 0.015625</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:23,850 epoch 31 - iter 12/17 - loss 2.10753208 - samples/sec: 245.54 - lr: 0.015625</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:23,961 epoch 31 - iter 13/17 - loss 2.11423028 - samples/sec: 292.27 - lr: 0.015625</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:24,075 epoch 31 - iter 14/17 - loss 2.10826038 - samples/sec: 284.92 - lr: 0.015625</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:24,180 epoch 31 - iter 15/17 - loss 2.15856535 - samples/sec: 306.64 - lr: 0.015625</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:24,289 epoch 31 - iter 16/17 - loss 2.20597644 - samples/sec: 296.83 - lr: 0.015625</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:24,363 epoch 31 - iter 17/17 - loss 2.15071367 - samples/sec: 441.66 - lr: 0.015625</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:24,364 ----------------------------------------------------------------------------------------------------</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:24,369 EPOCH 31 done: loss 2.1507 - lr 0.0156250</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:24,448 DEV : loss 1.87209951877594 - score 0.9039</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Epoch    31: reducing learning rate of group 0 to 7.8125e-03.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:24,450 BAD EPOCHS (no improvement): 4</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:24,454 ----------------------------------------------------------------------------------------------------</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:24,587 epoch 32 - iter 1/17 - loss 3.31541109 - samples/sec: 244.62 - lr: 0.007812</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:24,699 epoch 32 - iter 2/17 - loss 2.87909269 - samples/sec: 292.61 - lr: 0.007812</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:24,817 epoch 32 - iter 3/17 - loss 2.39622060 - samples/sec: 274.76 - lr: 0.007812</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:24,922 epoch 32 - iter 4/17 - loss 2.27022970 - samples/sec: 307.60 - lr: 0.007812</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:25,030 epoch 32 - iter 5/17 - loss 2.35990863 - samples/sec: 299.72 - lr: 0.007812</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:25,138 epoch 32 - iter 6/17 - loss 2.25238045 - samples/sec: 299.64 - lr: 0.007812</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:25,252 epoch 32 - iter 7/17 - loss 2.31877245 - samples/sec: 281.27 - lr: 0.007812</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:25,359 epoch 32 - iter 8/17 - loss 2.32546023 - samples/sec: 302.22 - lr: 0.007812</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:25,465 epoch 32 - iter 9/17 - loss 2.25857042 - samples/sec: 305.31 - lr: 0.007812</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:25,578 epoch 32 - iter 10/17 - loss 2.16616904 - samples/sec: 284.42 - lr: 0.007812</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:25,678 epoch 32 - iter 11/17 - loss 2.17235703 - samples/sec: 325.38 - lr: 0.007812</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:25,788 epoch 32 - iter 12/17 - loss 2.24928207 - samples/sec: 292.01 - lr: 0.007812</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:25,887 epoch 32 - iter 13/17 - loss 2.20171934 - samples/sec: 327.47 - lr: 0.007812</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:25,994 epoch 32 - iter 14/17 - loss 2.19627576 - samples/sec: 304.41 - lr: 0.007812</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:26,097 epoch 32 - iter 15/17 - loss 2.15969448 - samples/sec: 314.44 - lr: 0.007812</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:26,196 epoch 32 - iter 16/17 - loss 2.15566656 - samples/sec: 324.70 - lr: 0.007812</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:26,277 epoch 32 - iter 17/17 - loss 2.12638341 - samples/sec: 401.92 - lr: 0.007812</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:26,278 ----------------------------------------------------------------------------------------------------</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:26,283 EPOCH 32 done: loss 2.1264 - lr 0.0078125</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:26,360 DEV : loss 1.8655517101287842 - score 0.9039</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:26,363 BAD EPOCHS (no improvement): 1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:26,367 ----------------------------------------------------------------------------------------------------</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:26,472 epoch 33 - iter 1/17 - loss 2.11451244 - samples/sec: 307.77 - lr: 0.007812</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:26,571 epoch 33 - iter 2/17 - loss 1.94452286 - samples/sec: 329.06 - lr: 0.007812</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:26,692 epoch 33 - iter 3/17 - loss 2.11479004 - samples/sec: 269.04 - lr: 0.007812</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:26,810 epoch 33 - iter 4/17 - loss 2.03008524 - samples/sec: 273.58 - lr: 0.007812</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:26,921 epoch 33 - iter 5/17 - loss 1.94079068 - samples/sec: 293.75 - lr: 0.007812</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:27,030 epoch 33 - iter 6/17 - loss 2.00068849 - samples/sec: 296.73 - lr: 0.007812</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:27,143 epoch 33 - iter 7/17 - loss 2.01924847 - samples/sec: 288.16 - lr: 0.007812</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:27,251 epoch 33 - iter 8/17 - loss 2.11283641 - samples/sec: 297.76 - lr: 0.007812</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:27,358 epoch 33 - iter 9/17 - loss 2.04315246 - samples/sec: 303.98 - lr: 0.007812</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:27,473 epoch 33 - iter 10/17 - loss 2.06819868 - samples/sec: 280.28 - lr: 0.007812</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:27,583 epoch 33 - iter 11/17 - loss 2.12044837 - samples/sec: 297.79 - lr: 0.007812</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:27,693 epoch 33 - iter 12/17 - loss 2.14381409 - samples/sec: 293.06 - lr: 0.007812</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:27,802 epoch 33 - iter 13/17 - loss 2.14429503 - samples/sec: 297.72 - lr: 0.007812</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:27,913 epoch 33 - iter 14/17 - loss 2.10765451 - samples/sec: 291.99 - lr: 0.007812</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:28,053 epoch 33 - iter 15/17 - loss 2.13644788 - samples/sec: 230.54 - lr: 0.007812</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:28,157 epoch 33 - iter 16/17 - loss 2.16665895 - samples/sec: 310.85 - lr: 0.007812</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:28,240 epoch 33 - iter 17/17 - loss 2.18356979 - samples/sec: 395.16 - lr: 0.007812</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:28,241 ----------------------------------------------------------------------------------------------------</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:28,246 EPOCH 33 done: loss 2.1836 - lr 0.0078125</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:28,324 DEV : loss 1.860945701599121 - score 0.9039</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:28,326 BAD EPOCHS (no improvement): 2</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:28,329 ----------------------------------------------------------------------------------------------------</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:28,435 epoch 34 - iter 1/17 - loss 2.16651177 - samples/sec: 310.24 - lr: 0.007812</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:28,534 epoch 34 - iter 2/17 - loss 2.25732791 - samples/sec: 329.03 - lr: 0.007812</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:28,648 epoch 34 - iter 3/17 - loss 2.21363282 - samples/sec: 284.57 - lr: 0.007812</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:28,771 epoch 34 - iter 4/17 - loss 2.33480859 - samples/sec: 262.22 - lr: 0.007812</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:28,888 epoch 34 - iter 5/17 - loss 2.34977865 - samples/sec: 275.83 - lr: 0.007812</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:28,998 epoch 34 - iter 6/17 - loss 2.29187767 - samples/sec: 295.34 - lr: 0.007812</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:29,107 epoch 34 - iter 7/17 - loss 2.28540604 - samples/sec: 296.13 - lr: 0.007812</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:29,216 epoch 34 - iter 8/17 - loss 2.21293262 - samples/sec: 297.22 - lr: 0.007812</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:29,324 epoch 34 - iter 9/17 - loss 2.13716773 - samples/sec: 300.87 - lr: 0.007812</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:29,454 epoch 34 - iter 10/17 - loss 2.22819139 - samples/sec: 247.87 - lr: 0.007812</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:29,559 epoch 34 - iter 11/17 - loss 2.28991833 - samples/sec: 309.13 - lr: 0.007812</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:29,670 epoch 34 - iter 12/17 - loss 2.28256600 - samples/sec: 291.14 - lr: 0.007812</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:29,783 epoch 34 - iter 13/17 - loss 2.22029331 - samples/sec: 285.83 - lr: 0.007812</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:29,906 epoch 34 - iter 14/17 - loss 2.21900798 - samples/sec: 263.64 - lr: 0.007812</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:30,017 epoch 34 - iter 15/17 - loss 2.19328976 - samples/sec: 292.50 - lr: 0.007812</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:30,129 epoch 34 - iter 16/17 - loss 2.19865713 - samples/sec: 288.33 - lr: 0.007812</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:30,207 epoch 34 - iter 17/17 - loss 2.23145440 - samples/sec: 416.13 - lr: 0.007812</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:30,208 ----------------------------------------------------------------------------------------------------</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:30,214 EPOCH 34 done: loss 2.2315 - lr 0.0078125</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:30,292 DEV : loss 1.8520863056182861 - score 0.9039</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:30,296 BAD EPOCHS (no improvement): 3</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:30,299 ----------------------------------------------------------------------------------------------------</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:30,403 epoch 35 - iter 1/17 - loss 2.20372343 - samples/sec: 317.64 - lr: 0.007812</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:30,512 epoch 35 - iter 2/17 - loss 2.14256120 - samples/sec: 297.31 - lr: 0.007812</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:30,617 epoch 35 - iter 3/17 - loss 2.07499452 - samples/sec: 310.13 - lr: 0.007812</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:30,733 epoch 35 - iter 4/17 - loss 2.12319884 - samples/sec: 276.98 - lr: 0.007812</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:30,837 epoch 35 - iter 5/17 - loss 2.20568845 - samples/sec: 310.20 - lr: 0.007812</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:30,949 epoch 35 - iter 6/17 - loss 2.16370652 - samples/sec: 291.01 - lr: 0.007812</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:31,060 epoch 35 - iter 7/17 - loss 2.15263004 - samples/sec: 292.45 - lr: 0.007812</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:31,167 epoch 35 - iter 8/17 - loss 2.19112043 - samples/sec: 300.66 - lr: 0.007812</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:31,281 epoch 35 - iter 9/17 - loss 2.16499941 - samples/sec: 284.53 - lr: 0.007812</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:31,403 epoch 35 - iter 10/17 - loss 2.11889089 - samples/sec: 264.39 - lr: 0.007812</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:31,513 epoch 35 - iter 11/17 - loss 2.06410332 - samples/sec: 294.73 - lr: 0.007812</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:31,622 epoch 35 - iter 12/17 - loss 2.05899282 - samples/sec: 295.55 - lr: 0.007812</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:31,730 epoch 35 - iter 13/17 - loss 2.01894082 - samples/sec: 299.70 - lr: 0.007812</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:31,843 epoch 35 - iter 14/17 - loss 2.08863953 - samples/sec: 285.49 - lr: 0.007812</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:31,958 epoch 35 - iter 15/17 - loss 2.17515968 - samples/sec: 281.82 - lr: 0.007812</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:32,063 epoch 35 - iter 16/17 - loss 2.16473049 - samples/sec: 307.60 - lr: 0.007812</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:32,142 epoch 35 - iter 17/17 - loss 2.15948333 - samples/sec: 410.71 - lr: 0.007812</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:32,143 ----------------------------------------------------------------------------------------------------</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:32,148 EPOCH 35 done: loss 2.1595 - lr 0.0078125</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:32,225 DEV : loss 1.8610153198242188 - score 0.9039</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Epoch    35: reducing learning rate of group 0 to 3.9062e-03.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:32,228 BAD EPOCHS (no improvement): 4</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:32,230 ----------------------------------------------------------------------------------------------------</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:32,346 epoch 36 - iter 1/17 - loss 2.43557644 - samples/sec: 285.81 - lr: 0.003906</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:32,452 epoch 36 - iter 2/17 - loss 2.08234406 - samples/sec: 305.17 - lr: 0.003906</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:32,556 epoch 36 - iter 3/17 - loss 2.13271157 - samples/sec: 308.61 - lr: 0.003906</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:32,663 epoch 36 - iter 4/17 - loss 2.12066472 - samples/sec: 303.64 - lr: 0.003906</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:32,775 epoch 36 - iter 5/17 - loss 2.19467897 - samples/sec: 288.35 - lr: 0.003906</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:32,884 epoch 36 - iter 6/17 - loss 2.10642157 - samples/sec: 295.36 - lr: 0.003906</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:32,996 epoch 36 - iter 7/17 - loss 2.09218320 - samples/sec: 295.59 - lr: 0.003906</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:33,104 epoch 36 - iter 8/17 - loss 2.07874064 - samples/sec: 297.33 - lr: 0.003906</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:33,210 epoch 36 - iter 9/17 - loss 2.07249725 - samples/sec: 304.95 - lr: 0.003906</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:33,316 epoch 36 - iter 10/17 - loss 2.11360244 - samples/sec: 305.79 - lr: 0.003906</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:33,427 epoch 36 - iter 11/17 - loss 2.14954514 - samples/sec: 292.79 - lr: 0.003906</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:33,532 epoch 36 - iter 12/17 - loss 2.15247686 - samples/sec: 306.40 - lr: 0.003906</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:33,628 epoch 36 - iter 13/17 - loss 2.17567102 - samples/sec: 336.53 - lr: 0.003906</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:33,746 epoch 36 - iter 14/17 - loss 2.15970991 - samples/sec: 274.48 - lr: 0.003906</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:33,877 epoch 36 - iter 15/17 - loss 2.17100244 - samples/sec: 246.64 - lr: 0.003906</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:33,989 epoch 36 - iter 16/17 - loss 2.17317575 - samples/sec: 288.69 - lr: 0.003906</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:34,068 epoch 36 - iter 17/17 - loss 2.16962830 - samples/sec: 414.82 - lr: 0.003906</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:34,069 ----------------------------------------------------------------------------------------------------</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:34,075 EPOCH 36 done: loss 2.1696 - lr 0.0039062</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:34,154 DEV : loss 1.8612797260284424 - score 0.9039</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:34,155 BAD EPOCHS (no improvement): 1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:34,159 ----------------------------------------------------------------------------------------------------</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:34,267 epoch 37 - iter 1/17 - loss 2.70274210 - samples/sec: 302.17 - lr: 0.003906</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:34,376 epoch 37 - iter 2/17 - loss 2.30244517 - samples/sec: 295.43 - lr: 0.003906</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:34,487 epoch 37 - iter 3/17 - loss 2.29809332 - samples/sec: 293.06 - lr: 0.003906</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:34,595 epoch 37 - iter 4/17 - loss 2.27606213 - samples/sec: 299.59 - lr: 0.003906</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:34,698 epoch 37 - iter 5/17 - loss 2.30987163 - samples/sec: 313.49 - lr: 0.003906</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:34,802 epoch 37 - iter 6/17 - loss 2.23178925 - samples/sec: 309.89 - lr: 0.003906</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:34,908 epoch 37 - iter 7/17 - loss 2.18345986 - samples/sec: 304.52 - lr: 0.003906</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:35,011 epoch 37 - iter 8/17 - loss 2.11910208 - samples/sec: 320.77 - lr: 0.003906</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:35,133 epoch 37 - iter 9/17 - loss 2.08216679 - samples/sec: 265.51 - lr: 0.003906</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:35,235 epoch 37 - iter 10/17 - loss 2.14111589 - samples/sec: 316.56 - lr: 0.003906</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:35,337 epoch 37 - iter 11/17 - loss 2.13171017 - samples/sec: 316.25 - lr: 0.003906</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:35,447 epoch 37 - iter 12/17 - loss 2.11819906 - samples/sec: 294.52 - lr: 0.003906</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:35,548 epoch 37 - iter 13/17 - loss 2.12408993 - samples/sec: 318.93 - lr: 0.003906</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:35,658 epoch 37 - iter 14/17 - loss 2.14650181 - samples/sec: 292.30 - lr: 0.003906</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:35,759 epoch 37 - iter 15/17 - loss 2.10822772 - samples/sec: 326.46 - lr: 0.003906</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:35,873 epoch 37 - iter 16/17 - loss 2.09593584 - samples/sec: 282.42 - lr: 0.003906</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:35,959 epoch 37 - iter 17/17 - loss 2.13863867 - samples/sec: 375.76 - lr: 0.003906</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:35,961 ----------------------------------------------------------------------------------------------------</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:35,963 EPOCH 37 done: loss 2.1386 - lr 0.0039062</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:36,041 DEV : loss 1.862546443939209 - score 0.9039</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:36,045 BAD EPOCHS (no improvement): 2</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:36,047 ----------------------------------------------------------------------------------------------------</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:36,153 epoch 38 - iter 1/17 - loss 1.55653930 - samples/sec: 309.42 - lr: 0.003906</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:36,262 epoch 38 - iter 2/17 - loss 1.83484852 - samples/sec: 295.54 - lr: 0.003906</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:36,366 epoch 38 - iter 3/17 - loss 1.97699809 - samples/sec: 310.71 - lr: 0.003906</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:36,478 epoch 38 - iter 4/17 - loss 1.97135368 - samples/sec: 290.51 - lr: 0.003906</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:36,580 epoch 38 - iter 5/17 - loss 2.01099064 - samples/sec: 318.33 - lr: 0.003906</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:36,685 epoch 38 - iter 6/17 - loss 1.91558721 - samples/sec: 306.78 - lr: 0.003906</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:36,811 epoch 38 - iter 7/17 - loss 2.06156763 - samples/sec: 256.64 - lr: 0.003906</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:36,913 epoch 38 - iter 8/17 - loss 2.07127489 - samples/sec: 318.30 - lr: 0.003906</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:37,034 epoch 38 - iter 9/17 - loss 2.12594540 - samples/sec: 266.92 - lr: 0.003906</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:37,138 epoch 38 - iter 10/17 - loss 2.16660880 - samples/sec: 313.26 - lr: 0.003906</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:37,246 epoch 38 - iter 11/17 - loss 2.15714467 - samples/sec: 297.33 - lr: 0.003906</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:37,350 epoch 38 - iter 12/17 - loss 2.16440808 - samples/sec: 314.15 - lr: 0.003906</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:37,460 epoch 38 - iter 13/17 - loss 2.14800671 - samples/sec: 294.64 - lr: 0.003906</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:37,583 epoch 38 - iter 14/17 - loss 2.16008878 - samples/sec: 262.87 - lr: 0.003906</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:37,687 epoch 38 - iter 15/17 - loss 2.08712841 - samples/sec: 309.62 - lr: 0.003906</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:37,788 epoch 38 - iter 16/17 - loss 2.09805407 - samples/sec: 320.24 - lr: 0.003906</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:37,868 epoch 38 - iter 17/17 - loss 2.07644403 - samples/sec: 404.17 - lr: 0.003906</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:37,869 ----------------------------------------------------------------------------------------------------</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:37,873 EPOCH 38 done: loss 2.0764 - lr 0.0039062</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:37,949 DEV : loss 1.869424819946289 - score 0.9039</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:37,953 BAD EPOCHS (no improvement): 3</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:37,961 ----------------------------------------------------------------------------------------------------</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:38,070 epoch 39 - iter 1/17 - loss 2.91720772 - samples/sec: 299.92 - lr: 0.003906</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:38,174 epoch 39 - iter 2/17 - loss 2.45199174 - samples/sec: 313.26 - lr: 0.003906</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:38,280 epoch 39 - iter 3/17 - loss 2.31430829 - samples/sec: 303.97 - lr: 0.003906</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:38,389 epoch 39 - iter 4/17 - loss 2.37968537 - samples/sec: 296.63 - lr: 0.003906</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:38,484 epoch 39 - iter 5/17 - loss 2.30176828 - samples/sec: 338.59 - lr: 0.003906</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:38,590 epoch 39 - iter 6/17 - loss 2.28818593 - samples/sec: 308.01 - lr: 0.003906</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:38,694 epoch 39 - iter 7/17 - loss 2.20957887 - samples/sec: 315.08 - lr: 0.003906</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:38,796 epoch 39 - iter 8/17 - loss 2.15541568 - samples/sec: 316.55 - lr: 0.003906</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:38,906 epoch 39 - iter 9/17 - loss 2.05849785 - samples/sec: 295.51 - lr: 0.003906</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:39,026 epoch 39 - iter 10/17 - loss 2.14265947 - samples/sec: 268.94 - lr: 0.003906</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:39,131 epoch 39 - iter 11/17 - loss 2.14655584 - samples/sec: 307.74 - lr: 0.003906</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:39,229 epoch 39 - iter 12/17 - loss 2.12833981 - samples/sec: 328.42 - lr: 0.003906</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:39,350 epoch 39 - iter 13/17 - loss 2.23054640 - samples/sec: 268.39 - lr: 0.003906</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:39,455 epoch 39 - iter 14/17 - loss 2.18998856 - samples/sec: 308.36 - lr: 0.003906</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:39,549 epoch 39 - iter 15/17 - loss 2.13317854 - samples/sec: 344.80 - lr: 0.003906</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:39,655 epoch 39 - iter 16/17 - loss 2.14621764 - samples/sec: 305.66 - lr: 0.003906</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:39,735 epoch 39 - iter 17/17 - loss 2.10736282 - samples/sec: 400.25 - lr: 0.003906</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:39,736 ----------------------------------------------------------------------------------------------------</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:39,742 EPOCH 39 done: loss 2.1074 - lr 0.0039062</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:39,838 DEV : loss 1.8706583976745605 - score 0.9039</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Epoch    39: reducing learning rate of group 0 to 1.9531e-03.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:39,842 BAD EPOCHS (no improvement): 4</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:39,844 ----------------------------------------------------------------------------------------------------</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:39,964 epoch 40 - iter 1/17 - loss 2.40858364 - samples/sec: 286.84 - lr: 0.001953</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:40,096 epoch 40 - iter 2/17 - loss 2.66101336 - samples/sec: 245.63 - lr: 0.001953</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:40,202 epoch 40 - iter 3/17 - loss 2.68021313 - samples/sec: 303.80 - lr: 0.001953</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:40,312 epoch 40 - iter 4/17 - loss 2.57772970 - samples/sec: 293.86 - lr: 0.001953</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:40,422 epoch 40 - iter 5/17 - loss 2.45276420 - samples/sec: 294.24 - lr: 0.001953</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:40,532 epoch 40 - iter 6/17 - loss 2.51650308 - samples/sec: 294.31 - lr: 0.001953</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:40,635 epoch 40 - iter 7/17 - loss 2.36470851 - samples/sec: 315.08 - lr: 0.001953</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:40,742 epoch 40 - iter 8/17 - loss 2.28064451 - samples/sec: 303.42 - lr: 0.001953</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:40,846 epoch 40 - iter 9/17 - loss 2.25968324 - samples/sec: 309.69 - lr: 0.001953</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:40,961 epoch 40 - iter 10/17 - loss 2.25215931 - samples/sec: 281.35 - lr: 0.001953</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:41,076 epoch 40 - iter 11/17 - loss 2.29170622 - samples/sec: 282.39 - lr: 0.001953</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:41,183 epoch 40 - iter 12/17 - loss 2.24143372 - samples/sec: 303.11 - lr: 0.001953</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:41,288 epoch 40 - iter 13/17 - loss 2.27747974 - samples/sec: 308.06 - lr: 0.001953</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:41,393 epoch 40 - iter 14/17 - loss 2.22446014 - samples/sec: 307.05 - lr: 0.001953</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:41,507 epoch 40 - iter 15/17 - loss 2.23860873 - samples/sec: 282.55 - lr: 0.001953</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:41,628 epoch 40 - iter 16/17 - loss 2.21095503 - samples/sec: 266.93 - lr: 0.001953</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:41,708 epoch 40 - iter 17/17 - loss 2.20091358 - samples/sec: 409.14 - lr: 0.001953</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:41,712 ----------------------------------------------------------------------------------------------------</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:41,713 EPOCH 40 done: loss 2.2009 - lr 0.0019531</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:41,803 DEV : loss 1.8684940338134766 - score 0.9039</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:41,809 BAD EPOCHS (no improvement): 1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:41,812 ----------------------------------------------------------------------------------------------------</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:41,929 epoch 41 - iter 1/17 - loss 1.65641534 - samples/sec: 281.95 - lr: 0.001953</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:42,047 epoch 41 - iter 2/17 - loss 1.98350984 - samples/sec: 274.74 - lr: 0.001953</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:42,156 epoch 41 - iter 3/17 - loss 1.93206290 - samples/sec: 298.68 - lr: 0.001953</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:42,268 epoch 41 - iter 4/17 - loss 1.83420372 - samples/sec: 287.80 - lr: 0.001953</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:42,374 epoch 41 - iter 5/17 - loss 1.74692581 - samples/sec: 304.46 - lr: 0.001953</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:42,488 epoch 41 - iter 6/17 - loss 1.89210922 - samples/sec: 287.42 - lr: 0.001953</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:42,600 epoch 41 - iter 7/17 - loss 1.92536325 - samples/sec: 289.60 - lr: 0.001953</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:42,717 epoch 41 - iter 8/17 - loss 1.87745994 - samples/sec: 276.82 - lr: 0.001953</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:42,834 epoch 41 - iter 9/17 - loss 1.95671293 - samples/sec: 277.22 - lr: 0.001953</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:42,969 epoch 41 - iter 10/17 - loss 2.00737596 - samples/sec: 238.75 - lr: 0.001953</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:43,081 epoch 41 - iter 11/17 - loss 2.06435234 - samples/sec: 287.18 - lr: 0.001953</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:43,191 epoch 41 - iter 12/17 - loss 2.05423961 - samples/sec: 294.45 - lr: 0.001953</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:43,295 epoch 41 - iter 13/17 - loss 2.07148066 - samples/sec: 311.37 - lr: 0.001953</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:43,403 epoch 41 - iter 14/17 - loss 2.10708749 - samples/sec: 300.12 - lr: 0.001953</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:43,509 epoch 41 - iter 15/17 - loss 2.10328631 - samples/sec: 303.79 - lr: 0.001953</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:43,631 epoch 41 - iter 16/17 - loss 2.10379887 - samples/sec: 264.22 - lr: 0.001953</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:43,705 epoch 41 - iter 17/17 - loss 2.13205387 - samples/sec: 444.99 - lr: 0.001953</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:43,706 ----------------------------------------------------------------------------------------------------</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:43,711 EPOCH 41 done: loss 2.1321 - lr 0.0019531</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:43,795 DEV : loss 1.8697052001953125 - score 0.9039</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:43,798 BAD EPOCHS (no improvement): 2</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:43,800 ----------------------------------------------------------------------------------------------------</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:43,909 epoch 42 - iter 1/17 - loss 1.95205081 - samples/sec: 303.71 - lr: 0.001953</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:44,025 epoch 42 - iter 2/17 - loss 1.77231854 - samples/sec: 278.23 - lr: 0.001953</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:44,141 epoch 42 - iter 3/17 - loss 1.76212402 - samples/sec: 278.12 - lr: 0.001953</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:44,251 epoch 42 - iter 4/17 - loss 1.68454868 - samples/sec: 296.14 - lr: 0.001953</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:44,358 epoch 42 - iter 5/17 - loss 1.72046323 - samples/sec: 300.28 - lr: 0.001953</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:44,466 epoch 42 - iter 6/17 - loss 1.82062662 - samples/sec: 300.04 - lr: 0.001953</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:44,577 epoch 42 - iter 7/17 - loss 1.82287388 - samples/sec: 290.32 - lr: 0.001953</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:44,680 epoch 42 - iter 8/17 - loss 1.80281527 - samples/sec: 312.72 - lr: 0.001953</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:44,786 epoch 42 - iter 9/17 - loss 1.73538368 - samples/sec: 307.32 - lr: 0.001953</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:44,889 epoch 42 - iter 10/17 - loss 1.86518863 - samples/sec: 312.29 - lr: 0.001953</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:45,024 epoch 42 - iter 11/17 - loss 1.89539980 - samples/sec: 238.57 - lr: 0.001953</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:45,142 epoch 42 - iter 12/17 - loss 1.88407112 - samples/sec: 273.58 - lr: 0.001953</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:45,252 epoch 42 - iter 13/17 - loss 1.93909807 - samples/sec: 296.27 - lr: 0.001953</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:45,366 epoch 42 - iter 14/17 - loss 1.96448104 - samples/sec: 283.21 - lr: 0.001953</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:45,478 epoch 42 - iter 15/17 - loss 2.04754047 - samples/sec: 288.62 - lr: 0.001953</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:45,588 epoch 42 - iter 16/17 - loss 2.09948217 - samples/sec: 295.08 - lr: 0.001953</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:45,660 epoch 42 - iter 17/17 - loss 2.06929702 - samples/sec: 447.93 - lr: 0.001953</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:45,661 ----------------------------------------------------------------------------------------------------</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:45,666 EPOCH 42 done: loss 2.0693 - lr 0.0019531</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:45,751 DEV : loss 1.8711341619491577 - score 0.9039</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:45,753 BAD EPOCHS (no improvement): 3</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:45,754 ----------------------------------------------------------------------------------------------------</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:45,875 epoch 43 - iter 1/17 - loss 1.59613466 - samples/sec: 272.75 - lr: 0.001953</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:45,986 epoch 43 - iter 2/17 - loss 1.89992344 - samples/sec: 292.91 - lr: 0.001953</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:46,111 epoch 43 - iter 3/17 - loss 2.15681545 - samples/sec: 257.22 - lr: 0.001953</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:46,221 epoch 43 - iter 4/17 - loss 1.94478324 - samples/sec: 296.32 - lr: 0.001953</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:46,327 epoch 43 - iter 5/17 - loss 2.02235644 - samples/sec: 306.35 - lr: 0.001953</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:46,436 epoch 43 - iter 6/17 - loss 2.06755092 - samples/sec: 295.39 - lr: 0.001953</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:46,533 epoch 43 - iter 7/17 - loss 2.09775879 - samples/sec: 332.81 - lr: 0.001953</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:46,635 epoch 43 - iter 8/17 - loss 2.04314528 - samples/sec: 316.79 - lr: 0.001953</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:46,767 epoch 43 - iter 9/17 - loss 2.04059197 - samples/sec: 244.50 - lr: 0.001953</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:46,887 epoch 43 - iter 10/17 - loss 2.13431033 - samples/sec: 269.87 - lr: 0.001953</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:46,997 epoch 43 - iter 11/17 - loss 2.11249408 - samples/sec: 295.32 - lr: 0.001953</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:47,101 epoch 43 - iter 12/17 - loss 2.18600748 - samples/sec: 308.72 - lr: 0.001953</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:47,213 epoch 43 - iter 13/17 - loss 2.19971956 - samples/sec: 290.51 - lr: 0.001953</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:47,323 epoch 43 - iter 14/17 - loss 2.11635588 - samples/sec: 295.03 - lr: 0.001953</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:47,449 epoch 43 - iter 15/17 - loss 2.15256975 - samples/sec: 255.52 - lr: 0.001953</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:47,560 epoch 43 - iter 16/17 - loss 2.12364431 - samples/sec: 290.04 - lr: 0.001953</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:47,632 epoch 43 - iter 17/17 - loss 2.13725646 - samples/sec: 467.01 - lr: 0.001953</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:47,633 ----------------------------------------------------------------------------------------------------</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:47,638 EPOCH 43 done: loss 2.1373 - lr 0.0019531</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:47,716 DEV : loss 1.871195912361145 - score 0.9039</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Epoch    43: reducing learning rate of group 0 to 9.7656e-04.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:47,720 BAD EPOCHS (no improvement): 4</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:47,721 ----------------------------------------------------------------------------------------------------</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:47,831 epoch 44 - iter 1/17 - loss 1.57494926 - samples/sec: 297.58 - lr: 0.000977</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:47,955 epoch 44 - iter 2/17 - loss 1.70237011 - samples/sec: 265.10 - lr: 0.000977</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:48,086 epoch 44 - iter 3/17 - loss 1.62696763 - samples/sec: 247.22 - lr: 0.000977</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:48,203 epoch 44 - iter 4/17 - loss 1.73749629 - samples/sec: 275.45 - lr: 0.000977</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:48,311 epoch 44 - iter 5/17 - loss 1.85222251 - samples/sec: 300.34 - lr: 0.000977</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:48,425 epoch 44 - iter 6/17 - loss 1.92494589 - samples/sec: 282.86 - lr: 0.000977</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:48,539 epoch 44 - iter 7/17 - loss 2.00947160 - samples/sec: 283.22 - lr: 0.000977</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:48,656 epoch 44 - iter 8/17 - loss 2.03440548 - samples/sec: 276.26 - lr: 0.000977</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:48,761 epoch 44 - iter 9/17 - loss 2.03593189 - samples/sec: 309.42 - lr: 0.000977</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:48,867 epoch 44 - iter 10/17 - loss 1.98007635 - samples/sec: 304.99 - lr: 0.000977</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:48,977 epoch 44 - iter 11/17 - loss 1.96373889 - samples/sec: 295.94 - lr: 0.000977</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:49,095 epoch 44 - iter 12/17 - loss 2.03976662 - samples/sec: 276.61 - lr: 0.000977</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:49,212 epoch 44 - iter 13/17 - loss 2.07122222 - samples/sec: 275.88 - lr: 0.000977</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:49,318 epoch 44 - iter 14/17 - loss 2.06604474 - samples/sec: 306.71 - lr: 0.000977</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:49,442 epoch 44 - iter 15/17 - loss 2.10574220 - samples/sec: 259.62 - lr: 0.000977</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:49,560 epoch 44 - iter 16/17 - loss 2.10223112 - samples/sec: 273.95 - lr: 0.000977</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:49,636 epoch 44 - iter 17/17 - loss 2.08419435 - samples/sec: 427.19 - lr: 0.000977</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:49,637 ----------------------------------------------------------------------------------------------------</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:49,641 EPOCH 44 done: loss 2.0842 - lr 0.0009766</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:49,724 DEV : loss 1.8707306385040283 - score 0.9039</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:49,726 BAD EPOCHS (no improvement): 1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:49,730 ----------------------------------------------------------------------------------------------------</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:49,838 epoch 45 - iter 1/17 - loss 1.89361787 - samples/sec: 305.45 - lr: 0.000977</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:49,947 epoch 45 - iter 2/17 - loss 2.21607864 - samples/sec: 299.69 - lr: 0.000977</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:50,049 epoch 45 - iter 3/17 - loss 2.01096229 - samples/sec: 315.51 - lr: 0.000977</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:50,170 epoch 45 - iter 4/17 - loss 1.97172287 - samples/sec: 266.99 - lr: 0.000977</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:50,277 epoch 45 - iter 5/17 - loss 1.93318305 - samples/sec: 301.61 - lr: 0.000977</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:50,372 epoch 45 - iter 6/17 - loss 1.82265991 - samples/sec: 340.79 - lr: 0.000977</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:50,475 epoch 45 - iter 7/17 - loss 1.90316897 - samples/sec: 313.52 - lr: 0.000977</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:50,582 epoch 45 - iter 8/17 - loss 1.94942440 - samples/sec: 302.36 - lr: 0.000977</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:50,684 epoch 45 - iter 9/17 - loss 1.91201617 - samples/sec: 318.28 - lr: 0.000977</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:50,788 epoch 45 - iter 10/17 - loss 1.95709399 - samples/sec: 308.72 - lr: 0.000977</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:50,917 epoch 45 - iter 11/17 - loss 2.03674131 - samples/sec: 251.01 - lr: 0.000977</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:51,031 epoch 45 - iter 12/17 - loss 2.09745031 - samples/sec: 283.16 - lr: 0.000977</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:51,144 epoch 45 - iter 13/17 - loss 2.10905980 - samples/sec: 288.12 - lr: 0.000977</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:51,254 epoch 45 - iter 14/17 - loss 2.12343171 - samples/sec: 293.42 - lr: 0.000977</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:51,371 epoch 45 - iter 15/17 - loss 2.10053473 - samples/sec: 276.05 - lr: 0.000977</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:51,487 epoch 45 - iter 16/17 - loss 2.09765709 - samples/sec: 278.21 - lr: 0.000977</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:51,571 epoch 45 - iter 17/17 - loss 2.11037770 - samples/sec: 387.99 - lr: 0.000977</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:51,572 ----------------------------------------------------------------------------------------------------</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:51,577 EPOCH 45 done: loss 2.1104 - lr 0.0009766</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:51,654 DEV : loss 1.8710083961486816 - score 0.9039</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:51,656 BAD EPOCHS (no improvement): 2</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:51,659 ----------------------------------------------------------------------------------------------------</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:51,769 epoch 46 - iter 1/17 - loss 2.29029131 - samples/sec: 297.72 - lr: 0.000977</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:51,878 epoch 46 - iter 2/17 - loss 2.57501078 - samples/sec: 295.45 - lr: 0.000977</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:51,995 epoch 46 - iter 3/17 - loss 2.33628249 - samples/sec: 277.47 - lr: 0.000977</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:52,100 epoch 46 - iter 4/17 - loss 2.20042735 - samples/sec: 308.27 - lr: 0.000977</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:52,228 epoch 46 - iter 5/17 - loss 2.15306783 - samples/sec: 252.65 - lr: 0.000977</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:52,337 epoch 46 - iter 6/17 - loss 2.23327601 - samples/sec: 298.16 - lr: 0.000977</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:52,455 epoch 46 - iter 7/17 - loss 2.17818601 - samples/sec: 273.14 - lr: 0.000977</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:52,580 epoch 46 - iter 8/17 - loss 2.29868346 - samples/sec: 262.24 - lr: 0.000977</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:52,692 epoch 46 - iter 9/17 - loss 2.24365924 - samples/sec: 286.62 - lr: 0.000977</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:52,793 epoch 46 - iter 10/17 - loss 2.13943095 - samples/sec: 321.16 - lr: 0.000977</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:52,909 epoch 46 - iter 11/17 - loss 2.22218587 - samples/sec: 278.50 - lr: 0.000977</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:53,011 epoch 46 - iter 12/17 - loss 2.17799040 - samples/sec: 320.62 - lr: 0.000977</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:53,122 epoch 46 - iter 13/17 - loss 2.13923915 - samples/sec: 291.37 - lr: 0.000977</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:53,244 epoch 46 - iter 14/17 - loss 2.13772869 - samples/sec: 263.87 - lr: 0.000977</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:53,350 epoch 46 - iter 15/17 - loss 2.10194511 - samples/sec: 308.98 - lr: 0.000977</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:53,474 epoch 46 - iter 16/17 - loss 2.12772428 - samples/sec: 261.12 - lr: 0.000977</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:53,558 epoch 46 - iter 17/17 - loss 2.14000834 - samples/sec: 387.06 - lr: 0.000977</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:53,559 ----------------------------------------------------------------------------------------------------</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:53,564 EPOCH 46 done: loss 2.1400 - lr 0.0009766</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:53,642 DEV : loss 1.8702256679534912 - score 0.9039</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:53,647 BAD EPOCHS (no improvement): 3</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:53,648 ----------------------------------------------------------------------------------------------------</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:53,759 epoch 47 - iter 1/17 - loss 2.40958548 - samples/sec: 304.72 - lr: 0.000977</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:53,893 epoch 47 - iter 2/17 - loss 2.19522685 - samples/sec: 242.33 - lr: 0.000977</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:54,004 epoch 47 - iter 3/17 - loss 2.18233558 - samples/sec: 292.21 - lr: 0.000977</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:54,117 epoch 47 - iter 4/17 - loss 2.08626416 - samples/sec: 287.13 - lr: 0.000977</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:54,243 epoch 47 - iter 5/17 - loss 2.13577464 - samples/sec: 257.57 - lr: 0.000977</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:54,352 epoch 47 - iter 6/17 - loss 2.09897268 - samples/sec: 294.61 - lr: 0.000977</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:54,457 epoch 47 - iter 7/17 - loss 2.25570938 - samples/sec: 309.49 - lr: 0.000977</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:54,566 epoch 47 - iter 8/17 - loss 2.36531955 - samples/sec: 299.93 - lr: 0.000977</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:54,692 epoch 47 - iter 9/17 - loss 2.39397939 - samples/sec: 256.87 - lr: 0.000977</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:54,801 epoch 47 - iter 10/17 - loss 2.31865383 - samples/sec: 295.82 - lr: 0.000977</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:54,904 epoch 47 - iter 11/17 - loss 2.23503270 - samples/sec: 314.43 - lr: 0.000977</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:55,006 epoch 47 - iter 12/17 - loss 2.19364679 - samples/sec: 318.50 - lr: 0.000977</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:55,107 epoch 47 - iter 13/17 - loss 2.16499858 - samples/sec: 319.93 - lr: 0.000977</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:55,247 epoch 47 - iter 14/17 - loss 2.17180823 - samples/sec: 229.81 - lr: 0.000977</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:55,356 epoch 47 - iter 15/17 - loss 2.19207067 - samples/sec: 298.37 - lr: 0.000977</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:55,467 epoch 47 - iter 16/17 - loss 2.19204720 - samples/sec: 292.88 - lr: 0.000977</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:55,540 epoch 47 - iter 17/17 - loss 2.16333261 - samples/sec: 439.67 - lr: 0.000977</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:55,542 ----------------------------------------------------------------------------------------------------</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:55,546 EPOCH 47 done: loss 2.1633 - lr 0.0009766</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:55,621 DEV : loss 1.8696794509887695 - score 0.9039</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Epoch    47: reducing learning rate of group 0 to 4.8828e-04.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:55,625 BAD EPOCHS (no improvement): 4</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:55,627 ----------------------------------------------------------------------------------------------------</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:55,732 epoch 48 - iter 1/17 - loss 2.13647890 - samples/sec: 312.68 - lr: 0.000488</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:55,841 epoch 48 - iter 2/17 - loss 2.60982764 - samples/sec: 295.73 - lr: 0.000488</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:55,955 epoch 48 - iter 3/17 - loss 2.60576868 - samples/sec: 284.55 - lr: 0.000488</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:56,063 epoch 48 - iter 4/17 - loss 2.81221414 - samples/sec: 299.76 - lr: 0.000488</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:56,165 epoch 48 - iter 5/17 - loss 2.56672552 - samples/sec: 320.36 - lr: 0.000488</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:56,284 epoch 48 - iter 6/17 - loss 2.45763489 - samples/sec: 271.14 - lr: 0.000488</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:56,398 epoch 48 - iter 7/17 - loss 2.42420312 - samples/sec: 284.66 - lr: 0.000488</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:56,512 epoch 48 - iter 8/17 - loss 2.40458560 - samples/sec: 282.20 - lr: 0.000488</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:56,637 epoch 48 - iter 9/17 - loss 2.34310838 - samples/sec: 258.63 - lr: 0.000488</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:56,745 epoch 48 - iter 10/17 - loss 2.32288555 - samples/sec: 302.83 - lr: 0.000488</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:56,859 epoch 48 - iter 11/17 - loss 2.23890460 - samples/sec: 282.30 - lr: 0.000488</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:56,972 epoch 48 - iter 12/17 - loss 2.23518967 - samples/sec: 287.37 - lr: 0.000488</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:57,080 epoch 48 - iter 13/17 - loss 2.26823274 - samples/sec: 299.58 - lr: 0.000488</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:57,191 epoch 48 - iter 14/17 - loss 2.26889933 - samples/sec: 296.74 - lr: 0.000488</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:57,307 epoch 48 - iter 15/17 - loss 2.23389218 - samples/sec: 277.80 - lr: 0.000488</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:57,419 epoch 48 - iter 16/17 - loss 2.21442220 - samples/sec: 288.86 - lr: 0.000488</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:57,489 epoch 48 - iter 17/17 - loss 2.15259550 - samples/sec: 463.29 - lr: 0.000488</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:57,490 ----------------------------------------------------------------------------------------------------</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:57,495 EPOCH 48 done: loss 2.1526 - lr 0.0004883</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:57,572 DEV : loss 1.869992733001709 - score 0.9039</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:57,575 BAD EPOCHS (no improvement): 1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:57,577 ----------------------------------------------------------------------------------------------------</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:57,689 epoch 49 - iter 1/17 - loss 3.32574272 - samples/sec: 290.88 - lr: 0.000488</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:57,798 epoch 49 - iter 2/17 - loss 3.23043871 - samples/sec: 298.50 - lr: 0.000488</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:57,909 epoch 49 - iter 3/17 - loss 2.52508895 - samples/sec: 293.91 - lr: 0.000488</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:58,014 epoch 49 - iter 4/17 - loss 2.27688953 - samples/sec: 307.34 - lr: 0.000488</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:58,124 epoch 49 - iter 5/17 - loss 2.20293577 - samples/sec: 296.12 - lr: 0.000488</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:58,225 epoch 49 - iter 6/17 - loss 2.22645797 - samples/sec: 318.18 - lr: 0.000488</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:58,343 epoch 49 - iter 7/17 - loss 2.18002132 - samples/sec: 274.32 - lr: 0.000488</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:58,454 epoch 49 - iter 8/17 - loss 2.08970803 - samples/sec: 290.59 - lr: 0.000488</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:58,579 epoch 49 - iter 9/17 - loss 2.12008651 - samples/sec: 258.67 - lr: 0.000488</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:58,698 epoch 49 - iter 10/17 - loss 2.12727408 - samples/sec: 272.61 - lr: 0.000488</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:58,800 epoch 49 - iter 11/17 - loss 2.08404921 - samples/sec: 314.90 - lr: 0.000488</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:58,913 epoch 49 - iter 12/17 - loss 2.07866135 - samples/sec: 288.02 - lr: 0.000488</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:59,034 epoch 49 - iter 13/17 - loss 2.09018061 - samples/sec: 266.84 - lr: 0.000488</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:59,152 epoch 49 - iter 14/17 - loss 2.12898230 - samples/sec: 275.69 - lr: 0.000488</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:59,277 epoch 49 - iter 15/17 - loss 2.11229343 - samples/sec: 257.11 - lr: 0.000488</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:59,413 epoch 49 - iter 16/17 - loss 2.14525196 - samples/sec: 237.68 - lr: 0.000488</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:59,502 epoch 49 - iter 17/17 - loss 2.16026076 - samples/sec: 366.15 - lr: 0.000488</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:59,503 ----------------------------------------------------------------------------------------------------</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:59,509 EPOCH 49 done: loss 2.1603 - lr 0.0004883</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:59,602 DEV : loss 1.8705830574035645 - score 0.9039</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:59,605 BAD EPOCHS (no improvement): 2</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:59,606 ----------------------------------------------------------------------------------------------------</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:59,729 epoch 50 - iter 1/17 - loss 1.70025277 - samples/sec: 265.16 - lr: 0.000488</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:59,843 epoch 50 - iter 2/17 - loss 1.75726217 - samples/sec: 285.34 - lr: 0.000488</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:31:59,947 epoch 50 - iter 3/17 - loss 1.81887865 - samples/sec: 311.87 - lr: 0.000488</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:32:00,055 epoch 50 - iter 4/17 - loss 1.73993617 - samples/sec: 299.32 - lr: 0.000488</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:32:00,164 epoch 50 - iter 5/17 - loss 1.70279319 - samples/sec: 295.46 - lr: 0.000488</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:32:00,290 epoch 50 - iter 6/17 - loss 1.82746798 - samples/sec: 257.35 - lr: 0.000488</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:32:00,417 epoch 50 - iter 7/17 - loss 1.90154033 - samples/sec: 252.97 - lr: 0.000488</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:32:00,537 epoch 50 - iter 8/17 - loss 1.92441855 - samples/sec: 270.18 - lr: 0.000488</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:32:00,650 epoch 50 - iter 9/17 - loss 1.97294697 - samples/sec: 291.55 - lr: 0.000488</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:32:00,759 epoch 50 - iter 10/17 - loss 1.98562843 - samples/sec: 297.68 - lr: 0.000488</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:32:00,871 epoch 50 - iter 11/17 - loss 2.00348701 - samples/sec: 287.94 - lr: 0.000488</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:32:00,991 epoch 50 - iter 12/17 - loss 2.05574360 - samples/sec: 270.36 - lr: 0.000488</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:32:01,112 epoch 50 - iter 13/17 - loss 2.10646278 - samples/sec: 273.29 - lr: 0.000488</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:32:01,222 epoch 50 - iter 14/17 - loss 2.14258188 - samples/sec: 297.55 - lr: 0.000488</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:32:01,338 epoch 50 - iter 15/17 - loss 2.10952766 - samples/sec: 280.93 - lr: 0.000488</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:32:01,454 epoch 50 - iter 16/17 - loss 2.18073478 - samples/sec: 282.13 - lr: 0.000488</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:32:01,544 epoch 50 - iter 17/17 - loss 2.18814912 - samples/sec: 361.88 - lr: 0.000488</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:32:01,546 ----------------------------------------------------------------------------------------------------</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:32:01,555 EPOCH 50 done: loss 2.1881 - lr 0.0004883</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:32:01,639 DEV : loss 1.8708758354187012 - score 0.9039</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:32:01,643 BAD EPOCHS (no improvement): 3</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:32:01,645 ----------------------------------------------------------------------------------------------------</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:32:01,754 epoch 51 - iter 1/17 - loss 2.37925291 - samples/sec: 299.85 - lr: 0.000488</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:32:01,862 epoch 51 - iter 2/17 - loss 2.31285119 - samples/sec: 299.21 - lr: 0.000488</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:32:01,983 epoch 51 - iter 3/17 - loss 2.07815230 - samples/sec: 267.30 - lr: 0.000488</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:32:02,098 epoch 51 - iter 4/17 - loss 2.12176999 - samples/sec: 280.35 - lr: 0.000488</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:32:02,209 epoch 51 - iter 5/17 - loss 2.13544719 - samples/sec: 296.11 - lr: 0.000488</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:32:02,315 epoch 51 - iter 6/17 - loss 2.15400670 - samples/sec: 302.91 - lr: 0.000488</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:32:02,435 epoch 51 - iter 7/17 - loss 2.15878560 - samples/sec: 271.01 - lr: 0.000488</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:32:02,546 epoch 51 - iter 8/17 - loss 2.10743538 - samples/sec: 292.75 - lr: 0.000488</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:32:02,652 epoch 51 - iter 9/17 - loss 2.14642469 - samples/sec: 303.95 - lr: 0.000488</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:32:02,768 epoch 51 - iter 10/17 - loss 2.11396281 - samples/sec: 280.38 - lr: 0.000488</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:32:02,896 epoch 51 - iter 11/17 - loss 2.13433785 - samples/sec: 252.34 - lr: 0.000488</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:32:03,009 epoch 51 - iter 12/17 - loss 2.14074990 - samples/sec: 287.48 - lr: 0.000488</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:32:03,133 epoch 51 - iter 13/17 - loss 2.16428389 - samples/sec: 266.61 - lr: 0.000488</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:32:03,242 epoch 51 - iter 14/17 - loss 2.17041359 - samples/sec: 297.92 - lr: 0.000488</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:32:03,348 epoch 51 - iter 15/17 - loss 2.11546025 - samples/sec: 305.25 - lr: 0.000488</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:32:03,465 epoch 51 - iter 16/17 - loss 2.11760668 - samples/sec: 279.29 - lr: 0.000488</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:32:03,532 epoch 51 - iter 17/17 - loss 2.15209274 - samples/sec: 491.81 - lr: 0.000488</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:32:03,533 ----------------------------------------------------------------------------------------------------</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:32:03,538 EPOCH 51 done: loss 2.1521 - lr 0.0004883</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:32:03,616 DEV : loss 1.8709588050842285 - score 0.9039</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Epoch    51: reducing learning rate of group 0 to 2.4414e-04.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:32:03,621 BAD EPOCHS (no improvement): 4</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:32:03,623 ----------------------------------------------------------------------------------------------------</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:32:03,734 epoch 52 - iter 1/17 - loss 1.42433143 - samples/sec: 293.13 - lr: 0.000244</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:32:03,864 epoch 52 - iter 2/17 - loss 1.94309056 - samples/sec: 248.18 - lr: 0.000244</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:32:03,970 epoch 52 - iter 3/17 - loss 2.05831647 - samples/sec: 306.61 - lr: 0.000244</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:32:04,083 epoch 52 - iter 4/17 - loss 2.07525927 - samples/sec: 286.32 - lr: 0.000244</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:32:04,197 epoch 52 - iter 5/17 - loss 2.31849523 - samples/sec: 284.32 - lr: 0.000244</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:32:04,302 epoch 52 - iter 6/17 - loss 2.25557834 - samples/sec: 307.19 - lr: 0.000244</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:32:04,416 epoch 52 - iter 7/17 - loss 2.21537377 - samples/sec: 282.38 - lr: 0.000244</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:32:04,532 epoch 52 - iter 8/17 - loss 2.16501409 - samples/sec: 278.57 - lr: 0.000244</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:32:04,633 epoch 52 - iter 9/17 - loss 2.17519458 - samples/sec: 322.09 - lr: 0.000244</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:32:04,758 epoch 52 - iter 10/17 - loss 2.25405197 - samples/sec: 265.34 - lr: 0.000244</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:32:04,866 epoch 52 - iter 11/17 - loss 2.22692343 - samples/sec: 298.33 - lr: 0.000244</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:32:04,971 epoch 52 - iter 12/17 - loss 2.20147764 - samples/sec: 309.76 - lr: 0.000244</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:32:05,077 epoch 52 - iter 13/17 - loss 2.19556830 - samples/sec: 305.14 - lr: 0.000244</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:32:05,203 epoch 52 - iter 14/17 - loss 2.16996110 - samples/sec: 261.25 - lr: 0.000244</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:32:05,307 epoch 52 - iter 15/17 - loss 2.15638318 - samples/sec: 308.44 - lr: 0.000244</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:32:05,425 epoch 52 - iter 16/17 - loss 2.13956507 - samples/sec: 275.18 - lr: 0.000244</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:32:05,493 epoch 52 - iter 17/17 - loss 2.07687952 - samples/sec: 475.48 - lr: 0.000244</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:32:05,494 ----------------------------------------------------------------------------------------------------</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:32:05,499 EPOCH 52 done: loss 2.0769 - lr 0.0002441</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:32:05,575 DEV : loss 1.8710246086120605 - score 0.9039</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:32:05,578 BAD EPOCHS (no improvement): 1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:32:05,580 ----------------------------------------------------------------------------------------------------</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:32:05,696 epoch 53 - iter 1/17 - loss 2.67301607 - samples/sec: 279.99 - lr: 0.000244</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:32:05,810 epoch 53 - iter 2/17 - loss 2.87615097 - samples/sec: 284.34 - lr: 0.000244</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:32:05,925 epoch 53 - iter 3/17 - loss 2.46839376 - samples/sec: 279.79 - lr: 0.000244</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:32:06,049 epoch 53 - iter 4/17 - loss 2.64226267 - samples/sec: 261.68 - lr: 0.000244</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:32:06,156 epoch 53 - iter 5/17 - loss 2.48819025 - samples/sec: 300.57 - lr: 0.000244</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:32:06,263 epoch 53 - iter 6/17 - loss 2.42314504 - samples/sec: 302.87 - lr: 0.000244</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:32:06,366 epoch 53 - iter 7/17 - loss 2.33482059 - samples/sec: 313.20 - lr: 0.000244</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:32:06,481 epoch 53 - iter 8/17 - loss 2.23332472 - samples/sec: 281.06 - lr: 0.000244</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:32:06,593 epoch 53 - iter 9/17 - loss 2.26868233 - samples/sec: 294.98 - lr: 0.000244</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:32:06,700 epoch 53 - iter 10/17 - loss 2.20803412 - samples/sec: 302.27 - lr: 0.000244</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:32:06,808 epoch 53 - iter 11/17 - loss 2.17226865 - samples/sec: 299.75 - lr: 0.000244</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:32:06,903 epoch 53 - iter 12/17 - loss 2.13279492 - samples/sec: 342.01 - lr: 0.000244</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:32:07,007 epoch 53 - iter 13/17 - loss 2.14206107 - samples/sec: 309.29 - lr: 0.000244</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:32:07,118 epoch 53 - iter 14/17 - loss 2.15092226 - samples/sec: 293.50 - lr: 0.000244</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:32:07,229 epoch 53 - iter 15/17 - loss 2.18495049 - samples/sec: 289.12 - lr: 0.000244</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:32:07,337 epoch 53 - iter 16/17 - loss 2.16140499 - samples/sec: 298.82 - lr: 0.000244</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:32:07,415 epoch 53 - iter 17/17 - loss 2.15657809 - samples/sec: 418.69 - lr: 0.000244</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:32:07,416 ----------------------------------------------------------------------------------------------------</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:32:07,421 EPOCH 53 done: loss 2.1566 - lr 0.0002441</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:32:07,507 DEV : loss 1.8710384368896484 - score 0.9039</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:32:07,510 BAD EPOCHS (no improvement): 2</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:32:07,514 ----------------------------------------------------------------------------------------------------</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:32:07,626 epoch 54 - iter 1/17 - loss 2.50339174 - samples/sec: 292.09 - lr: 0.000244</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:32:07,735 epoch 54 - iter 2/17 - loss 2.18140179 - samples/sec: 315.09 - lr: 0.000244</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:32:07,850 epoch 54 - iter 3/17 - loss 2.23897684 - samples/sec: 282.39 - lr: 0.000244</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:32:07,966 epoch 54 - iter 4/17 - loss 2.10332695 - samples/sec: 279.99 - lr: 0.000244</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:32:08,088 epoch 54 - iter 5/17 - loss 2.13238862 - samples/sec: 263.80 - lr: 0.000244</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:32:08,206 epoch 54 - iter 6/17 - loss 2.24009635 - samples/sec: 273.54 - lr: 0.000244</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:32:08,329 epoch 54 - iter 7/17 - loss 2.30253548 - samples/sec: 269.00 - lr: 0.000244</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:32:08,433 epoch 54 - iter 8/17 - loss 2.18023707 - samples/sec: 313.01 - lr: 0.000244</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:32:08,562 epoch 54 - iter 9/17 - loss 2.13453245 - samples/sec: 250.65 - lr: 0.000244</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:32:08,672 epoch 54 - iter 10/17 - loss 2.19992437 - samples/sec: 292.82 - lr: 0.000244</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:32:08,787 epoch 54 - iter 11/17 - loss 2.15717849 - samples/sec: 281.81 - lr: 0.000244</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:32:08,893 epoch 54 - iter 12/17 - loss 2.14129857 - samples/sec: 307.05 - lr: 0.000244</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:32:08,999 epoch 54 - iter 13/17 - loss 2.16953674 - samples/sec: 304.10 - lr: 0.000244</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:32:09,107 epoch 54 - iter 14/17 - loss 2.17339781 - samples/sec: 297.71 - lr: 0.000244</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:32:09,219 epoch 54 - iter 15/17 - loss 2.16997722 - samples/sec: 289.97 - lr: 0.000244</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:32:09,325 epoch 54 - iter 16/17 - loss 2.14441101 - samples/sec: 305.37 - lr: 0.000244</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:32:09,402 epoch 54 - iter 17/17 - loss 2.09969692 - samples/sec: 418.75 - lr: 0.000244</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:32:09,404 ----------------------------------------------------------------------------------------------------</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:32:09,409 EPOCH 54 done: loss 2.0997 - lr 0.0002441</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:32:09,497 DEV : loss 1.8709750175476074 - score 0.9039</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:32:09,499 BAD EPOCHS (no improvement): 3</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:32:09,500 ----------------------------------------------------------------------------------------------------</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:32:09,620 epoch 55 - iter 1/17 - loss 1.90178788 - samples/sec: 272.99 - lr: 0.000244</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:32:09,728 epoch 55 - iter 2/17 - loss 1.98399633 - samples/sec: 301.43 - lr: 0.000244</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:32:09,841 epoch 55 - iter 3/17 - loss 1.99539125 - samples/sec: 285.31 - lr: 0.000244</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:32:09,953 epoch 55 - iter 4/17 - loss 1.90213764 - samples/sec: 289.10 - lr: 0.000244</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:32:10,065 epoch 55 - iter 5/17 - loss 1.96329775 - samples/sec: 288.70 - lr: 0.000244</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:32:10,176 epoch 55 - iter 6/17 - loss 1.96443625 - samples/sec: 292.03 - lr: 0.000244</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:32:10,288 epoch 55 - iter 7/17 - loss 2.03388395 - samples/sec: 286.98 - lr: 0.000244</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:32:10,409 epoch 55 - iter 8/17 - loss 2.09622708 - samples/sec: 269.29 - lr: 0.000244</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:32:10,530 epoch 55 - iter 9/17 - loss 2.17744046 - samples/sec: 266.37 - lr: 0.000244</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:32:10,645 epoch 55 - iter 10/17 - loss 2.20716212 - samples/sec: 281.23 - lr: 0.000244</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:32:10,762 epoch 55 - iter 11/17 - loss 2.20755792 - samples/sec: 275.91 - lr: 0.000244</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:32:10,885 epoch 55 - iter 12/17 - loss 2.21960968 - samples/sec: 261.72 - lr: 0.000244</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:32:10,988 epoch 55 - iter 13/17 - loss 2.20926589 - samples/sec: 320.85 - lr: 0.000244</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:32:11,106 epoch 55 - iter 14/17 - loss 2.12377312 - samples/sec: 272.30 - lr: 0.000244</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:32:11,211 epoch 55 - iter 15/17 - loss 2.13603848 - samples/sec: 308.71 - lr: 0.000244</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:32:11,316 epoch 55 - iter 16/17 - loss 2.14775415 - samples/sec: 309.65 - lr: 0.000244</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:32:11,392 epoch 55 - iter 17/17 - loss 2.12510460 - samples/sec: 423.90 - lr: 0.000244</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:32:11,394 ----------------------------------------------------------------------------------------------------</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:32:11,399 EPOCH 55 done: loss 2.1251 - lr 0.0002441</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:32:11,476 DEV : loss 1.8711307048797607 - score 0.9039</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Epoch    55: reducing learning rate of group 0 to 1.2207e-04.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:32:11,478 BAD EPOCHS (no improvement): 4</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:32:11,483 ----------------------------------------------------------------------------------------------------</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:32:11,597 epoch 56 - iter 1/17 - loss 2.13230896 - samples/sec: 287.93 - lr: 0.000122</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:32:11,706 epoch 56 - iter 2/17 - loss 2.16884816 - samples/sec: 300.55 - lr: 0.000122</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:32:11,813 epoch 56 - iter 3/17 - loss 2.14700532 - samples/sec: 299.71 - lr: 0.000122</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:32:11,925 epoch 56 - iter 4/17 - loss 2.10528451 - samples/sec: 289.35 - lr: 0.000122</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:32:12,042 epoch 56 - iter 5/17 - loss 2.02419295 - samples/sec: 275.70 - lr: 0.000122</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:32:12,150 epoch 56 - iter 6/17 - loss 2.09250812 - samples/sec: 302.22 - lr: 0.000122</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:32:12,257 epoch 56 - iter 7/17 - loss 1.99774071 - samples/sec: 302.23 - lr: 0.000122</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:32:12,380 epoch 56 - iter 8/17 - loss 1.98823553 - samples/sec: 262.22 - lr: 0.000122</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:32:12,478 epoch 56 - iter 9/17 - loss 2.01300555 - samples/sec: 329.48 - lr: 0.000122</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:32:12,603 epoch 56 - iter 10/17 - loss 1.96308876 - samples/sec: 260.03 - lr: 0.000122</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:32:12,722 epoch 56 - iter 11/17 - loss 2.12541857 - samples/sec: 270.64 - lr: 0.000122</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:32:12,831 epoch 56 - iter 12/17 - loss 2.09370079 - samples/sec: 299.12 - lr: 0.000122</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:32:12,934 epoch 56 - iter 13/17 - loss 2.14898827 - samples/sec: 312.36 - lr: 0.000122</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:32:13,042 epoch 56 - iter 14/17 - loss 2.11128387 - samples/sec: 299.37 - lr: 0.000122</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:32:13,149 epoch 56 - iter 15/17 - loss 2.12494528 - samples/sec: 303.02 - lr: 0.000122</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:32:13,262 epoch 56 - iter 16/17 - loss 2.16102227 - samples/sec: 286.20 - lr: 0.000122</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:32:13,333 epoch 56 - iter 17/17 - loss 2.14927550 - samples/sec: 456.69 - lr: 0.000122</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:32:13,335 ----------------------------------------------------------------------------------------------------</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:32:13,337 EPOCH 56 done: loss 2.1493 - lr 0.0001221</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:32:13,416 DEV : loss 1.8712515830993652 - score 0.9039</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:32:13,420 BAD EPOCHS (no improvement): 1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:32:13,423 ----------------------------------------------------------------------------------------------------</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:32:13,542 epoch 57 - iter 1/17 - loss 2.06140113 - samples/sec: 272.59 - lr: 0.000122</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:32:13,658 epoch 57 - iter 2/17 - loss 2.09485781 - samples/sec: 281.52 - lr: 0.000122</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:32:13,790 epoch 57 - iter 3/17 - loss 2.17190838 - samples/sec: 246.30 - lr: 0.000122</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:32:13,914 epoch 57 - iter 4/17 - loss 2.08750546 - samples/sec: 261.82 - lr: 0.000122</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:32:14,037 epoch 57 - iter 5/17 - loss 2.17361174 - samples/sec: 261.26 - lr: 0.000122</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:32:14,144 epoch 57 - iter 6/17 - loss 2.15775029 - samples/sec: 303.08 - lr: 0.000122</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:32:14,252 epoch 57 - iter 7/17 - loss 2.11520788 - samples/sec: 300.57 - lr: 0.000122</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:32:14,354 epoch 57 - iter 8/17 - loss 2.15911621 - samples/sec: 318.04 - lr: 0.000122</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:32:14,460 epoch 57 - iter 9/17 - loss 2.15239777 - samples/sec: 303.85 - lr: 0.000122</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:32:14,576 epoch 57 - iter 10/17 - loss 2.22143736 - samples/sec: 277.67 - lr: 0.000122</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:32:14,675 epoch 57 - iter 11/17 - loss 2.18487239 - samples/sec: 327.67 - lr: 0.000122</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:32:14,784 epoch 57 - iter 12/17 - loss 2.16919176 - samples/sec: 316.15 - lr: 0.000122</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:32:14,890 epoch 57 - iter 13/17 - loss 2.11041773 - samples/sec: 305.92 - lr: 0.000122</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:32:14,997 epoch 57 - iter 14/17 - loss 2.12899177 - samples/sec: 301.15 - lr: 0.000122</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:32:15,132 epoch 57 - iter 15/17 - loss 2.10911355 - samples/sec: 239.11 - lr: 0.000122</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:32:15,244 epoch 57 - iter 16/17 - loss 2.15161987 - samples/sec: 288.10 - lr: 0.000122</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:32:15,322 epoch 57 - iter 17/17 - loss 2.11003646 - samples/sec: 417.30 - lr: 0.000122</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:32:15,323 ----------------------------------------------------------------------------------------------------</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:32:15,328 EPOCH 57 done: loss 2.1100 - lr 0.0001221</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:32:15,407 DEV : loss 1.871190071105957 - score 0.9039</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:32:15,411 BAD EPOCHS (no improvement): 2</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:32:15,413 ----------------------------------------------------------------------------------------------------</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:32:15,520 epoch 58 - iter 1/17 - loss 2.92842674 - samples/sec: 303.98 - lr: 0.000122</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:32:15,634 epoch 58 - iter 2/17 - loss 2.42707694 - samples/sec: 281.85 - lr: 0.000122</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:32:15,771 epoch 58 - iter 3/17 - loss 2.23341076 - samples/sec: 237.25 - lr: 0.000122</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:32:15,892 epoch 58 - iter 4/17 - loss 2.20908457 - samples/sec: 265.75 - lr: 0.000122</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:32:16,007 epoch 58 - iter 5/17 - loss 2.17910295 - samples/sec: 283.48 - lr: 0.000122</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:32:16,104 epoch 58 - iter 6/17 - loss 2.05788509 - samples/sec: 333.94 - lr: 0.000122</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:32:16,215 epoch 58 - iter 7/17 - loss 2.08856239 - samples/sec: 289.41 - lr: 0.000122</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:32:16,330 epoch 58 - iter 8/17 - loss 2.14802042 - samples/sec: 281.15 - lr: 0.000122</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:32:16,439 epoch 58 - iter 9/17 - loss 2.17300524 - samples/sec: 297.83 - lr: 0.000122</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:32:16,537 epoch 58 - iter 10/17 - loss 2.16579535 - samples/sec: 332.77 - lr: 0.000122</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:32:16,665 epoch 58 - iter 11/17 - loss 2.21264616 - samples/sec: 251.48 - lr: 0.000122</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:32:16,770 epoch 58 - iter 12/17 - loss 2.19528157 - samples/sec: 306.98 - lr: 0.000122</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:32:16,885 epoch 58 - iter 13/17 - loss 2.11050682 - samples/sec: 282.85 - lr: 0.000122</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:32:16,993 epoch 58 - iter 14/17 - loss 2.14877816 - samples/sec: 298.19 - lr: 0.000122</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:32:17,100 epoch 58 - iter 15/17 - loss 2.20244874 - samples/sec: 302.51 - lr: 0.000122</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:32:17,200 epoch 58 - iter 16/17 - loss 2.16341272 - samples/sec: 323.63 - lr: 0.000122</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:32:17,270 epoch 58 - iter 17/17 - loss 2.08311685 - samples/sec: 465.62 - lr: 0.000122</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:32:17,271 ----------------------------------------------------------------------------------------------------</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:32:17,276 EPOCH 58 done: loss 2.0831 - lr 0.0001221</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:32:17,351 DEV : loss 1.8712575435638428 - score 0.9039</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:32:17,356 BAD EPOCHS (no improvement): 3</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:32:17,357 ----------------------------------------------------------------------------------------------------</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:32:17,470 epoch 59 - iter 1/17 - loss 3.57667923 - samples/sec: 288.24 - lr: 0.000122</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:32:17,570 epoch 59 - iter 2/17 - loss 2.45157045 - samples/sec: 324.19 - lr: 0.000122</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:32:17,685 epoch 59 - iter 3/17 - loss 2.40864130 - samples/sec: 279.59 - lr: 0.000122</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:32:17,793 epoch 59 - iter 4/17 - loss 2.30390897 - samples/sec: 301.24 - lr: 0.000122</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:32:17,896 epoch 59 - iter 5/17 - loss 2.12980967 - samples/sec: 314.40 - lr: 0.000122</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:32:18,015 epoch 59 - iter 6/17 - loss 2.18769928 - samples/sec: 275.16 - lr: 0.000122</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:32:18,123 epoch 59 - iter 7/17 - loss 2.13403550 - samples/sec: 301.61 - lr: 0.000122</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:32:18,230 epoch 59 - iter 8/17 - loss 2.11809765 - samples/sec: 299.58 - lr: 0.000122</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:32:18,340 epoch 59 - iter 9/17 - loss 2.08499732 - samples/sec: 293.75 - lr: 0.000122</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:32:18,452 epoch 59 - iter 10/17 - loss 2.08781813 - samples/sec: 292.03 - lr: 0.000122</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:32:18,565 epoch 59 - iter 11/17 - loss 2.06968793 - samples/sec: 287.39 - lr: 0.000122</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:32:18,690 epoch 59 - iter 12/17 - loss 2.08348020 - samples/sec: 257.11 - lr: 0.000122</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:32:18,812 epoch 59 - iter 13/17 - loss 2.08096592 - samples/sec: 265.63 - lr: 0.000122</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:32:18,914 epoch 59 - iter 14/17 - loss 2.06882810 - samples/sec: 317.14 - lr: 0.000122</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:32:19,041 epoch 59 - iter 15/17 - loss 2.13064247 - samples/sec: 256.00 - lr: 0.000122</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:32:19,150 epoch 59 - iter 16/17 - loss 2.16788667 - samples/sec: 297.97 - lr: 0.000122</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:32:19,222 epoch 59 - iter 17/17 - loss 2.12413386 - samples/sec: 451.70 - lr: 0.000122</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:32:19,223 ----------------------------------------------------------------------------------------------------</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:32:19,225 EPOCH 59 done: loss 2.1241 - lr 0.0001221</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:32:19,307 DEV : loss 1.8713274002075195 - score 0.9039</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Epoch    59: reducing learning rate of group 0 to 6.1035e-05.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:32:19,309 BAD EPOCHS (no improvement): 4</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:32:19,312 ----------------------------------------------------------------------------------------------------</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:32:19,313 ----------------------------------------------------------------------------------------------------</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:32:19,314 learning rate too small - quitting training!</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:32:19,316 ----------------------------------------------------------------------------------------------------</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:32:22,073 ----------------------------------------------------------------------------------------------------</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:32:22,074 Testing using best model ...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:32:22,075 loading file /content/best-model.pt</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:32:23,480 0.9176  0.9455  0.9313</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:32:23,481 </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Results:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">- F1-score (micro) 0.9313</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">- F1-score (macro) 0.7715</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">By class:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">-          tp: 0 - fp: 0 - fn: 1 - precision: 0.0000 - recall: 0.0000 - f1-score: 0.0000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">City       tp: 29 - fp: 2 - fn: 2 - precision: 0.9355 - recall: 0.9355 - f1-score: 0.9355</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Corporation tp: 13 - fp: 1 - fn: 1 - precision: 0.9286 - recall: 0.9286 - f1-score: 0.9286</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Country    tp: 11 - fp: 0 - fn: 0 - precision: 1.0000 - recall: 1.0000 - f1-score: 1.0000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">GivenName  tp: 7 - fp: 1 - fn: 0 - precision: 0.8750 - recall: 1.0000 - f1-score: 0.9333</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Household  tp: 9 - fp: 0 - fn: 1 - precision: 1.0000 - recall: 0.9000 - f1-score: 0.9474</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">MiddleName tp: 0 - fp: 2 - fn: 0 - precision: 0.0000 - recall: 0.0000 - f1-score: 0.0000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">State      tp: 29 - fp: 1 - fn: 1 - precision: 0.9667 - recall: 0.9667 - f1-score: 0.9667</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">StreetAddress tp: 28 - fp: 3 - fn: 3 - precision: 0.9032 - recall: 0.9032 - f1-score: 0.9032</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">SurName    tp: 7 - fp: 1 - fn: 0 - precision: 0.8750 - recall: 1.0000 - f1-score: 0.9333</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Zipcode    tp: 23 - fp: 3 - fn: 0 - precision: 0.8846 - recall: 1.0000 - f1-score: 0.9388</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:32:23,484 ----------------------------------------------------------------------------------------------------</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">{&#x27;dev_loss_history&#x27;: [5.717854976654053,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  7.014471054077148,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  6.267121315002441,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  4.367828369140625,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  7.306588172912598,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  3.1234371662139893,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  2.352734327316284,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  2.3950960636138916,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  2.601285934448242,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  2.621568202972412,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  2.6496293544769287,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  2.456434726715088,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  2.8066673278808594,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  2.356717109680176,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  2.2419240474700928,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  2.1843576431274414,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  2.249250888824463,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  2.1045773029327393,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  1.987985372543335,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  2.02628755569458,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  1.9274215698242188,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  1.9331698417663574,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  1.9181852340698242,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  1.9145869016647339,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  1.8926992416381836,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  1.829909324645996,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  1.877849817276001,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  1.8591759204864502,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  1.8752442598342896,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  1.8820831775665283,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  1.87209951877594,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  1.8655517101287842,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  1.860945701599121,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  1.8520863056182861,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  1.8610153198242188,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  1.8612797260284424,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  1.862546443939209,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  1.869424819946289,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  1.8706583976745605,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  1.8684940338134766,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  1.8697052001953125,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  1.8711341619491577,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  1.871195912361145,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  1.8707306385040283,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  1.8710083961486816,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  1.8702256679534912,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  1.8696794509887695,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  1.869992733001709,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  1.8705830574035645,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  1.8708758354187012,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  1.8709588050842285,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  1.8710246086120605,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  1.8710384368896484,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  1.8709750175476074,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  1.8711307048797607,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  1.8712515830993652,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  1.871190071105957,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  1.8712575435638428,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  1.8713274002075195],</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> &#x27;dev_score_history&#x27;: [0.8697916666666667,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  0.7978436657681941,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  0.7704918032786885,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  0.8491048593350384,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  0.8608923884514434,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  0.8808290155440414,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  0.8164383561643836,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  0.8911392405063291,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  0.8783068783068783,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  0.8877551020408163,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  0.9175257731958764,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  0.8571428571428572,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  0.8548387096774193,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  0.903896103896104,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  0.8963730569948186,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  0.8963730569948186,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  0.8911917098445595,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  0.8900523560209423,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  0.903896103896104,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  0.903896103896104,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  0.903896103896104,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  0.903896103896104,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  0.903896103896104,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  0.903896103896104,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  0.903896103896104,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  0.903896103896104,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  0.903896103896104,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  0.903896103896104,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  0.903896103896104,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  0.903896103896104,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  0.903896103896104,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  0.903896103896104,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  0.903896103896104,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  0.903896103896104,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  0.903896103896104,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  0.903896103896104,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  0.903896103896104,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  0.903896103896104,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  0.903896103896104,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  0.903896103896104,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  0.903896103896104,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  0.903896103896104,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  0.903896103896104,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  0.903896103896104,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  0.903896103896104,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  0.903896103896104,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  0.903896103896104,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  0.903896103896104,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  0.903896103896104,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  0.903896103896104,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  0.903896103896104,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  0.903896103896104,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  0.903896103896104,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  0.903896103896104,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  0.903896103896104,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  0.903896103896104,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  0.903896103896104,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  0.903896103896104,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  0.903896103896104],</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> &#x27;test_score&#x27;: 0.9313432835820895,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> &#x27;train_loss_history&#x27;: [9.025349981644574,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  6.609698015100816,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  6.332132143132827,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  5.108250505783978,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  5.506425955716302,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  3.8211376667022705,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  3.362795156591079,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  3.259746509439805,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  3.1422233791912304,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  3.286931914441726,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  3.1722532090018776,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  3.1396323021720436,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  2.9533899181029377,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  3.0463009301353905,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  2.8610909195507275,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  2.526246000738705,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  2.491676554960363,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  2.6032417311387905,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  2.377417711650624,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  2.386420453295988,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  2.244826681473676,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  2.190858244895935,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  2.267894345171311,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  2.218476274434258,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  2.264526696766124,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  2.204820352442124,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  2.123208859387566,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  2.1706547877367806,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  2.2194581031799316,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  2.2134850586161896,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  2.1507136681500603,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  2.1263834097806145,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  2.1835697889328003,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  2.2314544004552506,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  2.1594833345974194,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  2.1696282975813923,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  2.1386386717067047,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  2.0764440298080444,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  2.107362817315494,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  2.200913576518788,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  2.132053866105921,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  2.069297019173117,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  2.1372564610312965,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  2.084194351645077,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  2.1103776973836563,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  2.140008344369776,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  2.1633326095693253,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  2.1525954989825977,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  2.16026076148538,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  2.1881491226308487,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  2.152092737310073,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  2.076879515367396,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  2.1565780850017773,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  2.0996969166923973,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  2.1251045956331143,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  2.149275499231675,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  2.1100364572861614,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  2.0831168504322277,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  2.12413386036368]}</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><div class="codeBlockContainer_I0IT language-python theme-code-block"><div class="codeBlockContent_wNvx python"><pre tabindex="0" class="prism-code language-python codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> flair</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">data </span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> Sentence</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> flair</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">models </span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> SequenceTagger</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">model </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> SequenceTagger</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">load</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;/content/final-model.pt&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">text </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;&lt;redacted&gt;&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">sentence </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> Sentence</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">text</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">model</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">predict</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">sentence</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">out </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">for</span><span class="token plain"> entity </span><span class="token keyword" style="color:#00009f">in</span><span class="token plain"> sentence</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">get_spans</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;ner&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  out</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">entity</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">tag</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> entity</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">text</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 09:33:19,511 loading file /content/final-model.pt</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><div class="codeBlockContainer_I0IT language-python theme-code-block"><div class="codeBlockContent_wNvx python"><pre tabindex="0" class="prism-code language-python codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">tags </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&#x27;EntityType&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token string" style="color:#e3116c">&#x27;Recipient&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token string" style="color:#e3116c">&#x27;Address&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token string" style="color:#e3116c">&#x27;GivenName&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token string" style="color:#e3116c">&#x27;MiddleName&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token string" style="color:#e3116c">&#x27;SurName&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token string" style="color:#e3116c">&#x27;Household&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token string" style="color:#e3116c">&#x27;Corporation&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token string" style="color:#e3116c">&#x27;StreetAddress&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token string" style="color:#e3116c">&#x27;City&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token string" style="color:#e3116c">&#x27;State&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token string" style="color:#e3116c">&#x27;Zipcode&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token string" style="color:#e3116c">&#x27;Country&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;Confidence&#x27;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">PAD_TAIL </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;&lt;redacted&gt;&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">def</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">household_patch</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">row</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> row</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">EntityType</span><span class="token operator" style="color:#393A34">==</span><span class="token string" style="color:#e3116c">&#x27;Household&#x27;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    text </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> row</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">Household</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">split</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;&amp;&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;&amp;&#x27;</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">in</span><span class="token plain"> row</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">Household </span><span class="token keyword" style="color:#00009f">else</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27; &#x27;</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">join</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">row</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">Household</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">split</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">:</span><span class="token number" style="color:#36acaa">2</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    text </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> parseit</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">text</span><span class="token operator" style="color:#393A34">+</span><span class="token plain">PAD_TAIL</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    row</span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&#x27;GivenName&#x27;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> text</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">loc</span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">,</span><span class="token string" style="color:#e3116c">&#x27;GivenName&#x27;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    row</span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&#x27;SurName&#x27;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> text</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">loc</span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">,</span><span class="token string" style="color:#e3116c">&#x27;SurName&#x27;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    row</span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&#x27;MiddleName&#x27;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> text</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">loc</span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">,</span><span class="token string" style="color:#e3116c">&#x27;MiddleName&#x27;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> row</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">def</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">add_on</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">xx</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic"># Address is the combination of street, city, state, zip and country</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  xx</span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&#x27;Address&#x27;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> xx</span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&#x27;StreetAddress&#x27;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">+</span><span class="token string" style="color:#e3116c">&#x27; &#x27;</span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> xx</span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&#x27;City&#x27;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">+</span><span class="token string" style="color:#e3116c">&#x27; &#x27;</span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> xx</span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&#x27;State&#x27;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">+</span><span class="token string" style="color:#e3116c">&#x27; &#x27;</span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> xx</span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&#x27;Zipcode&#x27;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">+</span><span class="token string" style="color:#e3116c">&#x27; &#x27;</span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> xx</span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&#x27;Country&#x27;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic"># default is person, if household column is not empty, then household, same for corporation</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  xx</span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&#x27;EntityType&#x27;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;Person&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  xx</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">loc</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">xx</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">Household</span><span class="token operator" style="color:#393A34">!=</span><span class="token string" style="color:#e3116c">&#x27;&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token string" style="color:#e3116c">&#x27;EntityType&#x27;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;Household&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  xx</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">loc</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">xx</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">Corporation</span><span class="token operator" style="color:#393A34">!=</span><span class="token string" style="color:#e3116c">&#x27;&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token string" style="color:#e3116c">&#x27;EntityType&#x27;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;Corporation&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic"># default is full name of person, if entity is corporation ,then corporation name, same for household</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  xx</span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&#x27;Recipient&#x27;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> xx</span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&#x27;SurName&#x27;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">+</span><span class="token string" style="color:#e3116c">&#x27; &#x27;</span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> xx</span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&#x27;GivenName&#x27;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">+</span><span class="token string" style="color:#e3116c">&#x27; &#x27;</span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> xx</span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&#x27;MiddleName&#x27;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  xx</span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&#x27;Recipient&#x27;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> xx</span><span class="token punctuation" style="color:#393A34">.</span><span class="token builtin">apply</span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">lambda</span><span class="token plain"> row</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> row</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">Corporation </span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> row</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">EntityType</span><span class="token operator" style="color:#393A34">==</span><span class="token string" style="color:#e3116c">&#x27;Corporation&#x27;</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">else</span><span class="token plain"> row</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">Recipient</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> axis</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  xx</span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&#x27;Recipient&#x27;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> xx</span><span class="token punctuation" style="color:#393A34">.</span><span class="token builtin">apply</span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">lambda</span><span class="token plain"> row</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> row</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">Household </span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> row</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">EntityType</span><span class="token operator" style="color:#393A34">==</span><span class="token string" style="color:#e3116c">&#x27;Household&#x27;</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">else</span><span class="token plain"> row</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">Recipient</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> axis</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic"># adding household to name field patch</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  xx </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> xx</span><span class="token punctuation" style="color:#393A34">.</span><span class="token builtin">apply</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">household_patch</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> axis</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic"># converting to dictionary format</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  xx </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> xx</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">replace</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">r&#x27;^\s*$&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> np</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">nan</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> regex</span><span class="token operator" style="color:#393A34">=</span><span class="token boolean" style="color:#36acaa">True</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">dropna</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">axis</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> how</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&#x27;any&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  xx </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> xx</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">T</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">to_dict</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic"># return the processed data</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> xx</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">def</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">parseit</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">text</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  text </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token builtin">str</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">text</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">upper</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  text </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> re</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">sub</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;&quot;&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token string" style="color:#e3116c">&#x27;&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">text</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  text </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> re</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">sub</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;,&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token string" style="color:#e3116c">&#x27;&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">text</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  text </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27; &#x27;</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">join</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">text</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">split</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  output </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  sentence </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> Sentence</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">text</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  model</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">predict</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">sentence</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">for</span><span class="token plain"> entity </span><span class="token keyword" style="color:#00009f">in</span><span class="token plain"> sentence</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">get_spans</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;ner&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    output</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">entity</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">tag</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> entity</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">text</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  df </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> pd</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">DataFrame</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">output</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> index</span><span class="token operator" style="color:#393A34">=</span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  dfx </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> pd</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">DataFrame</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">columns</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">tags</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  dfx </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> dfx</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">append</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">df</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">fillna</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  dfx</span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&#x27;Confidence&#x27;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;,&#x27;</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">join</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">[</span><span class="token string-interpolation string" style="color:#e3116c">f&#x27;[</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">{</span><span class="token string-interpolation interpolation">x</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">.</span><span class="token string-interpolation interpolation">tag</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">}</span><span class="token string-interpolation string" style="color:#e3116c"> </span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">{</span><span class="token string-interpolation interpolation builtin">str</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">(</span><span class="token string-interpolation interpolation builtin">round</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">(</span><span class="token string-interpolation interpolation">x</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">.</span><span class="token string-interpolation interpolation">score</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">,</span><span class="token string-interpolation interpolation number" style="color:#36acaa">2</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">)</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">)</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">}</span><span class="token string-interpolation string" style="color:#e3116c">]&#x27;</span><span class="token keyword" style="color:#00009f">for</span><span class="token plain"> x </span><span class="token keyword" style="color:#00009f">in</span><span class="token plain"> sentence</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">get_spans</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;ner&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> dfx</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">def</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">func</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">text</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  X </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> parseit</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">text</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  X </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> add_on</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">X</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  X </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token builtin">str</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">X</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> X</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><div class="codeBlockContainer_I0IT language-python theme-code-block"><div class="codeBlockContent_wNvx python"><pre tabindex="0" class="prism-code language-python codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">func</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;&lt;redacted&gt;&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><div class="codeBlockContainer_I0IT language-python theme-code-block"><div class="codeBlockContent_wNvx python"><pre tabindex="0" class="prism-code language-python codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">!pip install </span><span class="token operator" style="color:#393A34">-</span><span class="token plain">q gradio</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> gradio </span><span class="token keyword" style="color:#00009f">as</span><span class="token plain"> gr</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">inputs </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> gr</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">inputs</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">Textbox</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">lines</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">3</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> label</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&#x27;Input&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">outputs </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> gr</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">outputs</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">Textbox</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">label</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&#x27;Output&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><div class="codeBlockContainer_I0IT language-python theme-code-block"><div class="codeBlockContent_wNvx python"><pre tabindex="0" class="prism-code language-python codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">gr</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">Interface</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">fn</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">func</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> inputs</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">inputs</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> outputs</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">outputs</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">launch</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><h2 class="anchor anchorWithStickyNavbar_mojV" id="api">API<a class="hash-link" href="#api" title="Direct link to heading">​</a></h2><div class="codeBlockContainer_I0IT language-python theme-code-block"><div class="codeBlockContent_wNvx python"><pre tabindex="0" class="prism-code language-python codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">!pip install </span><span class="token operator" style="color:#393A34">-</span><span class="token plain">q probablepeople</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">!pip install </span><span class="token operator" style="color:#393A34">-</span><span class="token plain">q usaddress</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><div class="codeBlockContainer_I0IT language-python theme-code-block"><div class="codeBlockContent_wNvx python"><pre tabindex="0" class="prism-code language-python codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> os</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> re</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> numpy </span><span class="token keyword" style="color:#00009f">as</span><span class="token plain"> np</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> pandas </span><span class="token keyword" style="color:#00009f">as</span><span class="token plain"> pd</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> tqdm </span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> tqdm</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> seaborn </span><span class="token keyword" style="color:#00009f">as</span><span class="token plain"> sns</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> matplotlib</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">pyplot </span><span class="token keyword" style="color:#00009f">as</span><span class="token plain"> plt</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">import</span><span class="token plain">  probablepeople </span><span class="token keyword" style="color:#00009f">as</span><span class="token plain"> pp</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> usaddress </span><span class="token keyword" style="color:#00009f">as</span><span class="token plain"> ua</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> warnings</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">warnings</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">filterwarnings</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;ignore&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">tqdm</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">pandas</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token operator" style="color:#393A34">%</span><span class="token plain">reload_ext autoreload</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token operator" style="color:#393A34">%</span><span class="token plain">autoreload </span><span class="token number" style="color:#36acaa">2</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token operator" style="color:#393A34">%</span><span class="token plain">reload_ext google</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">colab</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">data_table</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token operator" style="color:#393A34">%</span><span class="token plain">config InlineBackend</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">figure_format </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;retina&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">plt</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">style</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">use</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;fivethirtyeight&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">plt</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">style</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">use</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;seaborn-notebook&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><div class="codeBlockContainer_I0IT language-python theme-code-block"><div class="codeBlockContent_wNvx python"><pre tabindex="0" class="prism-code language-python codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">df </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> pd</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">read_pickle</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">os</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">path</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">join</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">path</span><span class="token punctuation" style="color:#393A34">,</span><span class="token string" style="color:#e3116c">&#x27;sample.p&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">data </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> df</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">oor</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">tolist</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">data</span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">:</span><span class="token number" style="color:#36acaa">10</span><span class="token punctuation" style="color:#393A34">]</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><div class="codeBlockContainer_I0IT language-python theme-code-block"><div class="codeBlockContent_wNvx python"><pre tabindex="0" class="prism-code language-python codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">def</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">patch_country</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">text</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  combos </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&#x27; US &#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token string" style="color:#e3116c">&#x27; USA &#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token string" style="color:#e3116c">&#x27; U.S. &#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token string" style="color:#e3116c">&#x27; U.S.A. &#x27;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  cflagz </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  otext </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> text</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  text </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> text</span><span class="token punctuation" style="color:#393A34">[</span><span class="token operator" style="color:#393A34">-</span><span class="token number" style="color:#36acaa">10</span><span class="token punctuation" style="color:#393A34">:</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  text </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27; &#x27;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> text </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27; &#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">for</span><span class="token plain"> i </span><span class="token keyword" style="color:#00009f">in</span><span class="token plain"> combos</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> i </span><span class="token keyword" style="color:#00009f">in</span><span class="token plain"> text</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      cflagz </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> i</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  text </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> otext</span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">:</span><span class="token operator" style="color:#393A34">-</span><span class="token number" style="color:#36acaa">10</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> re</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">sub</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">cflagz</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> text</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  cflagz </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> cflagz</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">strip</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> text</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> cflagz</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">def</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">patch_household</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">xz</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  xx </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> pd</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">DataFrame</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">pp</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">tag</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">xz</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> index</span><span class="token operator" style="color:#393A34">=</span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  xx</span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&#x27;Type&#x27;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;Person&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;And&#x27;</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">in</span><span class="token plain"> xx</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">columns</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">tolist</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    xx </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> pd</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">DataFrame</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">{</span><span class="token string" style="color:#e3116c">&#x27;Household&#x27;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain">xz</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> index</span><span class="token operator" style="color:#393A34">=</span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    xx</span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&#x27;Type&#x27;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;Household&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> xx</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">tags </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> pp</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">LABELS</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">tags</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">extend</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">ua</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">LABELS</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">tags </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token builtin">list</span><span class="token punctuation" style="color:#393A34">(</span><span class="token builtin">set</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">tags</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">additionals </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&#x27;CountryName&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;Household&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;Type&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">               </span><span class="token string" style="color:#e3116c">&#x27;NameConfidence&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;AddrConfidence&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;Text&#x27;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">tags</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">extend</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">additionals</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">dfx </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> pd</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">DataFrame</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">columns</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">tags</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">dfx </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> dfx</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">loc</span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">:</span><span class="token punctuation" style="color:#393A34">,</span><span class="token operator" style="color:#393A34">~</span><span class="token plain">dfx</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">columns</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">duplicated</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">]</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><div class="codeBlockContainer_I0IT language-python theme-code-block"><div class="codeBlockContent_wNvx python"><pre tabindex="0" class="prism-code language-python codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">def</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">process_text</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">text</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  text </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> re</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">sub</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;,&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token string" style="color:#e3116c">&#x27;&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">text</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  text </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27; &#x27;</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">join</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">text</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">split</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  text </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> re</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">sub</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;UNITED STATES OF AMERICA&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token string" style="color:#e3116c">&#x27;US&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">text</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  text </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> re</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">sub</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;TEXAS&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token string" style="color:#e3116c">&#x27;TX&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">text</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> text</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><div class="codeBlockContainer_I0IT language-python theme-code-block"><div class="codeBlockContent_wNvx python"><pre tabindex="0" class="prism-code language-python codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">def</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">temp</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">text</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  text </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> process_text</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">text</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  text</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> cflag </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> patch_country</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">text</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic"># address parsing</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">try</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    df1 </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> pd</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">DataFrame</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">ua</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">tag</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">text</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> index</span><span class="token operator" style="color:#393A34">=</span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    df1</span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&#x27;AddrConfidence&#x27;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> ua</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">tag</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">text</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">except</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    df1 </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> pd</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">DataFrame</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">ua</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">parse</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">text</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">groupby</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">agg</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">{</span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">lambda</span><span class="token plain"> x</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27; &#x27;</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">join</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">x</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">T</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    df1</span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&#x27;AddrConfidence&#x27;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;Error&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic"># address to name linking</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">try</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    xz </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> df1</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">Recipient</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">values</span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">except</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    xz </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> text</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic"># name parsing</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">try</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    df2 </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> pd</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">DataFrame</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">pp</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">tag</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">xz</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> index</span><span class="token operator" style="color:#393A34">=</span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    df2</span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&#x27;NameConfidence&#x27;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> pp</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">tag</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">xz</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">except</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    df2 </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> pd</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">DataFrame</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">pp</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">parse</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">xz</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">groupby</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">agg</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">{</span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">lambda</span><span class="token plain"> x</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27; &#x27;</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">join</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">x</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">T</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    df2</span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&#x27;NameConfidence&#x27;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;Error&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  df2</span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&#x27;Type&#x27;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;Person&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic"># household name patch</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;And&#x27;</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">in</span><span class="token plain"> df2</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">columns</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">tolist</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    df2 </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> pd</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">DataFrame</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">{</span><span class="token string" style="color:#e3116c">&#x27;Household&#x27;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain">xz</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> index</span><span class="token operator" style="color:#393A34">=</span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    df2</span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&#x27;Type&#x27;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;Household&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic"># concatenation</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  df </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> pd</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">concat</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">df1</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">df2</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> axis</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  df</span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&#x27;Text&#x27;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> text  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  df</span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&#x27;CountryName&#x27;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> cflag </span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> cflag</span><span class="token operator" style="color:#393A34">!=</span><span class="token string" style="color:#e3116c">&#x27;&#x27;</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">else</span><span class="token plain"> np</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">NaN</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  dfx </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> pd</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">DataFrame</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">columns</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">tags</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  dfx </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> dfx</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">loc</span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">:</span><span class="token punctuation" style="color:#393A34">,</span><span class="token operator" style="color:#393A34">~</span><span class="token plain">dfx</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">columns</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">duplicated</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  df </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> dfx</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">append</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">df</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  df </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> df</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">fillna</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  df</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">loc</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">df</span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&#x27;CorporationName&#x27;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token operator" style="color:#393A34">!=</span><span class="token string" style="color:#e3116c">&#x27;&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;Type&#x27;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;Corporation&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">df</span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&#x27;MiddleInitial&#x27;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">]</span><span class="token operator" style="color:#393A34">==</span><span class="token string" style="color:#e3116c">&#x27;&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&amp;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">df</span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&#x27;MiddleName&#x27;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">]</span><span class="token operator" style="color:#393A34">!=</span><span class="token string" style="color:#e3116c">&#x27;&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    gname</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> mname</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> sname </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> df</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">MiddleName</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> df</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">Surname</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> df</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">GivenName</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    df</span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&#x27;MiddleName&#x27;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> df</span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&#x27;Surname&#x27;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> dfx</span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&#x27;GivenName&#x27;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> mname</span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> sname</span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> gname</span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic"># elif (df[&#x27;MiddleInitial&#x27;][0]==&#x27;&#x27;) &amp; (df[&#x27;MiddleName&#x27;][0]==&#x27;&#x27;):</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic">#   gname, sname = df.Surname, df.GivenName</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic">#   df[&#x27;Surname&#x27;], df[&#x27;GivenName&#x27;] = sname[0], gname[0]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> df</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><div class="codeBlockContainer_I0IT language-python theme-code-block"><div class="codeBlockContent_wNvx python"><pre tabindex="0" class="prism-code language-python codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">tagmap </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> pd</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">read_excel</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">os</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">path</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">join</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">path</span><span class="token punctuation" style="color:#393A34">,</span><span class="token string" style="color:#e3116c">&#x27;tag_map.xlsx&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">reset_index</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">tagmap</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">columns </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&#x27;_&#x27;</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">join</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">col</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">split</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">for</span><span class="token plain"> col </span><span class="token keyword" style="color:#00009f">in</span><span class="token plain"> tagmap</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">columns</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">tagmap</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">tagmap </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> pd</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">melt</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">tagmap</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> id_vars</span><span class="token operator" style="color:#393A34">=</span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&#x27;index&#x27;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> value_vars</span><span class="token operator" style="color:#393A34">=</span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&#x27;FIRSTNAME&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token string" style="color:#e3116c">&#x27;MIDDLENAME&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token string" style="color:#e3116c">&#x27;LASTNAME&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                                                        </span><span class="token string" style="color:#e3116c">&#x27;OTHERNAME&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token string" style="color:#e3116c">&#x27;HOUSEHOLD&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token string" style="color:#e3116c">&#x27;CORPORATION&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                                                        </span><span class="token string" style="color:#e3116c">&#x27;STREET_ADDRESS&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;CITY&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;STATE&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;PINCODE&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                                                        </span><span class="token string" style="color:#e3116c">&#x27;COUNTRY&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;META&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;OTHER&#x27;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">dropna</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&#x27;variable&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token string" style="color:#e3116c">&#x27;value&#x27;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">set_index</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;value&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">to_dict</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&#x27;variable&#x27;</span><span class="token punctuation" style="color:#393A34">]</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><div class="codeBlockContainer_I0IT language-python theme-code-block"><div class="codeBlockContent_wNvx python"><pre tabindex="0" class="prism-code language-python codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">def</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">custom_patch</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">text</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  text </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> re</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">sub</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27; DALLA S &#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27; DALLAS &#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> text</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  text </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> re</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">sub</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27; PRAIRI E &#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27; PRAIRIE &#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> text</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  text </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> re</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">sub</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27; EL PAS O &#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27; EL PASO &#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> text</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  text </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> re</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">sub</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27; SAN ANT ONIO &#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27; SAN ANTONIO &#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> text</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  text </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> re</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">sub</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27; THE WOODL ANDS &#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27; THE WOODLANDS &#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> text</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  text </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> re</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">sub</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27; FORT WORT H &#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27; FORT WORTH &#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> text</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  text </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> re</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">sub</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27; ARLINGTO N &#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27; ARLINGTON &#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> text</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  text </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> re</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">sub</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27; SOCORR O &#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27; SOCORRO &#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> text</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  text </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> re</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">sub</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27; HURS T &#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27; HURST &#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> text</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  text </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> re</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">sub</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27; HOLLYWOO D &#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27; HOLLYWOOD &#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> text</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> text</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><div class="codeBlockContainer_I0IT language-python theme-code-block"><div class="codeBlockContent_wNvx python"><pre tabindex="0" class="prism-code language-python codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">def</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">oor_api</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">text</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  texto </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> text</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  xx </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> temp</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">text</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  xx</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">columns </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> xx</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">columns</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">to_series</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token builtin">map</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">tagmap</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  xx </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> xx</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">drop</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;META&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> axis</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  xx </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> xx</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">replace</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">r&#x27;^\s*$&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> np</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">nan</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> regex</span><span class="token operator" style="color:#393A34">=</span><span class="token boolean" style="color:#36acaa">True</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">dropna</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">axis</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> how</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&#x27;any&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">try</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    xx</span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&#x27;PINCODE&#x27;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> xx</span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&#x27;PINCODE&#x27;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">.</span><span class="token builtin">apply</span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">lambda</span><span class="token plain"> x</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> re</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">sub</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27; &#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token string" style="color:#e3116c">&#x27;&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">x</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">except</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">pass</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  xx </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> xx</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">T</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  xx </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> xx</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">reset_index</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  xx</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">index </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> xx</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">index</span><span class="token punctuation" style="color:#393A34">.</span><span class="token builtin">map</span><span class="token punctuation" style="color:#393A34">(</span><span class="token builtin">str</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  xx </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27; &#x27;</span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> xx </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27; &#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  xx</span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> xx</span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">.</span><span class="token builtin">apply</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">custom_patch</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  xx </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> xx</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">to_dict</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  label2tag </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token builtin">str</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">v</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27; &#x27;</span><span class="token operator" style="color:#393A34">+</span><span class="token builtin">str</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">k</span><span class="token punctuation" style="color:#393A34">)</span><span class="token operator" style="color:#393A34">+</span><span class="token string" style="color:#e3116c">&#x27; &#x27;</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">for</span><span class="token plain"> k</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> v </span><span class="token keyword" style="color:#00009f">in</span><span class="token plain"> xx</span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">items</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  text </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> process_text</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">text</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  text </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27; &#x27;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> text </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27; &#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">for</span><span class="token plain"> key</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> value </span><span class="token keyword" style="color:#00009f">in</span><span class="token plain"> label2tag</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">items</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    text </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> text</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">replace</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">key</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> value</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  x </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> pd</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">DataFrame</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">{</span><span class="token string" style="color:#e3116c">&#x27;entity&#x27;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain">text</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">split</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;tag&#x27;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain">text</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">split</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  x </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> x</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">replace</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">{</span><span class="token string" style="color:#e3116c">&#x27;entity&#x27;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> xx</span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;tag&#x27;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> xx</span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&#x27;index&#x27;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  x</span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&#x27;entity&#x27;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> x</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">groupby</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&#x27;tag&#x27;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&#x27;entity&#x27;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">transform</span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">lambda</span><span class="token plain"> x</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27; &#x27;</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">join</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">x</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  x </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> x</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">drop_duplicates</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  x</span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&#x27;tag&#x27;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> x</span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&#x27;tag&#x27;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">.</span><span class="token builtin">apply</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">process_text</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  x</span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&#x27;entity&#x27;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> x</span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&#x27;entity&#x27;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">.</span><span class="token builtin">apply</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">process_text</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  x </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> x</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">append</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">pd</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">Series</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">{</span><span class="token string" style="color:#e3116c">&#x27;tag&#x27;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token string" style="color:#e3116c">&#x27;TEXT&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token string" style="color:#e3116c">&#x27;entity&#x27;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain">texto</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> ignore_index</span><span class="token operator" style="color:#393A34">=</span><span class="token boolean" style="color:#36acaa">True</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  x </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> x</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">set_index</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;tag&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  x </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> x</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">to_dict</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&#x27;entity&#x27;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> x</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><div class="codeBlockContainer_I0IT language-python theme-code-block"><div class="codeBlockContent_wNvx python"><pre tabindex="0" class="prism-code language-python codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># zz = data[5]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># oor_api(zz)</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><div class="codeBlockContainer_I0IT language-python theme-code-block"><div class="codeBlockContent_wNvx python"><pre tabindex="0" class="prism-code language-python codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">oor_cols </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&#x27;TEXT&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token string" style="color:#e3116c">&#x27;FIRSTNAME&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token string" style="color:#e3116c">&#x27;MIDDLENAME&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token string" style="color:#e3116c">&#x27;LASTNAME&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;OTHERNAME&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;HOUSEHOLD&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token string" style="color:#e3116c">&#x27;CORPORATION&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;STREET_ADDRESS&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;CITY&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;STATE&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;PINCODE&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;COUNTRY&#x27;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">dfx </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> pd</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">DataFrame</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">columns</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">oor_cols</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">for</span><span class="token plain"> idx</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> text </span><span class="token keyword" style="color:#00009f">in</span><span class="token plain"> tqdm</span><span class="token punctuation" style="color:#393A34">(</span><span class="token builtin">enumerate</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">data</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  dfx </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> dfx</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">append</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">pd</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">DataFrame</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">oor_api</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">text</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> index</span><span class="token operator" style="color:#393A34">=</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">idx</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">dfx </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> dfx</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">fillna</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">dfx </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> dfx</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">oor_cols</span><span class="token punctuation" style="color:#393A34">]</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">1000it [01:03, 15.75it/s]</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><div class="codeBlockContainer_I0IT language-python theme-code-block"><div class="codeBlockContent_wNvx python"><pre tabindex="0" class="prism-code language-python codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">dfx </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> dfx</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">replace</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">r&#x27;^\s*$&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> np</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">nan</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> regex</span><span class="token operator" style="color:#393A34">=</span><span class="token boolean" style="color:#36acaa">True</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><div class="codeBlockContainer_I0IT language-python theme-code-block"><div class="codeBlockContent_wNvx python"><pre tabindex="0" class="prism-code language-python codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">dfx</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">info</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">&lt;class &#x27;pandas.core.frame.DataFrame&#x27;&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Int64Index: 1000 entries, 0 to 999</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Data columns (total 12 columns):</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> #   Column          Non-Null Count  Dtype </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">---  ------          --------------  ----- </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 0   TEXT            997 non-null    object</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 1   FIRSTNAME       403 non-null    object</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 2   MIDDLENAME      155 non-null    object</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 3   LASTNAME        324 non-null    object</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 4   OTHERNAME       9 non-null      object</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 5   HOUSEHOLD       199 non-null    object</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 6   CORPORATION     364 non-null    object</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 7   STREET_ADDRESS  976 non-null    object</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 8   CITY            870 non-null    object</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 9   STATE           954 non-null    object</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 10  PINCODE         838 non-null    object</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 11  COUNTRY         288 non-null    object</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">dtypes: object(12)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">memory usage: 101.6+ KB</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><div class="codeBlockContainer_I0IT language-python theme-code-block"><div class="codeBlockContent_wNvx python"><pre tabindex="0" class="prism-code language-python codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">dfx</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">to_csv</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;x.csv&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><div class="codeBlockContainer_I0IT language-python theme-code-block"><div class="codeBlockContent_wNvx python"><pre tabindex="0" class="prism-code language-python codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">x </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;&lt;redacted&gt;&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">temp</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">x</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">T</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">replace</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">np</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">nan</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">dropna</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><div class="codeBlockContainer_I0IT language-python theme-code-block"><div class="codeBlockContent_wNvx python"><pre tabindex="0" class="prism-code language-python codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">oor_api</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">x</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><h2 class="anchor anchorWithStickyNavbar_mojV" id="deliverables">Deliverables<a class="hash-link" href="#deliverables" title="Direct link to heading">​</a></h2><div class="codeBlockContainer_I0IT language-python theme-code-block"><div class="codeBlockContent_wNvx python"><pre tabindex="0" class="prism-code language-python codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># !pip install cookiecutter</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># !cookiecutter https://github.com/drivendata/cookiecutter-data-science</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><div class="codeBlockContainer_I0IT language-python theme-code-block"><div class="codeBlockContent_wNvx python"><pre tabindex="0" class="prism-code language-python codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">imports _requirements</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">txt_</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">!pip install flair</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><div class="codeBlockContainer_I0IT language-python theme-code-block"><div class="codeBlockContent_wNvx python"><pre tabindex="0" class="prism-code language-python codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># utils</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> pandas </span><span class="token keyword" style="color:#00009f">as</span><span class="token plain"> pd</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">tags </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&#x27;EntityType&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token string" style="color:#e3116c">&#x27;Recipient&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token string" style="color:#e3116c">&#x27;Address&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token string" style="color:#e3116c">&#x27;GivenName&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token string" style="color:#e3116c">&#x27;MiddleName&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token string" style="color:#e3116c">&#x27;SurName&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token string" style="color:#e3116c">&#x27;Household&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token string" style="color:#e3116c">&#x27;Corporation&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token string" style="color:#e3116c">&#x27;StreetAddress&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token string" style="color:#e3116c">&#x27;City&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token string" style="color:#e3116c">&#x27;State&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token string" style="color:#e3116c">&#x27;Zipcode&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token string" style="color:#e3116c">&#x27;Country&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;Confidence&#x27;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">name_tags </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&#x27;EntityType&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token string" style="color:#e3116c">&#x27;Recipient&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;GivenName&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token string" style="color:#e3116c">&#x27;MiddleName&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token string" style="color:#e3116c">&#x27;SurName&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token string" style="color:#e3116c">&#x27;Household&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token string" style="color:#e3116c">&#x27;Corporation&#x27;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">addr_tags </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&#x27;Address&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token string" style="color:#e3116c">&#x27;StreetAddress&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token string" style="color:#e3116c">&#x27;City&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token string" style="color:#e3116c">&#x27;State&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token string" style="color:#e3116c">&#x27;Zipcode&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token string" style="color:#e3116c">&#x27;Country&#x27;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">PAD_TAIL </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;&lt;redacted&gt;&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">PAD_HEAD </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;&lt;redacted&gt;&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">def</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">household_patch</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">row</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> row</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">EntityType</span><span class="token operator" style="color:#393A34">==</span><span class="token string" style="color:#e3116c">&#x27;Household&#x27;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    text </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> row</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">Household</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">split</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;&amp;&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;&amp;&#x27;</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">in</span><span class="token plain"> row</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">Household </span><span class="token keyword" style="color:#00009f">else</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27; &#x27;</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">join</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">row</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">Household</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">split</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">:</span><span class="token number" style="color:#36acaa">2</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    text </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> parseit</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">text</span><span class="token operator" style="color:#393A34">+</span><span class="token plain">PAD_TAIL</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    row</span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&#x27;GivenName&#x27;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> text</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">loc</span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">,</span><span class="token string" style="color:#e3116c">&#x27;GivenName&#x27;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    row</span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&#x27;SurName&#x27;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> text</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">loc</span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">,</span><span class="token string" style="color:#e3116c">&#x27;SurName&#x27;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    row</span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&#x27;MiddleName&#x27;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> text</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">loc</span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">,</span><span class="token string" style="color:#e3116c">&#x27;MiddleName&#x27;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> row</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">def</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">add_on</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">xx</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic"># Address is the combination of street, city, state, zip and country</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  xx</span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&#x27;Address&#x27;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> xx</span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&#x27;StreetAddress&#x27;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">+</span><span class="token string" style="color:#e3116c">&#x27; &#x27;</span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> xx</span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&#x27;City&#x27;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">+</span><span class="token string" style="color:#e3116c">&#x27; &#x27;</span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> xx</span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&#x27;State&#x27;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">+</span><span class="token string" style="color:#e3116c">&#x27; &#x27;</span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> xx</span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&#x27;Zipcode&#x27;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">+</span><span class="token string" style="color:#e3116c">&#x27; &#x27;</span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> xx</span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&#x27;Country&#x27;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic"># default is person, if household column is not empty, then household, same for corporation</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  xx</span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&#x27;EntityType&#x27;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;Person&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  xx</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">loc</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">xx</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">Household</span><span class="token operator" style="color:#393A34">!=</span><span class="token string" style="color:#e3116c">&#x27;&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token string" style="color:#e3116c">&#x27;EntityType&#x27;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;Household&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  xx</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">loc</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">xx</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">Corporation</span><span class="token operator" style="color:#393A34">!=</span><span class="token string" style="color:#e3116c">&#x27;&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token string" style="color:#e3116c">&#x27;EntityType&#x27;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;Corporation&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic"># default is full name of person, if entity is corporation ,then corporation name, same for household</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  xx</span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&#x27;Recipient&#x27;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> xx</span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&#x27;SurName&#x27;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">+</span><span class="token string" style="color:#e3116c">&#x27; &#x27;</span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> xx</span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&#x27;GivenName&#x27;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">+</span><span class="token string" style="color:#e3116c">&#x27; &#x27;</span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> xx</span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&#x27;MiddleName&#x27;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  xx</span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&#x27;Recipient&#x27;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> xx</span><span class="token punctuation" style="color:#393A34">.</span><span class="token builtin">apply</span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">lambda</span><span class="token plain"> row</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> row</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">Corporation </span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> row</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">EntityType</span><span class="token operator" style="color:#393A34">==</span><span class="token string" style="color:#e3116c">&#x27;Corporation&#x27;</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">else</span><span class="token plain"> row</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">Recipient</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> axis</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  xx</span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&#x27;Recipient&#x27;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> xx</span><span class="token punctuation" style="color:#393A34">.</span><span class="token builtin">apply</span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">lambda</span><span class="token plain"> row</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> row</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">Household </span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> row</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">EntityType</span><span class="token operator" style="color:#393A34">==</span><span class="token string" style="color:#e3116c">&#x27;Household&#x27;</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">else</span><span class="token plain"> row</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">Recipient</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> axis</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic"># adding household to name field patch</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  xx </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> xx</span><span class="token punctuation" style="color:#393A34">.</span><span class="token builtin">apply</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">household_patch</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> axis</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic"># converting to dictionary format</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  xx </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> xx</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">replace</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">r&#x27;^\s*$&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> np</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">nan</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> regex</span><span class="token operator" style="color:#393A34">=</span><span class="token boolean" style="color:#36acaa">True</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">dropna</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">axis</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> how</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&#x27;any&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic"># return the processed data</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> xx</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><div class="codeBlockContainer_I0IT language-python theme-code-block"><div class="codeBlockContent_wNvx python"><pre tabindex="0" class="prism-code language-python codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># pred</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> re</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> numpy </span><span class="token keyword" style="color:#00009f">as</span><span class="token plain"> np</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> pandas </span><span class="token keyword" style="color:#00009f">as</span><span class="token plain"> pd</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> flair</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">data </span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> Sentence</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> flair</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">models </span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> SequenceTagger</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">model </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> SequenceTagger</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">load</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;models/final-model.pt&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">def</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">_parse</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">text</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  text </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token builtin">str</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">text</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">upper</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  text </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> re</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">sub</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;&quot;&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token string" style="color:#e3116c">&#x27;&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">text</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  text </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> re</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">sub</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;,&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token string" style="color:#e3116c">&#x27;&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">text</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  text </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27; &#x27;</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">join</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">text</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">split</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  output </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  sentence </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> Sentence</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">text</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  model</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">predict</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">sentence</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">for</span><span class="token plain"> entity </span><span class="token keyword" style="color:#00009f">in</span><span class="token plain"> sentence</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">get_spans</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;ner&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    output</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">entity</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">tag</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> entity</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">text</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  df </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> pd</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">DataFrame</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">output</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> index</span><span class="token operator" style="color:#393A34">=</span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  dfx </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> pd</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">DataFrame</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">columns</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">tags</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  dfx </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> dfx</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">append</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">df</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">fillna</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  dfx</span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&#x27;Confidence&#x27;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;,&#x27;</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">join</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">[</span><span class="token string-interpolation string" style="color:#e3116c">f&#x27;[</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">{</span><span class="token string-interpolation interpolation">x</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">.</span><span class="token string-interpolation interpolation">tag</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">}</span><span class="token string-interpolation string" style="color:#e3116c"> </span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">{</span><span class="token string-interpolation interpolation builtin">str</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">(</span><span class="token string-interpolation interpolation builtin">round</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">(</span><span class="token string-interpolation interpolation">x</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">.</span><span class="token string-interpolation interpolation">score</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">,</span><span class="token string-interpolation interpolation number" style="color:#36acaa">2</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">)</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">)</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">}</span><span class="token string-interpolation string" style="color:#e3116c">]&#x27;</span><span class="token keyword" style="color:#00009f">for</span><span class="token plain"> x </span><span class="token keyword" style="color:#00009f">in</span><span class="token plain"> sentence</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">get_spans</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;ner&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> dfx</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-11 13:02:40,896 loading file models/final-model.pt</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><div class="codeBlockContainer_I0IT language-python theme-code-block"><div class="codeBlockContent_wNvx python"><pre tabindex="0" class="prism-code language-python codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">def</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">_predict</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">text</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  X </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> _parse</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">text</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  X </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> add_on</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">X</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  X </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> X</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">T</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">to_dict</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> X</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">def</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">_predict_name</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">text</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  text </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> text </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> PAD_TAIL</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  X </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> _parse</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">text</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  X </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> add_on</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">X</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  rqd_cols </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token builtin">list</span><span class="token punctuation" style="color:#393A34">(</span><span class="token builtin">set</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">X</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">columns</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&amp;</span><span class="token plain"> </span><span class="token builtin">set</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">name_tags</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  X </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> X</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">rqd_cols</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  X </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> X</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">T</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">to_dict</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> X</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">def</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">_predict_address</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">text</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  text </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> PAD_HEAD </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> text</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  X </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> _parse</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">text</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  X </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> add_on</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">X</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  rqd_cols </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token builtin">list</span><span class="token punctuation" style="color:#393A34">(</span><span class="token builtin">set</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">X</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">columns</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&amp;</span><span class="token plain"> </span><span class="token builtin">set</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">addr_tags</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  X </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> X</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">rqd_cols</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  X </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> X</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">T</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">to_dict</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> X</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><div class="codeBlockContainer_I0IT language-python theme-code-block"><div class="codeBlockContent_wNvx python"><pre tabindex="0" class="prism-code language-python codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># app</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">_predict</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;&lt;redacted&gt;&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><hr><div class="codeBlockContainer_I0IT language-python theme-code-block"><div class="codeBlockContent_wNvx python"><pre tabindex="0" class="prism-code language-python codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token operator" style="color:#393A34">%</span><span class="token operator" style="color:#393A34">%</span><span class="token plain">writefile src</span><span class="token operator" style="color:#393A34">/</span><span class="token plain">app</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">py</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> re</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> time</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> numpy </span><span class="token keyword" style="color:#00009f">as</span><span class="token plain"> np</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> pandas </span><span class="token keyword" style="color:#00009f">as</span><span class="token plain"> pd</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> pathlib </span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> Path</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> flair</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">data </span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> Sentence</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> flair</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">models </span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> SequenceTagger</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> utils </span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">*</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> model </span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> loadmodel</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">path </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> Path</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">__file__</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">_PPATH </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token builtin">str</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">path</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">parents</span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">)</span><span class="token operator" style="color:#393A34">+</span><span class="token string" style="color:#e3116c">&#x27;/&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">start_time </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> time</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">time</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">model </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> loadmodel</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">finalmodel</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">print</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;---Encoder--- %s seconds ---&quot;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">%</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">time</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">time</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">-</span><span class="token plain"> start_time</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">def</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">_parse</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">text</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  text </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token builtin">str</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">text</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">upper</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  text </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> re</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">sub</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;&quot;&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token string" style="color:#e3116c">&#x27;&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">text</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  text </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> re</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">sub</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;,&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token string" style="color:#e3116c">&#x27;&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">text</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  text </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27; &#x27;</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">join</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">text</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">split</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  output </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  sentence </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> Sentence</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">text</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  model</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">predict</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">sentence</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">for</span><span class="token plain"> entity </span><span class="token keyword" style="color:#00009f">in</span><span class="token plain"> sentence</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">get_spans</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;ner&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    output</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">entity</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">tag</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> entity</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">text</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  df </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> pd</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">DataFrame</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">output</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> index</span><span class="token operator" style="color:#393A34">=</span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  dfx </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> pd</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">DataFrame</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">columns</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">tags</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  dfx </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> dfx</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">append</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">df</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">fillna</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  dfx</span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&#x27;Confidence&#x27;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;,&#x27;</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">join</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">[</span><span class="token string-interpolation string" style="color:#e3116c">f&#x27;[</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">{</span><span class="token string-interpolation interpolation">x</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">.</span><span class="token string-interpolation interpolation">tag</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">}</span><span class="token string-interpolation string" style="color:#e3116c"> </span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">{</span><span class="token string-interpolation interpolation builtin">str</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">(</span><span class="token string-interpolation interpolation builtin">round</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">(</span><span class="token string-interpolation interpolation">x</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">.</span><span class="token string-interpolation interpolation">score</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">,</span><span class="token string-interpolation interpolation number" style="color:#36acaa">2</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">)</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">)</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">}</span><span class="token string-interpolation string" style="color:#e3116c">]&#x27;</span><span class="token keyword" style="color:#00009f">for</span><span class="token plain"> x </span><span class="token keyword" style="color:#00009f">in</span><span class="token plain"> sentence</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">get_spans</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;ner&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> dfx</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">def</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">_predict</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">text</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  X </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> _parse</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">text</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  X </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> add_on</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">X</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  X </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> X</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">T</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">to_dict</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> X</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">def</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">_predict_name</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">text</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  text </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> text </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> PAD_TAIL</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  X </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> _parse</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">text</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  X </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> add_on</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">X</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  rqd_cols </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token builtin">list</span><span class="token punctuation" style="color:#393A34">(</span><span class="token builtin">set</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">X</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">columns</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&amp;</span><span class="token plain"> </span><span class="token builtin">set</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">name_tags</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  X </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> X</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">rqd_cols</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  X </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> X</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">T</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">to_dict</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> X</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">def</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">_predict_address</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">text</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  text </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> PAD_HEAD </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> text</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  X </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> _parse</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">text</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  X </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> add_on</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">X</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  rqd_cols </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token builtin">list</span><span class="token punctuation" style="color:#393A34">(</span><span class="token builtin">set</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">X</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">columns</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&amp;</span><span class="token plain"> </span><span class="token builtin">set</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">addr_tags</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  X </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> X</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">rqd_cols</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  X </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> X</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">T</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">to_dict</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> X</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">########## FLASK API ##########</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> flask </span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> Flask</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> request</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> jsonify</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> send_file</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> json</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">app </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> Flask</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">__name__</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token decorator annotation punctuation" style="color:#393A34">@app</span><span class="token decorator annotation punctuation" style="color:#393A34">.</span><span class="token decorator annotation punctuation" style="color:#393A34">route</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;/oor&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> methods</span><span class="token operator" style="color:#393A34">=</span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&quot;POST&quot;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">def</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">parse_oor</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  req_data </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> request</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">get_json</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  text </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> req_data</span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&#x27;query&#x27;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  preds </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> _predict</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">text</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> jsonify</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">preds</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token decorator annotation punctuation" style="color:#393A34">@app</span><span class="token decorator annotation punctuation" style="color:#393A34">.</span><span class="token decorator annotation punctuation" style="color:#393A34">route</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;/name&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> methods</span><span class="token operator" style="color:#393A34">=</span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&quot;POST&quot;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">def</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">parse_name</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  req_data </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> request</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">get_json</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  text </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> req_data</span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&#x27;query&#x27;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  preds </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> _predict_name</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">text</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> jsonify</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">preds</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token decorator annotation punctuation" style="color:#393A34">@app</span><span class="token decorator annotation punctuation" style="color:#393A34">.</span><span class="token decorator annotation punctuation" style="color:#393A34">route</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;/address&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> methods</span><span class="token operator" style="color:#393A34">=</span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&quot;POST&quot;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">def</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">parse_address</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  req_data </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> request</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">get_json</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  text </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> req_data</span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&#x27;query&#x27;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  preds </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> _predict_address</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">text</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> jsonify</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">preds</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> __name__ </span><span class="token operator" style="color:#393A34">==</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;__main__&quot;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    app</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">run</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">port</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">5000</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> debug</span><span class="token operator" style="color:#393A34">=</span><span class="token boolean" style="color:#36acaa">True</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">Overwriting src/app.py</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><div class="codeBlockContainer_I0IT language-python theme-code-block"><div class="codeBlockContent_wNvx python"><pre tabindex="0" class="prism-code language-python codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">!pip install </span><span class="token operator" style="color:#393A34">-</span><span class="token plain">q pyngrok</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> pyngrok </span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> ngrok</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">!ngrok authtoken </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">redacted</span><span class="token operator" style="color:#393A34">&gt;</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">  Building wheel for pyngrok (setup.py) ... [?25l[?25hdone</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Authtoken saved to configuration file: /root/.ngrok2/ngrok.yml</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><div class="codeBlockContainer_I0IT language-python theme-code-block"><div class="codeBlockContent_wNvx python"><pre tabindex="0" class="prism-code language-python codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">ngrok</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">kill</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">public_url </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> ngrok</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">connect</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">port</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&#x27;5000&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> public_url</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">&#x27;http://c1b4cabd8e5b.ngrok.io&#x27;</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><div class="codeBlockContainer_I0IT language-python theme-code-block"><div class="codeBlockContent_wNvx python"><pre tabindex="0" class="prism-code language-python codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">!python src</span><span class="token operator" style="color:#393A34">/</span><span class="token plain">app</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">py</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-16 16:05:27.961051: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcudart.so.10.1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-16 16:05:30,365 loading file /content/p28118/models/final-model.pt</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">---Encoder--- 1.430511474609375e-06 seconds ---</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> * Serving Flask app &quot;app&quot; (lazy loading)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> * Environment: production</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[31m   WARNING: This is a development server. Do not use it in a production deployment.[0m</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[2m   Use a production WSGI server instead.[0m</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> * Debug mode: on</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> * Running on http://127.0.0.1:5000/ (Press CTRL+C to quit)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> * Restarting with stat</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-16 16:05:35.186608: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcudart.so.10.1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020-09-16 16:05:37,169 loading file /content/p28118/models/final-model.pt</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">---Encoder--- 1.1920928955078125e-06 seconds ---</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> * Debugger is active!</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> * Debugger PIN: 210-465-697</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><h2 class="anchor anchorWithStickyNavbar_mojV" id="pipeline">Pipeline<a class="hash-link" href="#pipeline" title="Direct link to heading">​</a></h2><div class="codeBlockContainer_I0IT language-python theme-code-block"><div class="codeBlockContent_wNvx python"><pre tabindex="0" class="prism-code language-python codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">!pip install </span><span class="token operator" style="color:#393A34">-</span><span class="token plain">q probablepeople</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">!pip install </span><span class="token operator" style="color:#393A34">-</span><span class="token plain">q usaddress</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><div class="codeBlockContainer_I0IT language-python theme-code-block"><div class="codeBlockContent_wNvx python"><pre tabindex="0" class="prism-code language-python codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> os</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> re</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> numpy </span><span class="token keyword" style="color:#00009f">as</span><span class="token plain"> np</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> pandas </span><span class="token keyword" style="color:#00009f">as</span><span class="token plain"> pd</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> tqdm </span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> tqdm</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">tqdm</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">pandas</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">import</span><span class="token plain">  probablepeople </span><span class="token keyword" style="color:#00009f">as</span><span class="token plain"> pp</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> usaddress </span><span class="token keyword" style="color:#00009f">as</span><span class="token plain"> ua</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> shutil</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># shutil.make_archive(os.path.join(path,&#x27;customNER&#x27;),&#x27;zip&#x27;,&#x27;/content/customNER&#x27;)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">shutil</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">unpack_archive</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">os</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">path</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">join</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">path</span><span class="token punctuation" style="color:#393A34">,</span><span class="token string" style="color:#e3116c">&#x27;customNER.zip&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;/content/customNER&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;zip&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><div class="codeBlockContainer_I0IT language-python theme-code-block"><div class="codeBlockContent_wNvx python"><pre tabindex="0" class="prism-code language-python codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">df </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> pd</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">read_pickle</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">os</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">path</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">join</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">path</span><span class="token punctuation" style="color:#393A34">,</span><span class="token string" style="color:#e3116c">&#x27;sample.p&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">data </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> df</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">oor</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">tolist</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">data</span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">100</span><span class="token punctuation" style="color:#393A34">:</span><span class="token number" style="color:#36acaa">110</span><span class="token punctuation" style="color:#393A34">]</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><div class="codeBlockContainer_I0IT language-python theme-code-block"><div class="codeBlockContent_wNvx python"><pre tabindex="0" class="prism-code language-python codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">df</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">info</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">&lt;class &#x27;pandas.core.frame.DataFrame&#x27;&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Int64Index: 1000 entries, 3605089 to 2516200</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Data columns (total 2 columns):</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> #   Column  Non-Null Count  Dtype </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">---  ------  --------------  ----- </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 0   _id     1000 non-null   object</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 1   oor     1000 non-null   object</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">dtypes: object(2)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">memory usage: 23.4+ KB</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><div class="codeBlockContainer_I0IT language-python theme-code-block"><div class="codeBlockContent_wNvx python"><pre tabindex="0" class="prism-code language-python codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> spacy</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">model </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> spacy</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">load</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;/content/customNER&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><div class="codeBlockContainer_I0IT language-python theme-code-block"><div class="codeBlockContent_wNvx python"><pre tabindex="0" class="prism-code language-python codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">text1 </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;&lt;redacted&gt;&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">def</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">name_parsing</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">text</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">try</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    text </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> pp</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">tag</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">text</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    textdf </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> pd</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">DataFrame</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">text</span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> index</span><span class="token operator" style="color:#393A34">=</span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    textdf</span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&#x27;NameType&#x27;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> text</span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    textdf</span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&#x27;NameConfidence&#x27;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;Tag&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    textdf </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> textdf</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">T</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">to_dict</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">except</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    textdf </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> pp</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">parse</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">text</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    textdf </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> pd</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">DataFrame</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">textdf</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">groupby</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">agg</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">{</span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">lambda</span><span class="token plain"> x</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27; &#x27;</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">join</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">x</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">T</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    textdf</span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&#x27;NameType&#x27;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;Ambiguous&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    textdf</span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&#x27;NameConfidence&#x27;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;Parse&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    textdf </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> textdf</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">T</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">to_dict</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> textdf</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">name_parsing</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">text3</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><div class="codeBlockContainer_I0IT language-python theme-code-block"><div class="codeBlockContent_wNvx python"><pre tabindex="0" class="prism-code language-python codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">def</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">preprocess</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">text</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  text </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> re</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">sub</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;,&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token string" style="color:#e3116c">&#x27;&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">text</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  text </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27; &#x27;</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">join</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">text</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">split</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  text </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> re</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">sub</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;UNITED STATES OF AMERICA&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token string" style="color:#e3116c">&#x27;US&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">text</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> text</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><div class="codeBlockContainer_I0IT language-python theme-code-block"><div class="codeBlockContent_wNvx python"><pre tabindex="0" class="prism-code language-python codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">text1 </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;&lt;redacted&gt;&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">def</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">address_parsing</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">text</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">try</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    text </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> preprocess</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">text</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    text </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> ua</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">tag</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">text</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    textdf </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> pd</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">DataFrame</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">text</span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> index</span><span class="token operator" style="color:#393A34">=</span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    textdf</span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&#x27;AddressType&#x27;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> text</span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    textdf</span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&#x27;AddrConfidence&#x27;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;Tag&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    textdf </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> textdf</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">T</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">to_dict</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">except</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    textdf </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> ua</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">parse</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">text</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    textdf </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> pd</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">DataFrame</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">textdf</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">groupby</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">agg</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">{</span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">lambda</span><span class="token plain"> x</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27; &#x27;</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">join</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">x</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">T</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    textdf</span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&#x27;AddressType&#x27;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;Ambiguous&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    textdf</span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&#x27;AddrConfidence&#x27;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;Parse&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    textdf </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> textdf</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">T</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">to_dict</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> textdf</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">xx </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> address_parsing</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">text2</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> xx</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><div class="codeBlockContainer_I0IT language-python theme-code-block"><div class="codeBlockContent_wNvx python"><pre tabindex="0" class="prism-code language-python codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token builtin">list</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">xx</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">keys</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">[&#x27;USPSBoxType&#x27;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> &#x27;USPSBoxID&#x27;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> &#x27;PlaceName&#x27;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> &#x27;StateName&#x27;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> &#x27;ZipCode&#x27;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> &#x27;ZipPlus4&#x27;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> &#x27;CountryName&#x27;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> &#x27;AddressType&#x27;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> &#x27;AddrConfidence&#x27;]</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><div class="codeBlockContainer_I0IT language-python theme-code-block"><div class="codeBlockContent_wNvx python"><pre tabindex="0" class="prism-code language-python codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">text1 </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;&lt;redacted&gt;&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">def</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">full_parsing</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">text</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  doc </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> model</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">text</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  ners </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain">ent</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">label_</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain">ent</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">text </span><span class="token keyword" style="color:#00009f">for</span><span class="token plain"> ent </span><span class="token keyword" style="color:#00009f">in</span><span class="token plain"> doc</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">ents</span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  name </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> address </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">try</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    address </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> address_parsing</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">ners</span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&#x27;Address&#x27;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">except</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">pass</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">try</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    name </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> name_parsing</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">ners</span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&#x27;Name&#x27;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">except</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">pass</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  address</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">update</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">name</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">try</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">del</span><span class="token plain"> address</span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&#x27;Recipient&#x27;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">except</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">pass</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;And&#x27;</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">in</span><span class="token plain"> </span><span class="token builtin">list</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">address</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">keys</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    xx </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> pd</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">DataFrame</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">{</span><span class="token string" style="color:#e3116c">&#x27;Household&#x27;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain">xz</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> index</span><span class="token operator" style="color:#393A34">=</span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    xx</span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&#x27;Type&#x27;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;Household&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> address</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">xx </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> full_parsing</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">text2</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> xx</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><div class="codeBlockContainer_I0IT language-python theme-code-block"><div class="codeBlockContent_wNvx python"><pre tabindex="0" class="prism-code language-python codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">tags </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> pp</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">LABELS</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">tags</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">extend</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">ua</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">LABELS</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">tags </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token builtin">list</span><span class="token punctuation" style="color:#393A34">(</span><span class="token builtin">set</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">tags</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">additionals </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&#x27;Text&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;AddressType&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token string" style="color:#e3116c">&#x27;AddrConfidence&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token string" style="color:#e3116c">&#x27;NameType&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token string" style="color:#e3116c">&#x27;NameConfidence&#x27;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">tags</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">extend</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">additionals</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">dfx </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> pd</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">DataFrame</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">columns</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">tags</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">dfx </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> dfx</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">loc</span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">:</span><span class="token punctuation" style="color:#393A34">,</span><span class="token operator" style="color:#393A34">~</span><span class="token plain">dfx</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">columns</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">duplicated</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">for</span><span class="token plain"> idx</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> text </span><span class="token keyword" style="color:#00009f">in</span><span class="token plain"> tqdm</span><span class="token punctuation" style="color:#393A34">(</span><span class="token builtin">enumerate</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">data</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  dfx </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> dfx</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">append</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">full_parsing</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">text</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> ignore_index</span><span class="token operator" style="color:#393A34">=</span><span class="token boolean" style="color:#36acaa">True</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  dfx</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">loc</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">idx</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;Text&#x27;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> text</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><div class="codeBlockContainer_I0IT language-python theme-code-block"><div class="codeBlockContent_wNvx python"><pre tabindex="0" class="prism-code language-python codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">sorted_collist </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> dfx</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">isna</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token builtin">sum</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">sort_values</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">index</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">dfx </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> dfx</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">sorted_collist</span><span class="token punctuation" style="color:#393A34">]</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><div class="codeBlockContainer_I0IT language-python theme-code-block"><div class="codeBlockContent_wNvx python"><pre tabindex="0" class="prism-code language-python codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">dfx</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">info</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">&lt;class &#x27;pandas.core.frame.DataFrame&#x27;&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">RangeIndex: 1000 entries, 0 to 999</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Data columns (total 61 columns):</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> #   Column                             Non-Null Count  Dtype </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">---  ------                             --------------  ----- </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 0   Text                               1000 non-null   object</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 1   NameConfidence                     994 non-null    object</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 2   NameType                           994 non-null    object</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 3   AddrConfidence                     989 non-null    object</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 4   AddressType                        989 non-null    object</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 5   PlaceName                          967 non-null    object</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 6   StateName                          967 non-null    object</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 7   AddressNumber                      933 non-null    object</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 8   StreetName                         926 non-null    object</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 9   StreetNamePostType                 864 non-null    object</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 10  ZipCode                            857 non-null    object</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 11  GivenName                          627 non-null    object</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 12  Surname                            589 non-null    object</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 13  CorporationName                    388 non-null    object</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 14  MiddleInitial                      286 non-null    object</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 15  And                                208 non-null    object</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 16  SecondGivenName                    181 non-null    object</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 17  CountryName                        157 non-null    object</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 18  CorporationLegalType               109 non-null    object</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 19  StreetNamePreDirectional           87 non-null     object</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 20  OccupancyIdentifier                83 non-null     object</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 21  ZipPlus4                           80 non-null     object</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 22  OccupancyType                      71 non-null     object</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 23  SecondMiddleInitial                63 non-null     object</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 24  MiddleName                         59 non-null     object</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 25  USPSBoxType                        57 non-null     object</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 26  USPSBoxID                          57 non-null     object</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 27  CorporationNameOrganization        56 non-null     object</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 28  SecondSurname                      25 non-null     object</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 29  StreetNamePreType                  24 non-null     object</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 30  SuffixGenerational                 22 non-null     object</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 31  StreetNamePostDirectional          15 non-null     object</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 32  PrefixOther                        13 non-null     object</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 33  Recipient                          9 non-null      object</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 34  CorporationNameBranchIdentifier    8 non-null      object</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 35  CorporationNameAndCompany          5 non-null      object</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 36  SuffixOther                        4 non-null      object</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 37  BuildingName                       4 non-null      object</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 38  SubaddressIdentifier               4 non-null      object</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 39  SecondMiddleName                   3 non-null      object</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 40  SubaddressType                     3 non-null      object</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 41  Nickname                           2 non-null      object</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 42  CorporationNameBranchType          2 non-null      object</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 43  FirstInitial                       1 non-null      object</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 44  ShortForm                          1 non-null      object</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 45  SecondCorporationNameOrganization  1 non-null      object</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 46  AddressNumberSuffix                1 non-null      object</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 47  SecondCorporationName              1 non-null      object</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 48  CorporationCommitteeType           1 non-null      object</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 49  USPSBoxGroupType                   0 non-null      object</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 50  IntersectionSeparator              0 non-null      object</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 51  LastInitial                        0 non-null      object</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 52  AKA                                0 non-null      object</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 53  LandmarkName                       0 non-null      object</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 54  StreetNamePreModifier              0 non-null      object</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 55  AddressNumberPrefix                0 non-null      object</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 56  CornerOf                           0 non-null      object</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 57  USPSBoxGroupID                     0 non-null      object</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 58  ProxyFor                           0 non-null      object</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 59  PrefixMarital                      0 non-null      object</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 60  NotAddress                         0 non-null      object</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">dtypes: object(61)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">memory usage: 476.7+ KB</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><div class="codeBlockContainer_I0IT language-python theme-code-block"><div class="codeBlockContent_wNvx python"><pre tabindex="0" class="prism-code language-python codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">dfx0 </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> dfx</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">dropna</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">how</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&#x27;all&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">reset_index</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">drop</span><span class="token operator" style="color:#393A34">=</span><span class="token boolean" style="color:#36acaa">True</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">print</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">dfx0</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">info</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">dfx1 </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> dfx</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">dropna</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">how</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&#x27;all&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> axis</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">dropna</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">how</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&#x27;all&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">reset_index</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">drop</span><span class="token operator" style="color:#393A34">=</span><span class="token boolean" style="color:#36acaa">True</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> dfx1</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">info</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">&lt;class &#x27;pandas.core.frame.DataFrame&#x27;&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">RangeIndex: 1000 entries, 0 to 999</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Data columns (total 61 columns):</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> #   Column                             Non-Null Count  Dtype </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">---  ------                             --------------  ----- </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 0   Text                               1000 non-null   object</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 1   NameConfidence                     994 non-null    object</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 2   NameType                           994 non-null    object</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 3   AddrConfidence                     989 non-null    object</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 4   AddressType                        989 non-null    object</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 5   PlaceName                          967 non-null    object</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 6   StateName                          967 non-null    object</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 7   AddressNumber                      933 non-null    object</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 8   StreetName                         926 non-null    object</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 9   StreetNamePostType                 864 non-null    object</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 10  ZipCode                            857 non-null    object</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 11  GivenName                          627 non-null    object</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 12  Surname                            589 non-null    object</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 13  CorporationName                    388 non-null    object</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 14  MiddleInitial                      286 non-null    object</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 15  And                                208 non-null    object</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 16  SecondGivenName                    181 non-null    object</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 17  CountryName                        157 non-null    object</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 18  CorporationLegalType               109 non-null    object</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 19  StreetNamePreDirectional           87 non-null     object</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 20  OccupancyIdentifier                83 non-null     object</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 21  ZipPlus4                           80 non-null     object</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 22  OccupancyType                      71 non-null     object</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 23  SecondMiddleInitial                63 non-null     object</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 24  MiddleName                         59 non-null     object</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 25  USPSBoxType                        57 non-null     object</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 26  USPSBoxID                          57 non-null     object</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 27  CorporationNameOrganization        56 non-null     object</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 28  SecondSurname                      25 non-null     object</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 29  StreetNamePreType                  24 non-null     object</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 30  SuffixGenerational                 22 non-null     object</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 31  StreetNamePostDirectional          15 non-null     object</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 32  PrefixOther                        13 non-null     object</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 33  Recipient                          9 non-null      object</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 34  CorporationNameBranchIdentifier    8 non-null      object</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 35  CorporationNameAndCompany          5 non-null      object</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 36  SuffixOther                        4 non-null      object</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 37  BuildingName                       4 non-null      object</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 38  SubaddressIdentifier               4 non-null      object</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 39  SecondMiddleName                   3 non-null      object</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 40  SubaddressType                     3 non-null      object</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 41  Nickname                           2 non-null      object</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 42  CorporationNameBranchType          2 non-null      object</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 43  FirstInitial                       1 non-null      object</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 44  ShortForm                          1 non-null      object</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 45  SecondCorporationNameOrganization  1 non-null      object</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 46  AddressNumberSuffix                1 non-null      object</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 47  SecondCorporationName              1 non-null      object</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 48  CorporationCommitteeType           1 non-null      object</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 49  USPSBoxGroupType                   0 non-null      object</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 50  IntersectionSeparator              0 non-null      object</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 51  LastInitial                        0 non-null      object</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 52  AKA                                0 non-null      object</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 53  LandmarkName                       0 non-null      object</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 54  StreetNamePreModifier              0 non-null      object</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 55  AddressNumberPrefix                0 non-null      object</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 56  CornerOf                           0 non-null      object</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 57  USPSBoxGroupID                     0 non-null      object</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 58  ProxyFor                           0 non-null      object</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 59  PrefixMarital                      0 non-null      object</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 60  NotAddress                         0 non-null      object</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">dtypes: object(61)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">memory usage: 476.7+ KB</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">None</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&lt;class &#x27;pandas.core.frame.DataFrame&#x27;&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">RangeIndex: 1000 entries, 0 to 999</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Data columns (total 49 columns):</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> #   Column                             Non-Null Count  Dtype </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">---  ------                             --------------  ----- </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 0   Text                               1000 non-null   object</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 1   NameConfidence                     994 non-null    object</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 2   NameType                           994 non-null    object</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 3   AddrConfidence                     989 non-null    object</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 4   AddressType                        989 non-null    object</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 5   PlaceName                          967 non-null    object</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 6   StateName                          967 non-null    object</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 7   AddressNumber                      933 non-null    object</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 8   StreetName                         926 non-null    object</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 9   StreetNamePostType                 864 non-null    object</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 10  ZipCode                            857 non-null    object</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 11  GivenName                          627 non-null    object</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 12  Surname                            589 non-null    object</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 13  CorporationName                    388 non-null    object</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 14  MiddleInitial                      286 non-null    object</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 15  And                                208 non-null    object</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 16  SecondGivenName                    181 non-null    object</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 17  CountryName                        157 non-null    object</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 18  CorporationLegalType               109 non-null    object</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 19  StreetNamePreDirectional           87 non-null     object</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 20  OccupancyIdentifier                83 non-null     object</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 21  ZipPlus4                           80 non-null     object</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 22  OccupancyType                      71 non-null     object</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 23  SecondMiddleInitial                63 non-null     object</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 24  MiddleName                         59 non-null     object</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 25  USPSBoxType                        57 non-null     object</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 26  USPSBoxID                          57 non-null     object</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 27  CorporationNameOrganization        56 non-null     object</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 28  SecondSurname                      25 non-null     object</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 29  StreetNamePreType                  24 non-null     object</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 30  SuffixGenerational                 22 non-null     object</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 31  StreetNamePostDirectional          15 non-null     object</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 32  PrefixOther                        13 non-null     object</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 33  Recipient                          9 non-null      object</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 34  CorporationNameBranchIdentifier    8 non-null      object</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 35  CorporationNameAndCompany          5 non-null      object</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 36  SuffixOther                        4 non-null      object</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 37  BuildingName                       4 non-null      object</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 38  SubaddressIdentifier               4 non-null      object</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 39  SecondMiddleName                   3 non-null      object</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 40  SubaddressType                     3 non-null      object</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 41  Nickname                           2 non-null      object</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 42  CorporationNameBranchType          2 non-null      object</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 43  FirstInitial                       1 non-null      object</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 44  ShortForm                          1 non-null      object</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 45  SecondCorporationNameOrganization  1 non-null      object</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 46  AddressNumberSuffix                1 non-null      object</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 47  SecondCorporationName              1 non-null      object</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 48  CorporationCommitteeType           1 non-null      object</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">dtypes: object(49)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">memory usage: 382.9+ KB</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><div class="codeBlockContainer_I0IT language-python theme-code-block"><div class="codeBlockContent_wNvx python"><pre tabindex="0" class="prism-code language-python codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># dfx0.to_csv(&#x27;dfx0.csv&#x27;)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">dfx1</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">to_csv</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;dfx1.csv&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><div class="codeBlockContainer_I0IT language-python theme-code-block"><div class="codeBlockContent_wNvx python"><pre tabindex="0" class="prism-code language-python codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">def</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">func</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">text</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  text </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token builtin">str</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">text</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  output </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> full_parsing</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">text</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> </span><span class="token builtin">str</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">output</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">txt </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;&lt;redacted&gt;&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">func</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">txt</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><div class="codeBlockContainer_I0IT language-python theme-code-block"><div class="codeBlockContent_wNvx python"><pre tabindex="0" class="prism-code language-python codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">!pip install </span><span class="token operator" style="color:#393A34">-</span><span class="token plain">q gradio</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> gradio </span><span class="token keyword" style="color:#00009f">as</span><span class="token plain"> gr</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><div class="codeBlockContainer_I0IT language-python theme-code-block"><div class="codeBlockContent_wNvx python"><pre tabindex="0" class="prism-code language-python codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">gr</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">Interface</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">fn</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">func</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> inputs</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&quot;text&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> outputs</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&quot;text&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">launch</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/sparsh-ai/ai-kb/docs/04-tutorials/name-address-parsing.mdx" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_dcUD" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_foO9"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/ai-kb/docs/tutorials/multi-touch-attribution"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Multi-Touch Attribution</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/ai-kb/docs/tutorials/negative-implicit-feedback-rec"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Negative Implicit Feedback in Recommendations</div></a></div></nav></div></div><div class="col col--3"><div class="tableOfContents_cNA8 thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#get-data-from-mongodb" class="table-of-contents__link toc-highlight">Get data from MongoDB</a></li><li><a href="#data-wrangling" class="table-of-contents__link toc-highlight">Data wrangling</a></li><li><a href="#sampling" class="table-of-contents__link toc-highlight">Sampling</a></li><li><a href="#flair-ner-model" class="table-of-contents__link toc-highlight">Flair NER Model</a></li><li><a href="#api" class="table-of-contents__link toc-highlight">API</a></li><li><a href="#deliverables" class="table-of-contents__link toc-highlight">Deliverables</a></li><li><a href="#pipeline" class="table-of-contents__link toc-highlight">Pipeline</a></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2022 AIKB Docs, Inc. Built with Docusaurus.</div></div></div></footer></div>
<script src="/ai-kb/assets/js/runtime~main.4448d8b2.js"></script>
<script src="/ai-kb/assets/js/main.b26486b4.js"></script>
</body>
</html>